2020-01-07 08:55:02,438 Namespace(arch='alexnet', batchSize=16, cacheBatchSize=144, cachePath='/home/annora/NetVLAD/output/', cacheRefreshRate=0, ckpt='best', ckpt_diy='model_best0.pth.tar', contilearn=False, dataPath='/home/annora/NetVLAD/output/data/', dataset='pittsburgh', debug_file='', evalEvery=1, fromscratch=False, lr=0.0001, lrGamma=0.5, lrStep=5, margin=0.1, mode='train', momentum=0.9, nEpochs=30, nGPU=1, nocuda=False, num_clusters=64, optim='SGD', patience=10, pooling='max', premodel='imagenet', resume='', runsPath='/home/annora/NetVLAD/output/runs/', savePath='checkpoints', seed=123, split='val', start_epoch=0, threads=4, vladv2=False, weightDecay=0.001)
2020-01-07 08:55:02,497 ===> Loading dataset(s)
2020-01-07 08:55:02,498 ===> Building model
2020-01-07 08:55:02,545 encoder moder:
AlexNet(
  (conv1): Sequential(
    (0): Conv2d(3, 64, kernel_size=(11, 11), stride=(4, 4), padding=(2, 2))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(64, 192, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv3): Sequential(
    (0): Conv2d(192, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv4): Sequential(
    (0): Conv2d(384, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv5): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  )
)
2020-01-07 08:55:06,450 ---->>>> trainfiles: ['oxRobocar_single_train.mat']
2020-01-07 08:55:06,452 ===> Saving state to: /home/annora/NetVLAD/output/runs/2020-01-07-08-55-06_alexnet_max
2020-01-07 08:55:08,993 ====> Training query set:6636
2020-01-07 08:55:09,082 ===> Evaluating on val set, query count:3450
2020-01-07 08:55:09,082 ---->>>> testfile: oxRobocar_single_val.mat
2020-01-07 08:55:09,083 ===> Training model
2020-01-07 08:55:09,083 ====> Building Cache
2020-01-07 08:55:09,083 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-07 08:57:26,612 Allocated:11.59326171875 MB
2020-01-07 08:57:26,613 Cached:2595.125 MB
2020-01-07 08:59:08,239 ==> Task[1]Epoch[1](50/415): Loss: 0.2272
2020-01-07 08:59:08,241 Allocated:33.03076171875 MB
2020-01-07 08:59:08,242 Cached:1112.5 MB
2020-01-07 09:00:33,885 ==> Task[1]Epoch[1](100/415): Loss: 0.2526
2020-01-07 09:00:33,886 Allocated:33.03076171875 MB
2020-01-07 09:00:33,886 Cached:1112.5 MB
2020-01-07 09:01:59,015 ==> Task[1]Epoch[1](150/415): Loss: 0.2402
2020-01-07 09:01:59,016 Allocated:33.03076171875 MB
2020-01-07 09:01:59,016 Cached:1112.5 MB
2020-01-07 09:03:19,149 ==> Task[1]Epoch[1](200/415): Loss: 0.2783
2020-01-07 09:03:19,150 Allocated:33.03076171875 MB
2020-01-07 09:03:19,150 Cached:1112.5 MB
2020-01-07 09:04:45,667 ==> Task[1]Epoch[1](250/415): Loss: 0.1592
2020-01-07 09:04:45,668 Allocated:33.03076171875 MB
2020-01-07 09:04:45,668 Cached:1112.5 MB
2020-01-07 09:06:07,076 ==> Task[1]Epoch[1](300/415): Loss: 0.2165
2020-01-07 09:06:07,077 Allocated:33.03076171875 MB
2020-01-07 09:06:07,078 Cached:1112.5 MB
2020-01-07 09:07:33,977 ==> Task[1]Epoch[1](350/415): Loss: 0.1715
2020-01-07 09:07:33,979 Allocated:33.03076171875 MB
2020-01-07 09:07:33,979 Cached:1112.5 MB
2020-01-07 09:08:53,987 ==> Task[1]Epoch[1](400/415): Loss: 0.2134
2020-01-07 09:08:53,989 Allocated:33.03076171875 MB
2020-01-07 09:08:53,989 Cached:1112.5 MB
2020-01-07 09:09:20,182 ===> Task 1 Epoch 1 Complete: Avg. Loss: 0.2383
2020-01-07 09:09:20,183 begin test:
2020-01-07 09:09:20,184 ====> Extracting Features
2020-01-07 09:10:28,890 ==> Batch (50/72)
2020-01-07 09:10:53,869 ====> Building faiss index
2020-01-07 09:10:53,871 ====> Calculating recall @ N
2020-01-07 09:10:54,364 ====> Recall@1: 0.6971
2020-01-07 09:10:54,365 ====> Recall@2: 0.7206
2020-01-07 09:10:54,365 ====> Recall@3: 0.7304
2020-01-07 09:10:54,366 ====> Recall@4: 0.7380
2020-01-07 09:10:54,366 ====> Recall@5: 0.7435
2020-01-07 09:10:54,366 ====> Recall@10: 0.7652
2020-01-07 09:10:54,366 ====> Recall@15: 0.7777
2020-01-07 09:10:54,366 ====> Recall@20: 0.7899
2020-01-07 09:10:54,367 ====> Recall@25: 0.8003
2020-01-07 09:10:54,408 ====> Building Cache
2020-01-07 09:10:54,408 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-07 09:13:11,267 Allocated:31.03076171875 MB
2020-01-07 09:13:11,267 Cached:9902.625 MB
2020-01-07 09:14:52,973 ==> Task[1]Epoch[2](50/415): Loss: 0.1822
2020-01-07 09:14:52,975 Allocated:33.03076171875 MB
2020-01-07 09:14:52,975 Cached:1112.5 MB
2020-01-07 09:16:16,058 ==> Task[1]Epoch[2](100/415): Loss: 0.2401
2020-01-07 09:16:16,059 Allocated:33.03076171875 MB
2020-01-07 09:16:16,060 Cached:1112.5 MB
2020-01-07 09:17:42,044 ==> Task[1]Epoch[2](150/415): Loss: 0.1975
2020-01-07 09:17:42,045 Allocated:33.03076171875 MB
2020-01-07 09:17:42,046 Cached:1112.5 MB
2020-01-07 09:19:03,101 ==> Task[1]Epoch[2](200/415): Loss: 0.2257
2020-01-07 09:19:03,102 Allocated:33.03076171875 MB
2020-01-07 09:19:03,103 Cached:1112.5 MB
2020-01-07 09:20:29,138 ==> Task[1]Epoch[2](250/415): Loss: 0.0983
2020-01-07 09:20:29,141 Allocated:33.03076171875 MB
2020-01-07 09:20:29,141 Cached:1112.5 MB
2020-01-07 09:21:50,013 ==> Task[1]Epoch[2](300/415): Loss: 0.1626
2020-01-07 09:21:50,016 Allocated:33.03076171875 MB
2020-01-07 09:21:50,016 Cached:1112.5 MB
2020-01-07 09:23:16,481 ==> Task[1]Epoch[2](350/415): Loss: 0.1385
2020-01-07 09:23:16,483 Allocated:33.03076171875 MB
2020-01-07 09:23:16,483 Cached:1112.5 MB
2020-01-07 09:24:38,374 ==> Task[1]Epoch[2](400/415): Loss: 0.1708
2020-01-07 09:24:38,375 Allocated:33.03076171875 MB
2020-01-07 09:24:38,376 Cached:1112.5 MB
2020-01-07 09:25:04,818 ===> Task 1 Epoch 2 Complete: Avg. Loss: 0.1955
2020-01-07 09:25:04,820 begin test:
2020-01-07 09:25:04,820 ====> Extracting Features
2020-01-07 09:26:14,474 ==> Batch (50/72)
2020-01-07 09:26:40,134 ====> Building faiss index
2020-01-07 09:26:40,136 ====> Calculating recall @ N
2020-01-07 09:26:40,533 ====> Recall@1: 0.7278
2020-01-07 09:26:40,533 ====> Recall@2: 0.7577
2020-01-07 09:26:40,534 ====> Recall@3: 0.7687
2020-01-07 09:26:40,534 ====> Recall@4: 0.7728
2020-01-07 09:26:40,534 ====> Recall@5: 0.7768
2020-01-07 09:26:40,534 ====> Recall@10: 0.7890
2020-01-07 09:26:40,534 ====> Recall@15: 0.7945
2020-01-07 09:26:40,535 ====> Recall@20: 0.7977
2020-01-07 09:26:40,535 ====> Recall@25: 0.8000
2020-01-07 09:26:40,658 ====> Building Cache
2020-01-07 09:26:40,658 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-07 09:28:57,700 Allocated:31.03076171875 MB
2020-01-07 09:28:57,700 Cached:9902.625 MB
2020-01-07 09:30:40,352 ==> Task[1]Epoch[3](50/415): Loss: 0.1189
2020-01-07 09:30:40,354 Allocated:33.03076171875 MB
2020-01-07 09:30:40,354 Cached:1111.5 MB
2020-01-07 09:32:02,257 ==> Task[1]Epoch[3](100/415): Loss: 0.2210
2020-01-07 09:32:02,259 Allocated:33.03076171875 MB
2020-01-07 09:32:02,259 Cached:1112.5 MB
2020-01-07 09:33:28,818 ==> Task[1]Epoch[3](150/415): Loss: 0.1694
2020-01-07 09:33:28,820 Allocated:33.03076171875 MB
2020-01-07 09:33:28,820 Cached:1112.5 MB
2020-01-07 09:34:49,592 ==> Task[1]Epoch[3](200/415): Loss: 0.1333
2020-01-07 09:34:49,594 Allocated:33.03076171875 MB
2020-01-07 09:34:49,594 Cached:1112.5 MB
2020-01-07 09:36:15,701 ==> Task[1]Epoch[3](250/415): Loss: 0.0571
2020-01-07 09:36:15,704 Allocated:33.03076171875 MB
2020-01-07 09:36:15,704 Cached:1112.5 MB
2020-01-07 09:37:35,993 ==> Task[1]Epoch[3](300/415): Loss: 0.0996
2020-01-07 09:37:35,996 Allocated:33.03076171875 MB
2020-01-07 09:37:35,996 Cached:1112.5 MB
2020-01-07 09:39:02,430 ==> Task[1]Epoch[3](350/415): Loss: 0.0994
2020-01-07 09:39:02,432 Allocated:33.03076171875 MB
2020-01-07 09:39:02,432 Cached:1112.5 MB
2020-01-07 09:40:23,724 ==> Task[1]Epoch[3](400/415): Loss: 0.1211
2020-01-07 09:40:23,726 Allocated:33.03076171875 MB
2020-01-07 09:40:23,726 Cached:1112.5 MB
2020-01-07 09:40:50,041 ===> Task 1 Epoch 3 Complete: Avg. Loss: 0.1518
2020-01-07 09:40:50,043 begin test:
2020-01-07 09:40:50,044 ====> Extracting Features
2020-01-07 09:41:59,811 ==> Batch (50/72)
2020-01-07 09:42:25,008 ====> Building faiss index
2020-01-07 09:42:25,010 ====> Calculating recall @ N
2020-01-07 09:42:25,443 ====> Recall@1: 0.6957
2020-01-07 09:42:25,443 ====> Recall@2: 0.7255
2020-01-07 09:42:25,444 ====> Recall@3: 0.7400
2020-01-07 09:42:25,444 ====> Recall@4: 0.7591
2020-01-07 09:42:25,444 ====> Recall@5: 0.7672
2020-01-07 09:42:25,444 ====> Recall@10: 0.7878
2020-01-07 09:42:25,444 ====> Recall@15: 0.7954
2020-01-07 09:42:25,445 ====> Recall@20: 0.7977
2020-01-07 09:42:25,445 ====> Recall@25: 0.8006
2020-01-07 09:42:25,503 ====> Building Cache
2020-01-07 09:42:25,503 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-07 09:44:42,875 Allocated:31.03076171875 MB
2020-01-07 09:44:42,876 Cached:9902.625 MB
2020-01-07 09:46:20,952 ==> Task[1]Epoch[4](50/415): Loss: 0.0698
2020-01-07 09:46:20,954 Allocated:33.03076171875 MB
2020-01-07 09:46:20,954 Cached:1112.5 MB
2020-01-07 09:47:37,706 ==> Task[1]Epoch[4](100/415): Loss: 0.1959
2020-01-07 09:47:37,708 Allocated:33.03076171875 MB
2020-01-07 09:47:37,708 Cached:1112.5 MB
2020-01-07 09:49:00,468 ==> Task[1]Epoch[4](150/415): Loss: 0.1032
2020-01-07 09:49:00,470 Allocated:33.03076171875 MB
2020-01-07 09:49:00,470 Cached:1112.5 MB
2020-01-07 09:50:18,540 ==> Task[1]Epoch[4](200/415): Loss: 0.0117
2020-01-07 09:50:18,542 Allocated:33.03076171875 MB
2020-01-07 09:50:18,542 Cached:1112.5 MB
2020-01-07 09:51:22,362 ==> Task[1]Epoch[4](250/415): Loss: 0.0766
2020-01-07 09:51:22,364 Allocated:33.03076171875 MB
2020-01-07 09:51:22,364 Cached:1111.5 MB
2020-01-07 09:52:43,344 ==> Task[1]Epoch[4](300/415): Loss: 0.0483
2020-01-07 09:52:43,347 Allocated:33.03076171875 MB
2020-01-07 09:52:43,348 Cached:1111.5 MB
2020-01-07 09:54:07,224 ==> Task[1]Epoch[4](350/415): Loss: 0.0640
2020-01-07 09:54:07,226 Allocated:33.03076171875 MB
2020-01-07 09:54:07,226 Cached:1111.5 MB
2020-01-07 09:55:25,274 ==> Task[1]Epoch[4](400/415): Loss: 0.0862
2020-01-07 09:55:25,276 Allocated:33.03076171875 MB
2020-01-07 09:55:25,276 Cached:1111.5 MB
2020-01-07 09:55:51,539 ===> Task 1 Epoch 4 Complete: Avg. Loss: 0.1074
2020-01-07 09:55:51,541 begin test:
2020-01-07 09:55:51,542 ====> Extracting Features
2020-01-07 09:57:00,107 ==> Batch (50/72)
2020-01-07 09:57:26,613 ====> Building faiss index
2020-01-07 09:57:26,615 ====> Calculating recall @ N
2020-01-07 09:57:27,006 ====> Recall@1: 0.6994
2020-01-07 09:57:27,007 ====> Recall@2: 0.7267
2020-01-07 09:57:27,008 ====> Recall@3: 0.7559
2020-01-07 09:57:27,008 ====> Recall@4: 0.7646
2020-01-07 09:57:27,008 ====> Recall@5: 0.7687
2020-01-07 09:57:27,008 ====> Recall@10: 0.7820
2020-01-07 09:57:27,009 ====> Recall@15: 0.7887
2020-01-07 09:57:27,009 ====> Recall@20: 0.7933
2020-01-07 09:57:27,009 ====> Recall@25: 0.7980
2020-01-07 09:57:27,067 ====> Building Cache
2020-01-07 09:57:27,067 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-07 09:59:43,997 Allocated:31.03076171875 MB
2020-01-07 09:59:43,998 Cached:9902.625 MB
2020-01-07 10:00:59,355 ==> Task[1]Epoch[5](50/415): Loss: 0.0450
2020-01-07 10:00:59,357 Allocated:33.03076171875 MB
2020-01-07 10:00:59,358 Cached:1112.5 MB
2020-01-07 10:01:55,453 ==> Task[1]Epoch[5](100/415): Loss: 0.1910
2020-01-07 10:01:55,456 Allocated:33.03076171875 MB
2020-01-07 10:01:55,456 Cached:1111.5 MB
2020-01-07 10:02:53,343 ==> Task[1]Epoch[5](150/415): Loss: 0.0872
2020-01-07 10:02:53,345 Allocated:33.03076171875 MB
2020-01-07 10:02:53,346 Cached:1111.5 MB
2020-01-07 10:04:04,356 ==> Task[1]Epoch[5](200/415): Loss: 0.0109
2020-01-07 10:04:04,358 Allocated:33.03076171875 MB
2020-01-07 10:04:04,359 Cached:1111.5 MB
2020-01-07 10:04:37,160 ==> Task[1]Epoch[5](250/415): Loss: 0.0833
2020-01-07 10:04:37,162 Allocated:33.03076171875 MB
2020-01-07 10:04:37,162 Cached:1111.5 MB
2020-01-07 10:05:59,042 ==> Task[1]Epoch[5](300/415): Loss: 0.0388
2020-01-07 10:05:59,043 Allocated:33.03076171875 MB
2020-01-07 10:05:59,044 Cached:1111.5 MB
2020-01-07 10:07:09,477 ==> Task[1]Epoch[5](350/415): Loss: 0.0479
2020-01-07 10:07:09,478 Allocated:33.03076171875 MB
2020-01-07 10:07:09,479 Cached:1111.5 MB
2020-01-07 10:08:22,163 ==> Task[1]Epoch[5](400/415): Loss: 0.0803
2020-01-07 10:08:22,165 Allocated:33.03076171875 MB
2020-01-07 10:08:22,165 Cached:1112.5 MB
2020-01-07 10:08:41,612 ===> Task 1 Epoch 5 Complete: Avg. Loss: 0.0885
2020-01-07 10:08:41,614 begin test:
2020-01-07 10:08:41,615 ====> Extracting Features
2020-01-07 10:09:48,903 ==> Batch (50/72)
2020-01-07 10:10:14,424 ====> Building faiss index
2020-01-07 10:10:14,426 ====> Calculating recall @ N
2020-01-07 10:10:14,887 ====> Recall@1: 0.6983
2020-01-07 10:10:14,887 ====> Recall@2: 0.7299
2020-01-07 10:10:14,888 ====> Recall@3: 0.7542
2020-01-07 10:10:14,888 ====> Recall@4: 0.7638
2020-01-07 10:10:14,888 ====> Recall@5: 0.7687
2020-01-07 10:10:14,889 ====> Recall@10: 0.7817
2020-01-07 10:10:14,889 ====> Recall@15: 0.7875
2020-01-07 10:10:14,889 ====> Recall@20: 0.7933
2020-01-07 10:10:14,889 ====> Recall@25: 0.7962
2020-01-07 10:10:14,951 ====> Building Cache
2020-01-07 10:10:14,951 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-07 10:12:32,477 Allocated:31.03076171875 MB
2020-01-07 10:12:32,478 Cached:9902.625 MB
2020-01-07 10:13:40,026 ==> Task[1]Epoch[6](50/415): Loss: 0.0467
2020-01-07 10:13:40,028 Allocated:33.03076171875 MB
2020-01-07 10:13:40,028 Cached:1111.5 MB
2020-01-07 10:14:32,191 ==> Task[1]Epoch[6](100/415): Loss: 0.1733
2020-01-07 10:14:32,193 Allocated:33.03076171875 MB
2020-01-07 10:14:32,193 Cached:1111.5 MB
2020-01-07 10:15:19,730 ==> Task[1]Epoch[6](150/415): Loss: 0.0786
2020-01-07 10:15:19,732 Allocated:33.03076171875 MB
2020-01-07 10:15:19,732 Cached:1111.5 MB
2020-01-07 10:16:49,888 ==> Task[1]Epoch[6](250/415): Loss: 0.0649
2020-01-07 10:16:49,890 Allocated:33.03076171875 MB
2020-01-07 10:16:49,890 Cached:1111.5 MB
2020-01-07 10:17:58,578 ==> Task[1]Epoch[6](300/415): Loss: 0.0396
2020-01-07 10:17:58,580 Allocated:33.03076171875 MB
2020-01-07 10:17:58,580 Cached:1112.5 MB
2020-01-07 10:19:06,869 ==> Task[1]Epoch[6](350/415): Loss: 0.0422
2020-01-07 10:19:06,871 Allocated:33.03076171875 MB
2020-01-07 10:19:06,872 Cached:1111.5 MB
2020-01-07 10:20:16,212 ==> Task[1]Epoch[6](400/415): Loss: 0.0658
2020-01-07 10:20:16,213 Allocated:33.03076171875 MB
2020-01-07 10:20:16,214 Cached:1111.5 MB
2020-01-07 10:20:35,553 ===> Task 1 Epoch 6 Complete: Avg. Loss: 0.0814
2020-01-07 10:20:35,555 begin test:
2020-01-07 10:20:35,555 ====> Extracting Features
2020-01-07 10:21:44,543 ==> Batch (50/72)
2020-01-07 10:22:09,668 ====> Building faiss index
2020-01-07 10:22:09,670 ====> Calculating recall @ N
2020-01-07 10:22:10,092 ====> Recall@1: 0.6884
2020-01-07 10:22:10,092 ====> Recall@2: 0.7241
2020-01-07 10:22:10,093 ====> Recall@3: 0.7513
2020-01-07 10:22:10,093 ====> Recall@4: 0.7623
2020-01-07 10:22:10,093 ====> Recall@5: 0.7681
2020-01-07 10:22:10,094 ====> Recall@10: 0.7800
2020-01-07 10:22:10,094 ====> Recall@15: 0.7858
2020-01-07 10:22:10,094 ====> Recall@20: 0.7919
2020-01-07 10:22:10,094 ====> Recall@25: 0.7962
2020-01-07 10:22:10,154 ====> Building Cache
2020-01-07 10:22:10,154 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-07 10:24:28,215 Allocated:31.03076171875 MB
2020-01-07 10:24:28,216 Cached:9902.625 MB
2020-01-07 10:25:30,202 ==> Task[1]Epoch[7](50/415): Loss: 0.0436
2020-01-07 10:25:30,205 Allocated:33.03076171875 MB
2020-01-07 10:25:30,205 Cached:1111.5 MB
2020-01-07 10:26:17,705 ==> Task[1]Epoch[7](100/415): Loss: 0.1677
2020-01-07 10:26:17,707 Allocated:33.03076171875 MB
2020-01-07 10:26:17,708 Cached:1111.5 MB
2020-01-07 10:27:02,359 ==> Task[1]Epoch[7](150/415): Loss: 0.0839
2020-01-07 10:27:02,360 Allocated:33.03076171875 MB
2020-01-07 10:27:02,361 Cached:1112.5 MB
2020-01-07 10:28:23,828 ==> Task[1]Epoch[7](250/415): Loss: 0.0596
2020-01-07 10:28:23,830 Allocated:33.03076171875 MB
2020-01-07 10:28:23,830 Cached:1112.5 MB
2020-01-07 10:29:24,734 ==> Task[1]Epoch[7](300/415): Loss: 0.0349
2020-01-07 10:29:24,736 Allocated:33.03076171875 MB
2020-01-07 10:29:24,736 Cached:1111.5 MB
2020-01-07 10:30:21,909 ==> Task[1]Epoch[7](350/415): Loss: 0.0333
2020-01-07 10:30:21,911 Allocated:33.03076171875 MB
2020-01-07 10:30:21,911 Cached:1111.5 MB
2020-01-07 10:31:25,144 ==> Task[1]Epoch[7](400/415): Loss: 0.0656
2020-01-07 10:31:25,146 Allocated:33.03076171875 MB
2020-01-07 10:31:25,146 Cached:1112.5 MB
2020-01-07 10:31:40,048 ===> Task 1 Epoch 7 Complete: Avg. Loss: 0.0785
2020-01-07 10:31:40,049 begin test:
2020-01-07 10:31:40,050 ====> Extracting Features
2020-01-07 10:32:55,685 ==> Batch (50/72)
2020-01-07 10:33:21,367 ====> Building faiss index
2020-01-07 10:33:21,369 ====> Calculating recall @ N
2020-01-07 10:33:21,814 ====> Recall@1: 0.6675
2020-01-07 10:33:21,815 ====> Recall@2: 0.7078
2020-01-07 10:33:21,815 ====> Recall@3: 0.7377
2020-01-07 10:33:21,815 ====> Recall@4: 0.7559
2020-01-07 10:33:21,815 ====> Recall@5: 0.7641
2020-01-07 10:33:21,816 ====> Recall@10: 0.7803
2020-01-07 10:33:21,816 ====> Recall@15: 0.7870
2020-01-07 10:33:21,816 ====> Recall@20: 0.7930
2020-01-07 10:33:21,816 ====> Recall@25: 0.7974
2020-01-07 10:33:21,876 ====> Building Cache
2020-01-07 10:33:21,876 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-07 10:35:40,821 Allocated:31.03076171875 MB
2020-01-07 10:35:40,822 Cached:9902.625 MB
2020-01-07 10:36:40,345 ==> Task[1]Epoch[8](50/415): Loss: 0.0386
2020-01-07 10:36:40,346 Allocated:33.03076171875 MB
2020-01-07 10:36:40,347 Cached:1111.5 MB
2020-01-07 10:37:24,274 ==> Task[1]Epoch[8](100/415): Loss: 0.1707
2020-01-07 10:37:24,275 Allocated:33.03076171875 MB
2020-01-07 10:37:24,275 Cached:1111.5 MB
2020-01-07 10:38:05,518 ==> Task[1]Epoch[8](150/415): Loss: 0.0547
2020-01-07 10:38:05,520 Allocated:33.03076171875 MB
2020-01-07 10:38:05,520 Cached:1111.5 MB
2020-01-07 10:39:21,938 ==> Task[1]Epoch[8](250/415): Loss: 0.0520
2020-01-07 10:39:21,940 Allocated:33.03076171875 MB
2020-01-07 10:39:21,940 Cached:1111.5 MB
2020-01-07 10:40:19,793 ==> Task[1]Epoch[8](300/415): Loss: 0.0471
2020-01-07 10:40:19,796 Allocated:33.03076171875 MB
2020-01-07 10:40:19,796 Cached:1112.5 MB
2020-01-07 10:41:12,124 ==> Task[1]Epoch[8](350/415): Loss: 0.0390
2020-01-07 10:41:12,125 Allocated:33.03076171875 MB
2020-01-07 10:41:12,126 Cached:1111.5 MB
2020-01-07 10:42:10,279 ==> Task[1]Epoch[8](400/415): Loss: 0.0494
2020-01-07 10:42:10,280 Allocated:33.03076171875 MB
2020-01-07 10:42:10,281 Cached:1111.5 MB
2020-01-07 10:42:24,820 ===> Task 1 Epoch 8 Complete: Avg. Loss: 0.0755
2020-01-07 10:42:24,821 begin test:
2020-01-07 10:42:24,823 ====> Extracting Features
2020-01-07 10:43:34,960 ==> Batch (50/72)
2020-01-07 10:44:01,355 ====> Building faiss index
2020-01-07 10:44:01,359 ====> Calculating recall @ N
2020-01-07 10:44:01,848 ====> Recall@1: 0.6672
2020-01-07 10:44:01,849 ====> Recall@2: 0.6948
2020-01-07 10:44:01,849 ====> Recall@3: 0.7165
2020-01-07 10:44:01,849 ====> Recall@4: 0.7310
2020-01-07 10:44:01,849 ====> Recall@5: 0.7461
2020-01-07 10:44:01,850 ====> Recall@10: 0.7803
2020-01-07 10:44:01,850 ====> Recall@15: 0.7872
2020-01-07 10:44:01,850 ====> Recall@20: 0.7925
2020-01-07 10:44:01,850 ====> Recall@25: 0.7971
2020-01-07 10:44:01,915 ====> Building Cache
2020-01-07 10:44:01,916 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-07 10:46:21,034 Allocated:31.03076171875 MB
2020-01-07 10:46:21,035 Cached:9902.625 MB
2020-01-07 10:47:16,795 ==> Task[1]Epoch[9](50/415): Loss: 0.0381
2020-01-07 10:47:16,798 Allocated:33.03076171875 MB
2020-01-07 10:47:16,798 Cached:1111.5 MB
2020-01-07 10:47:58,131 ==> Task[1]Epoch[9](100/415): Loss: 0.1736
2020-01-07 10:47:58,133 Allocated:33.03076171875 MB
2020-01-07 10:47:58,134 Cached:1111.5 MB
2020-01-07 10:48:35,979 ==> Task[1]Epoch[9](150/415): Loss: 0.0555
2020-01-07 10:48:35,981 Allocated:33.03076171875 MB
2020-01-07 10:48:35,981 Cached:1111.5 MB
2020-01-07 10:49:45,860 ==> Task[1]Epoch[9](250/415): Loss: 0.0442
2020-01-07 10:49:45,862 Allocated:33.03076171875 MB
2020-01-07 10:49:45,862 Cached:1111.5 MB
2020-01-07 10:50:42,739 ==> Task[1]Epoch[9](300/415): Loss: 0.0591
2020-01-07 10:50:42,740 Allocated:33.03076171875 MB
2020-01-07 10:50:42,740 Cached:1112.5 MB
2020-01-07 10:51:32,865 ==> Task[1]Epoch[9](350/415): Loss: 0.0225
2020-01-07 10:51:32,866 Allocated:33.03076171875 MB
2020-01-07 10:51:32,866 Cached:1112.5 MB
2020-01-07 10:52:26,069 ==> Task[1]Epoch[9](400/415): Loss: 0.0464
2020-01-07 10:52:26,071 Allocated:33.03076171875 MB
2020-01-07 10:52:26,071 Cached:1111.5 MB
2020-01-07 10:52:39,662 ===> Task 1 Epoch 9 Complete: Avg. Loss: 0.0721
2020-01-07 10:52:39,664 begin test:
2020-01-07 10:52:39,665 ====> Extracting Features
2020-01-07 10:53:48,192 ==> Batch (50/72)
2020-01-07 10:54:13,177 ====> Building faiss index
2020-01-07 10:54:13,179 ====> Calculating recall @ N
2020-01-07 10:54:13,636 ====> Recall@1: 0.6699
2020-01-07 10:54:13,636 ====> Recall@2: 0.6965
2020-01-07 10:54:13,637 ====> Recall@3: 0.7139
2020-01-07 10:54:13,637 ====> Recall@4: 0.7281
2020-01-07 10:54:13,637 ====> Recall@5: 0.7368
2020-01-07 10:54:13,637 ====> Recall@10: 0.7730
2020-01-07 10:54:13,638 ====> Recall@15: 0.7870
2020-01-07 10:54:13,638 ====> Recall@20: 0.7939
2020-01-07 10:54:13,638 ====> Recall@25: 0.7991
2020-01-07 10:54:13,699 ====> Building Cache
2020-01-07 10:54:13,699 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-07 10:56:31,644 Allocated:31.03076171875 MB
2020-01-07 10:56:31,644 Cached:9902.625 MB
2020-01-07 10:57:23,840 ==> Task[1]Epoch[10](50/415): Loss: 0.0517
2020-01-07 10:57:23,842 Allocated:33.03076171875 MB
2020-01-07 10:57:23,842 Cached:1111.5 MB
2020-01-07 10:58:04,327 ==> Task[1]Epoch[10](100/415): Loss: 0.1666
2020-01-07 10:58:04,329 Allocated:33.03076171875 MB
2020-01-07 10:58:04,329 Cached:1111.5 MB
2020-01-07 10:58:40,681 ==> Task[1]Epoch[10](150/415): Loss: 0.0350
2020-01-07 10:58:40,682 Allocated:33.03076171875 MB
2020-01-07 10:58:40,683 Cached:1111.5 MB
2020-01-07 10:59:50,183 ==> Task[1]Epoch[10](250/415): Loss: 0.0463
2020-01-07 10:59:50,185 Allocated:33.03076171875 MB
2020-01-07 10:59:50,185 Cached:1111.5 MB
2020-01-07 11:00:46,983 ==> Task[1]Epoch[10](300/415): Loss: 0.0694
2020-01-07 11:00:46,984 Allocated:33.03076171875 MB
2020-01-07 11:00:46,985 Cached:1111.5 MB
2020-01-07 11:01:33,911 ==> Task[1]Epoch[10](350/415): Loss: 0.0301
2020-01-07 11:01:33,912 Allocated:33.03076171875 MB
2020-01-07 11:01:33,912 Cached:1112.5 MB
2020-01-07 11:02:20,765 ==> Task[1]Epoch[10](400/415): Loss: 0.0485
2020-01-07 11:02:20,766 Allocated:33.03076171875 MB
2020-01-07 11:02:20,766 Cached:1111.5 MB
2020-01-07 11:02:33,869 ===> Task 1 Epoch 10 Complete: Avg. Loss: 0.0708
2020-01-07 11:02:33,870 begin test:
2020-01-07 11:02:33,871 ====> Extracting Features
2020-01-07 11:03:43,627 ==> Batch (50/72)
2020-01-07 11:04:09,633 ====> Building faiss index
2020-01-07 11:04:09,634 ====> Calculating recall @ N
2020-01-07 11:04:10,101 ====> Recall@1: 0.6707
2020-01-07 11:04:10,102 ====> Recall@2: 0.6959
2020-01-07 11:04:10,103 ====> Recall@3: 0.7128
2020-01-07 11:04:10,103 ====> Recall@4: 0.7284
2020-01-07 11:04:10,104 ====> Recall@5: 0.7339
2020-01-07 11:04:10,104 ====> Recall@10: 0.7655
2020-01-07 11:04:10,104 ====> Recall@15: 0.7864
2020-01-07 11:04:10,105 ====> Recall@20: 0.7928
2020-01-07 11:04:10,105 ====> Recall@25: 0.7997
2020-01-07 11:04:10,172 ====> Building Cache
2020-01-07 11:04:10,173 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-07 11:06:26,264 Allocated:31.03076171875 MB
2020-01-07 11:06:26,265 Cached:9902.625 MB
2020-01-07 11:07:16,879 ==> Task[1]Epoch[11](50/415): Loss: 0.0226
2020-01-07 11:07:16,881 Allocated:33.03076171875 MB
2020-01-07 11:07:16,881 Cached:1111.5 MB
2020-01-07 11:07:53,894 ==> Task[1]Epoch[11](100/415): Loss: 0.1782
2020-01-07 11:07:53,897 Allocated:33.03076171875 MB
2020-01-07 11:07:53,897 Cached:1111.5 MB
2020-01-07 11:08:27,635 ==> Task[1]Epoch[11](150/415): Loss: 0.0167
2020-01-07 11:08:27,636 Allocated:33.03076171875 MB
2020-01-07 11:08:27,636 Cached:1111.5 MB
2020-01-07 11:09:32,208 ==> Task[1]Epoch[11](250/415): Loss: 0.0572
2020-01-07 11:09:32,210 Allocated:33.03076171875 MB
2020-01-07 11:09:32,210 Cached:1111.5 MB
2020-01-07 11:10:28,318 ==> Task[1]Epoch[11](300/415): Loss: 0.0591
2020-01-07 11:10:28,319 Allocated:33.03076171875 MB
2020-01-07 11:10:28,319 Cached:1112.5 MB
2020-01-07 11:11:13,503 ==> Task[1]Epoch[11](350/415): Loss: 0.0259
2020-01-07 11:11:13,504 Allocated:33.03076171875 MB
2020-01-07 11:11:13,505 Cached:1111.5 MB
2020-01-07 11:12:00,224 ==> Task[1]Epoch[11](400/415): Loss: 0.0455
2020-01-07 11:12:00,226 Allocated:33.03076171875 MB
2020-01-07 11:12:00,226 Cached:1111.5 MB
2020-01-07 11:12:12,546 ===> Task 1 Epoch 11 Complete: Avg. Loss: 0.0685
2020-01-07 11:12:12,547 begin test:
2020-01-07 11:12:12,548 ====> Extracting Features
2020-01-07 11:13:21,092 ==> Batch (50/72)
2020-01-07 11:13:45,932 ====> Building faiss index
2020-01-07 11:13:45,934 ====> Calculating recall @ N
2020-01-07 11:13:46,393 ====> Recall@1: 0.6710
2020-01-07 11:13:46,394 ====> Recall@2: 0.6980
2020-01-07 11:13:46,394 ====> Recall@3: 0.7162
2020-01-07 11:13:46,394 ====> Recall@4: 0.7293
2020-01-07 11:13:46,394 ====> Recall@5: 0.7342
2020-01-07 11:13:46,395 ====> Recall@10: 0.7597
2020-01-07 11:13:46,395 ====> Recall@15: 0.7820
2020-01-07 11:13:46,395 ====> Recall@20: 0.7930
2020-01-07 11:13:46,395 ====> Recall@25: 0.7988
2020-01-07 11:13:46,460 ====> Building Cache
2020-01-07 11:13:46,461 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-07 11:16:03,002 Allocated:31.03076171875 MB
2020-01-07 11:16:03,002 Cached:9902.625 MB
2020-01-07 11:16:51,826 ==> Task[1]Epoch[12](50/415): Loss: 0.0457
2020-01-07 11:16:51,828 Allocated:33.03076171875 MB
2020-01-07 11:16:51,828 Cached:1111.5 MB
2020-01-07 11:17:29,370 ==> Task[1]Epoch[12](100/415): Loss: 0.1766
2020-01-07 11:17:29,372 Allocated:33.03076171875 MB
2020-01-07 11:17:29,373 Cached:1111.5 MB
2020-01-07 11:18:03,009 ==> Task[1]Epoch[12](150/415): Loss: 0.0386
2020-01-07 11:18:03,010 Allocated:33.03076171875 MB
2020-01-07 11:18:03,011 Cached:1111.5 MB
2020-01-07 11:19:07,172 ==> Task[1]Epoch[12](250/415): Loss: 0.0532
2020-01-07 11:19:07,174 Allocated:33.03076171875 MB
2020-01-07 11:19:07,174 Cached:1111.5 MB
2020-01-07 11:20:04,961 ==> Task[1]Epoch[12](300/415): Loss: 0.0431
2020-01-07 11:20:04,962 Allocated:33.03076171875 MB
2020-01-07 11:20:04,962 Cached:1111.5 MB
2020-01-07 11:20:49,757 ==> Task[1]Epoch[12](350/415): Loss: 0.0226
2020-01-07 11:20:49,758 Allocated:33.03076171875 MB
2020-01-07 11:20:49,759 Cached:1111.5 MB
2020-01-07 11:21:34,268 ==> Task[1]Epoch[12](400/415): Loss: 0.0417
2020-01-07 11:21:34,270 Allocated:33.03076171875 MB
2020-01-07 11:21:34,271 Cached:1111.5 MB
2020-01-07 11:21:45,986 ===> Task 1 Epoch 12 Complete: Avg. Loss: 0.0677
2020-01-07 11:21:45,988 begin test:
2020-01-07 11:21:45,988 ====> Extracting Features
2020-01-07 11:22:56,593 ==> Batch (50/72)
2020-01-07 11:23:22,215 ====> Building faiss index
2020-01-07 11:23:22,217 ====> Calculating recall @ N
2020-01-07 11:23:22,673 ====> Recall@1: 0.6716
2020-01-07 11:23:22,674 ====> Recall@2: 0.6971
2020-01-07 11:23:22,674 ====> Recall@3: 0.7142
2020-01-07 11:23:22,675 ====> Recall@4: 0.7284
2020-01-07 11:23:22,675 ====> Recall@5: 0.7354
2020-01-07 11:23:22,675 ====> Recall@10: 0.7533
2020-01-07 11:23:22,675 ====> Recall@15: 0.7751
2020-01-07 11:23:22,675 ====> Recall@20: 0.7875
2020-01-07 11:23:22,675 ====> Recall@25: 0.7983
2020-01-07 11:23:22,738 ====> Building Cache
2020-01-07 11:23:22,739 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-07 11:25:43,455 Allocated:31.03076171875 MB
2020-01-07 11:25:43,455 Cached:9902.625 MB
2020-01-07 11:26:32,743 ==> Task[1]Epoch[13](50/415): Loss: 0.0283
2020-01-07 11:26:32,745 Allocated:33.03076171875 MB
2020-01-07 11:26:32,745 Cached:1112.5 MB
2020-01-07 11:27:09,541 ==> Task[1]Epoch[13](100/415): Loss: 0.1786
2020-01-07 11:27:09,543 Allocated:33.03076171875 MB
2020-01-07 11:27:09,543 Cached:1111.5 MB
2020-01-07 11:27:42,226 ==> Task[1]Epoch[13](150/415): Loss: 0.0297
2020-01-07 11:27:42,227 Allocated:33.03076171875 MB
2020-01-07 11:27:42,227 Cached:1111.5 MB
2020-01-07 11:28:44,194 ==> Task[1]Epoch[13](250/415): Loss: 0.0675
2020-01-07 11:28:44,195 Allocated:33.03076171875 MB
2020-01-07 11:28:44,196 Cached:1111.5 MB
2020-01-07 11:29:43,238 ==> Task[1]Epoch[13](300/415): Loss: 0.0452
2020-01-07 11:29:43,240 Allocated:33.03076171875 MB
2020-01-07 11:29:43,240 Cached:1111.5 MB
2020-01-07 11:30:28,396 ==> Task[1]Epoch[13](350/415): Loss: 0.0267
2020-01-07 11:30:28,398 Allocated:33.03076171875 MB
2020-01-07 11:30:28,398 Cached:1111.5 MB
2020-01-07 11:31:11,354 ==> Task[1]Epoch[13](400/415): Loss: 0.0550
2020-01-07 11:31:11,355 Allocated:33.03076171875 MB
2020-01-07 11:31:11,355 Cached:1111.5 MB
2020-01-07 11:31:25,329 ===> Task 1 Epoch 13 Complete: Avg. Loss: 0.0668
2020-01-07 11:31:25,334 begin test:
2020-01-07 11:31:25,341 ====> Extracting Features
2020-01-07 11:32:40,909 ==> Batch (50/72)
2020-01-07 11:33:06,993 ====> Building faiss index
2020-01-07 11:33:06,995 ====> Calculating recall @ N
2020-01-07 11:33:07,483 ====> Recall@1: 0.6725
2020-01-07 11:33:07,483 ====> Recall@2: 0.6986
2020-01-07 11:33:07,484 ====> Recall@3: 0.7145
2020-01-07 11:33:07,484 ====> Recall@4: 0.7281
2020-01-07 11:33:07,484 ====> Recall@5: 0.7339
2020-01-07 11:33:07,484 ====> Recall@10: 0.7522
2020-01-07 11:33:07,485 ====> Recall@15: 0.7742
2020-01-07 11:33:07,485 ====> Recall@20: 0.7904
2020-01-07 11:33:07,485 ====> Recall@25: 0.7974
2020-01-07 11:33:07,545 Performance did not improve for 10 epochs. Stopping.
2020-01-07 11:33:07,546 => Best Recall@5: 0.7768
