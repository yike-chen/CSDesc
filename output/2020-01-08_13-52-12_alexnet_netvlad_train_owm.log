2020-01-08 13:52:12,017 Namespace(arch='alexnet', batchSize=12, cacheBatchSize=96, cachePath='/home/annora/NetVLAD/output/', cacheRefreshRate=3000, ckpt='best', contilearn=True, dataPath='/home/annora/NetVLAD/output/data/', dataset='robotcar', evalEvery=1, fromscratch=False, lr=0.0001, lrGamma=0.5, lrStep=5, margin=0.1, mode='train', momentum=0.9, nEpochs=30, nGPU=1, nocuda=False, num_clusters=64, optim='SGD', patience=10, pooling='netvlad', premodel='imagenet', resume='', runsPath='/home/annora/NetVLAD/output/runs/', savePath='checkpoints', seed=123, split='val', start_epoch=0, threads=8, vladv2=False, weightDecay=0.001)
2020-01-08 13:52:12,089 ===> Loading dataset(s)
2020-01-08 13:52:14,957 ====> Training query set: 6636
2020-01-08 13:52:15,067 ===> Evaluating on val set, query count: 3450
2020-01-08 13:52:15,067 ===> Building model
2020-01-08 13:52:15,118 encoder moder:
AlexNet(
  (conv1): Sequential(
    (0): Conv2d(3, 64, kernel_size=(11, 11), stride=(4, 4), padding=(2, 2))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(64, 192, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv3): Sequential(
    (0): Conv2d(192, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv4): Sequential(
    (0): Conv2d(384, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv5): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  )
)
2020-01-08 13:52:20,118 ===> Training model
2020-01-08 13:52:20,122 ===> Saving state to: /home/annora/NetVLAD/output/runs/2020-01-08-13-52-20_alexnet_netvlad
2020-01-08 13:52:20,166 ====> Building Cache
2020-01-08 13:52:20,167 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-08 13:53:41,883 Allocated:99.47119140625 MB
2020-01-08 13:53:41,883 Cached:2865.375 MB
2020-01-08 13:56:43,802 ==> Epoch[1](50/553): Loss: 0.1098
2020-01-08 13:56:43,805 Allocated:121.40869140625 MB
2020-01-08 13:56:43,805 Cached:9250.375 MB
2020-01-08 13:58:58,173 ==> Epoch[1](100/553): Loss: 0.0788
2020-01-08 13:58:58,174 Allocated:121.78369140625 MB
2020-01-08 13:58:58,175 Cached:9250.375 MB
2020-01-08 14:01:21,836 ==> Epoch[1](150/553): Loss: 0.1049
2020-01-08 14:01:21,838 Allocated:121.28369140625 MB
2020-01-08 14:01:21,838 Cached:9250.375 MB
2020-01-08 14:02:54,181 ====> Building Cache
2020-01-08 14:02:54,184 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-08 14:04:18,790 Allocated:121.408203125 MB
2020-01-08 14:04:18,791 Cached:2931.5 MB
2020-01-08 14:05:49,494 ==> Epoch[1](200/553): Loss: 0.1515
2020-01-08 14:05:49,496 Allocated:121.90869140625 MB
2020-01-08 14:05:49,496 Cached:8063.875 MB
2020-01-08 14:08:03,785 ==> Epoch[1](250/553): Loss: 0.1570
2020-01-08 14:08:03,788 Allocated:121.28369140625 MB
2020-01-08 14:08:03,789 Cached:8063.875 MB
2020-01-08 14:10:30,704 ==> Epoch[1](300/553): Loss: 0.1347
2020-01-08 14:10:30,708 Allocated:121.40869140625 MB
2020-01-08 14:10:30,708 Cached:8063.875 MB
2020-01-08 14:12:47,217 ==> Epoch[1](350/553): Loss: 0.1923
2020-01-08 14:12:47,221 Allocated:121.40869140625 MB
2020-01-08 14:12:47,221 Cached:8063.875 MB
2020-01-08 14:13:38,157 ====> Building Cache
2020-01-08 14:13:38,159 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-08 14:15:03,239 Allocated:121.283203125 MB
2020-01-08 14:15:03,240 Cached:3236.125 MB
2020-01-08 14:16:59,612 ==> Epoch[1](400/553): Loss: 0.1958
2020-01-08 14:16:59,615 Allocated:121.28369140625 MB
2020-01-08 14:16:59,615 Cached:4810.625 MB
2020-01-08 14:19:04,981 ==> Epoch[1](450/553): Loss: 0.2018
2020-01-08 14:19:04,984 Allocated:121.65869140625 MB
2020-01-08 14:19:04,984 Cached:4810.625 MB
2020-01-08 14:21:21,582 ==> Epoch[1](500/553): Loss: 0.1689
2020-01-08 14:21:21,583 Allocated:121.90869140625 MB
2020-01-08 14:21:21,584 Cached:4810.625 MB
2020-01-08 14:23:23,006 ==> Epoch[1](550/553): Loss: 0.1966
2020-01-08 14:23:23,008 Allocated:121.40869140625 MB
2020-01-08 14:23:23,008 Cached:4810.625 MB
2020-01-08 14:23:34,272 ===> Epoch 1 Complete: Avg. Loss: 0.1486
2020-01-08 14:23:34,273 ====> Extracting Features
2020-01-08 14:24:10,188 ==> Batch (50/108)
2020-01-08 14:24:33,845 ==> Batch (100/108)
2020-01-08 14:24:37,710 ====> Building faiss index
2020-01-08 14:24:38,281 ====> Calculating recall @ N
2020-01-08 14:24:41,372 ====> Recall@1: 0.7606
2020-01-08 14:24:41,373 ====> Recall@2: 0.7690
2020-01-08 14:24:41,374 ====> Recall@3: 0.7742
2020-01-08 14:24:41,375 ====> Recall@4: 0.7780
2020-01-08 14:24:41,376 ====> Recall@5: 0.7841
2020-01-08 14:24:41,376 ====> Recall@10: 0.7957
2020-01-08 14:24:41,377 ====> Recall@15: 0.8012
2020-01-08 14:24:41,377 ====> Recall@20: 0.8087
2020-01-08 14:24:41,378 ====> Recall@25: 0.8186
2020-01-08 14:24:41,838 ====> Building Cache
2020-01-08 14:24:41,838 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-08 14:26:08,916 Allocated:119.40869140625 MB
2020-01-08 14:26:08,917 Cached:4234.25 MB
2020-01-08 14:29:14,535 ==> Epoch[2](50/553): Loss: 0.1092
2020-01-08 14:29:14,537 Allocated:121.78369140625 MB
2020-01-08 14:29:14,538 Cached:7352.125 MB
2020-01-08 14:31:20,370 ==> Epoch[2](100/553): Loss: 0.0806
2020-01-08 14:31:20,373 Allocated:122.28369140625 MB
2020-01-08 14:31:20,373 Cached:7352.125 MB
2020-01-08 14:33:29,367 ==> Epoch[2](150/553): Loss: 0.0965
2020-01-08 14:33:29,369 Allocated:121.40869140625 MB
2020-01-08 14:33:29,369 Cached:7352.125 MB
2020-01-08 14:35:34,971 ====> Building Cache
2020-01-08 14:35:34,972 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-08 14:36:58,702 Allocated:121.783203125 MB
2020-01-08 14:36:58,703 Cached:3064.5 MB
2020-01-08 14:38:45,251 ==> Epoch[2](200/553): Loss: 0.1793
2020-01-08 14:38:45,253 Allocated:122.53369140625 MB
2020-01-08 14:38:45,253 Cached:8203.25 MB
2020-01-08 14:41:25,536 ==> Epoch[2](250/553): Loss: 0.1159
2020-01-08 14:41:25,538 Allocated:121.40869140625 MB
2020-01-08 14:41:25,538 Cached:8203.25 MB
2020-01-08 14:43:41,170 ==> Epoch[2](300/553): Loss: 0.1619
2020-01-08 14:43:41,172 Allocated:121.28369140625 MB
2020-01-08 14:43:41,172 Cached:8203.25 MB
2020-01-08 14:45:45,123 ==> Epoch[2](350/553): Loss: 0.1455
2020-01-08 14:45:45,125 Allocated:121.65869140625 MB
2020-01-08 14:45:45,126 Cached:8203.25 MB
2020-01-08 14:46:32,965 ====> Building Cache
2020-01-08 14:46:32,966 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-08 14:47:53,938 Allocated:121.783203125 MB
2020-01-08 14:47:53,938 Cached:3064.5 MB
2020-01-08 14:49:57,358 ==> Epoch[2](400/553): Loss: 0.2138
2020-01-08 14:49:57,361 Allocated:121.90869140625 MB
2020-01-08 14:49:57,362 Cached:4905.875 MB
2020-01-08 14:52:11,311 ==> Epoch[2](450/553): Loss: 0.2090
2020-01-08 14:52:11,313 Allocated:121.90869140625 MB
2020-01-08 14:52:11,313 Cached:4905.875 MB
2020-01-08 14:54:12,019 ==> Epoch[2](500/553): Loss: 0.2266
2020-01-08 14:54:12,021 Allocated:121.78369140625 MB
2020-01-08 14:54:12,021 Cached:4905.875 MB
2020-01-08 14:57:07,631 ==> Epoch[2](550/553): Loss: 0.1957
2020-01-08 14:57:07,640 Allocated:121.28369140625 MB
2020-01-08 14:57:07,642 Cached:4905.875 MB
2020-01-08 14:57:28,717 ===> Epoch 2 Complete: Avg. Loss: 0.1480
2020-01-08 14:57:28,721 ====> Extracting Features
2020-01-08 14:58:08,278 ==> Batch (50/108)
2020-01-08 14:58:31,601 ==> Batch (100/108)
2020-01-08 14:58:37,318 ====> Building faiss index
2020-01-08 14:58:38,096 ====> Calculating recall @ N
2020-01-08 14:58:40,731 ====> Recall@1: 0.7609
2020-01-08 14:58:40,732 ====> Recall@2: 0.7693
2020-01-08 14:58:40,733 ====> Recall@3: 0.7745
2020-01-08 14:58:40,734 ====> Recall@4: 0.7786
2020-01-08 14:58:40,734 ====> Recall@5: 0.7841
2020-01-08 14:58:40,735 ====> Recall@10: 0.7959
2020-01-08 14:58:40,736 ====> Recall@15: 0.8012
2020-01-08 14:58:40,737 ====> Recall@20: 0.8090
2020-01-08 14:58:40,737 ====> Recall@25: 0.8191
2020-01-08 14:58:41,296 ====> Building Cache
2020-01-08 14:58:41,296 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-08 15:00:04,161 Allocated:119.28369140625 MB
2020-01-08 15:00:04,162 Cached:4233.25 MB
2020-01-08 15:03:53,206 ==> Epoch[3](50/553): Loss: 0.1171
2020-01-08 15:03:53,208 Allocated:121.40869140625 MB
2020-01-08 15:03:53,208 Cached:9380.375 MB
2020-01-08 15:06:31,410 ==> Epoch[3](100/553): Loss: 0.1262
2020-01-08 15:06:31,412 Allocated:121.53369140625 MB
2020-01-08 15:06:31,413 Cached:9380.375 MB
2020-01-08 15:08:42,367 ==> Epoch[3](150/553): Loss: 0.1503
2020-01-08 15:08:42,370 Allocated:121.40869140625 MB
2020-01-08 15:08:42,370 Cached:9380.375 MB
2020-01-08 15:10:08,317 ====> Building Cache
2020-01-08 15:10:08,318 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-08 15:11:35,553 Allocated:121.283203125 MB
2020-01-08 15:11:35,554 Cached:3643.5 MB
2020-01-08 15:13:10,063 ==> Epoch[3](200/553): Loss: 0.2262
2020-01-08 15:13:10,065 Allocated:121.28369140625 MB
2020-01-08 15:13:10,065 Cached:6083.5 MB
2020-01-08 15:15:14,822 ==> Epoch[3](250/553): Loss: 0.1800
2020-01-08 15:15:14,824 Allocated:123.03369140625 MB
2020-01-08 15:15:14,825 Cached:6083.5 MB
2020-01-08 15:17:17,337 ==> Epoch[3](300/553): Loss: 0.1547
2020-01-08 15:17:17,338 Allocated:121.65869140625 MB
2020-01-08 15:17:17,338 Cached:6083.5 MB
2020-01-08 15:19:18,684 ==> Epoch[3](350/553): Loss: 0.1721
2020-01-08 15:19:18,686 Allocated:121.40869140625 MB
2020-01-08 15:19:18,687 Cached:6083.5 MB
2020-01-08 15:20:04,649 ====> Building Cache
2020-01-08 15:20:04,649 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-08 15:21:28,272 Allocated:121.408203125 MB
2020-01-08 15:21:28,273 Cached:3683.5 MB
2020-01-08 15:23:26,570 ==> Epoch[3](400/553): Loss: 0.1513
2020-01-08 15:23:26,572 Allocated:122.90869140625 MB
2020-01-08 15:23:26,572 Cached:3843.0 MB
2020-01-08 15:26:07,972 ==> Epoch[3](450/553): Loss: 0.0896
2020-01-08 15:26:07,974 Allocated:122.03369140625 MB
2020-01-08 15:26:07,975 Cached:6983.625 MB
2020-01-08 15:28:09,458 ==> Epoch[3](500/553): Loss: 0.1539
2020-01-08 15:28:09,459 Allocated:121.53369140625 MB
2020-01-08 15:28:09,460 Cached:6983.625 MB
2020-01-08 15:31:05,421 ==> Epoch[3](550/553): Loss: 0.1712
2020-01-08 15:31:05,430 Allocated:121.40869140625 MB
2020-01-08 15:31:05,436 Cached:6983.625 MB
2020-01-08 15:31:34,809 ===> Epoch 3 Complete: Avg. Loss: 0.1468
2020-01-08 15:31:34,813 ====> Extracting Features
2020-01-08 15:32:13,657 ==> Batch (50/108)
2020-01-08 15:32:37,092 ==> Batch (100/108)
2020-01-08 15:32:41,688 ====> Building faiss index
2020-01-08 15:32:42,057 ====> Calculating recall @ N
2020-01-08 15:32:44,327 ====> Recall@1: 0.7606
2020-01-08 15:32:44,327 ====> Recall@2: 0.7696
2020-01-08 15:32:44,328 ====> Recall@3: 0.7745
2020-01-08 15:32:44,328 ====> Recall@4: 0.7783
2020-01-08 15:32:44,328 ====> Recall@5: 0.7841
2020-01-08 15:32:44,329 ====> Recall@10: 0.7957
2020-01-08 15:32:44,329 ====> Recall@15: 0.8014
2020-01-08 15:32:44,329 ====> Recall@20: 0.8087
2020-01-08 15:32:44,329 ====> Recall@25: 0.8191
2020-01-08 15:32:44,759 ====> Building Cache
2020-01-08 15:32:44,759 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache.hdf5
