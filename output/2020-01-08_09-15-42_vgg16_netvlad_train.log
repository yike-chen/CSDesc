2020-01-08 09:15:42,724 Namespace(arch='vgg16', batchSize=16, cacheBatchSize=144, cachePath='/home/annora/NetVLAD/output/', cacheRefreshRate=1000, ckpt='best', contilearn=False, dataPath='/home/annora/NetVLAD/output/data/', dataset='robotcar', evalEvery=1, fromscratch=False, lr=0.0001, lrGamma=0.5, lrStep=5, margin=0.1, mode='train', momentum=0.9, nEpochs=30, nGPU=1, nocuda=False, num_clusters=64, optim='SGD', patience=10, pooling='netvlad', premodel='imagenet', resume='', runsPath='/home/annora/NetVLAD/output/runs/', savePath='checkpoints', seed=123, split='val', start_epoch=0, threads=8, vladv2=True, weightDecay=0.001)
2020-01-08 09:15:42,830 ===> Loading dataset(s)
2020-01-08 09:15:45,379 ====> Training query set: 6636
2020-01-08 09:15:45,472 ===> Evaluating on val set, query count: 3450
2020-01-08 09:15:45,472 ===> Building model
2020-01-08 09:15:45,734 encoder moder:
VGG16(
  (conv1): Sequential(
    (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv2): Sequential(
    (0): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv3): Sequential(
    (0): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv4): Sequential(
    (0): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv5): Sequential(
    (0): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv6): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv7): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv8): Sequential(
    (0): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv9): Sequential(
    (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv10): Sequential(
    (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv11): Sequential(
    (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv12): Sequential(
    (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv13): Sequential(
    (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  )
  (conv13_relu_maxpool): Sequential(
    (0): ReLU(inplace)
    (1): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
)
2020-01-08 09:15:52,792 ===> Training model
2020-01-08 09:15:52,793 ===> Saving state to: /home/annora/NetVLAD/output/runs/Jan08_09-15-52_vgg16_netvlad
2020-01-08 09:15:52,794 ====> Building Cache
2020-01-08 09:15:52,794 feature cache.... /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-08 09:17:28,753 Allocated:109.89501953125 MB
2020-01-08 09:17:28,754 Cached:9490.75 MB
2020-01-08 09:18:46,628 CUDA out of memory. Tried to allocate 1.76 GiB (GPU 0; 10.73 GiB total capacity; 8.20 GiB already allocated; 1.34 GiB free; 414.48 MiB cached)
Traceback (most recent call last):
  File "rawlearning_vlad.py", line 776, in <module>
    train(epoch)
  File "rawlearning_vlad.py", line 143, in train
    image_encoding, x_list = model.encoder(input, B)
  File "/home/annora/anaconda3/envs/pytorch_netvlad/lib/python3.6/site-packages/torch/nn/modules/module.py", line 489, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/annora/pytorch-NetVlad/vgg16.py", line 98, in forward
    conv2_out = self.conv2(conv1_out)
  File "/home/annora/anaconda3/envs/pytorch_netvlad/lib/python3.6/site-packages/torch/nn/modules/module.py", line 489, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/annora/anaconda3/envs/pytorch_netvlad/lib/python3.6/site-packages/torch/nn/modules/container.py", line 92, in forward
    input = module(input)
  File "/home/annora/anaconda3/envs/pytorch_netvlad/lib/python3.6/site-packages/torch/nn/modules/module.py", line 489, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/annora/anaconda3/envs/pytorch_netvlad/lib/python3.6/site-packages/torch/nn/modules/pooling.py", line 148, in forward
    self.return_indices)
  File "/home/annora/anaconda3/envs/pytorch_netvlad/lib/python3.6/site-packages/torch/_jit_internal.py", line 132, in fn
    return if_false(*args, **kwargs)
  File "/home/annora/anaconda3/envs/pytorch_netvlad/lib/python3.6/site-packages/torch/nn/functional.py", line 425, in _max_pool2d
    input, kernel_size, stride, padding, dilation, ceil_mode)[0]
  File "/home/annora/anaconda3/envs/pytorch_netvlad/lib/python3.6/site-packages/torch/nn/functional.py", line 417, in max_pool2d_with_indices
    return torch._C._nn.max_pool2d_with_indices(input, kernel_size, _stride, padding, dilation, ceil_mode)
RuntimeError: CUDA out of memory. Tried to allocate 1.76 GiB (GPU 0; 10.73 GiB total capacity; 8.20 GiB already allocated; 1.34 GiB free; 414.48 MiB cached)
