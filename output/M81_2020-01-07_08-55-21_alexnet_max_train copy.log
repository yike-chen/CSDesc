2020-01-07 08:55:21,983 Namespace(arch='alexnet', batchSize=16, cacheBatchSize=144, cachePath='/home/annora/NetVLAD/output/', cacheRefreshRate=0, ckpt='best', ckpt_diy='model_best0.pth.tar', contilearn=False, dataPath='/home/annora/NetVLAD/output/data/', dataset='pittsburgh', debug_file='', evalEvery=1, fromscratch=False, lr=0.0001, lrGamma=0.5, lrStep=5, margin=0.1, mode='train', momentum=0.9, nEpochs=30, nGPU=1, nocuda=False, num_clusters=64, optim='SGD', patience=10, pooling='max', premodel='places', resume='', runsPath='/home/annora/NetVLAD/output/runs/', savePath='checkpoints', seed=123, split='val', start_epoch=0, threads=4, vladv2=False, weightDecay=0.001)
2020-01-07 08:55:22,039 ===> Loading dataset(s)
2020-01-07 08:55:22,039 ===> Building model
2020-01-07 08:55:22,097 encoder moder:
AlexNet(
  (conv1): Sequential(
    (0): Conv2d(3, 64, kernel_size=(11, 11), stride=(4, 4), padding=(2, 2))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(64, 192, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv3): Sequential(
    (0): Conv2d(192, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv4): Sequential(
    (0): Conv2d(384, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv5): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  )
)
2020-01-07 08:55:25,861 ---->>>> trainfiles: ['oxRobocar_single_train.mat']
2020-01-07 08:55:25,862 ===> Saving state to: /home/annora/NetVLAD/output/runs/2020-01-07-08-55-25_alexnet_max
2020-01-07 08:55:28,520 ====> Training query set:6636
2020-01-07 08:55:28,621 ===> Evaluating on val set, query count:3450
2020-01-07 08:55:28,622 ---->>>> testfile: oxRobocar_single_val.mat
2020-01-07 08:55:28,622 ===> Training model
2020-01-07 08:55:28,622 ====> Building Cache
2020-01-07 08:55:28,622 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 08:57:45,093 Allocated:11.59326171875 MB
2020-01-07 08:57:45,094 Cached:2595.125 MB
2020-01-07 08:59:26,394 ==> Task[1]Epoch[1](50/415): Loss: 0.2092
2020-01-07 08:59:26,397 Allocated:33.03076171875 MB
2020-01-07 08:59:26,397 Cached:1112.5 MB
2020-01-07 09:00:50,465 ==> Task[1]Epoch[1](100/415): Loss: 0.2387
2020-01-07 09:00:50,467 Allocated:33.03076171875 MB
2020-01-07 09:00:50,467 Cached:1112.5 MB
2020-01-07 09:02:16,040 ==> Task[1]Epoch[1](150/415): Loss: 0.2365
2020-01-07 09:02:16,042 Allocated:33.03076171875 MB
2020-01-07 09:02:16,042 Cached:1112.5 MB
2020-01-07 09:03:36,728 ==> Task[1]Epoch[1](200/415): Loss: 0.2322
2020-01-07 09:03:36,730 Allocated:33.03076171875 MB
2020-01-07 09:03:36,730 Cached:1112.5 MB
2020-01-07 09:05:01,895 ==> Task[1]Epoch[1](250/415): Loss: 0.2139
2020-01-07 09:05:01,896 Allocated:33.03076171875 MB
2020-01-07 09:05:01,897 Cached:1112.5 MB
2020-01-07 09:06:26,608 ==> Task[1]Epoch[1](300/415): Loss: 0.2519
2020-01-07 09:06:26,610 Allocated:33.03076171875 MB
2020-01-07 09:06:26,610 Cached:1112.5 MB
2020-01-07 09:07:48,488 ==> Task[1]Epoch[1](350/415): Loss: 0.2117
2020-01-07 09:07:48,490 Allocated:33.03076171875 MB
2020-01-07 09:07:48,490 Cached:1112.5 MB
2020-01-07 09:09:13,314 ==> Task[1]Epoch[1](400/415): Loss: 0.1917
2020-01-07 09:09:13,316 Allocated:33.03076171875 MB
2020-01-07 09:09:13,316 Cached:1112.5 MB
2020-01-07 09:09:37,385 ===> Task 1 Epoch 1 Complete: Avg. Loss: 0.2305
2020-01-07 09:09:37,387 begin test:
2020-01-07 09:09:37,388 ====> Extracting Features
2020-01-07 09:10:46,602 ==> Batch (50/72)
2020-01-07 09:11:11,586 ====> Building faiss index
2020-01-07 09:11:11,588 ====> Calculating recall @ N
2020-01-07 09:11:12,102 ====> Recall@1: 0.7232
2020-01-07 09:11:12,102 ====> Recall@2: 0.7487
2020-01-07 09:11:12,103 ====> Recall@3: 0.7609
2020-01-07 09:11:12,103 ====> Recall@4: 0.7681
2020-01-07 09:11:12,103 ====> Recall@5: 0.7736
2020-01-07 09:11:12,103 ====> Recall@10: 0.7858
2020-01-07 09:11:12,104 ====> Recall@15: 0.7910
2020-01-07 09:11:12,104 ====> Recall@20: 0.7948
2020-01-07 09:11:12,104 ====> Recall@25: 0.8035
2020-01-07 09:11:12,141 ====> Building Cache
2020-01-07 09:11:12,141 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 09:13:28,087 Allocated:31.03076171875 MB
2020-01-07 09:13:28,087 Cached:9902.625 MB
2020-01-07 09:15:09,626 ==> Task[1]Epoch[2](50/415): Loss: 0.1842
2020-01-07 09:15:09,628 Allocated:33.03076171875 MB
2020-01-07 09:15:09,628 Cached:1112.5 MB
2020-01-07 09:16:32,841 ==> Task[1]Epoch[2](100/415): Loss: 0.2107
2020-01-07 09:16:32,842 Allocated:33.03076171875 MB
2020-01-07 09:16:32,842 Cached:1112.5 MB
2020-01-07 09:18:00,950 ==> Task[1]Epoch[2](150/415): Loss: 0.2035
2020-01-07 09:18:00,952 Allocated:33.03076171875 MB
2020-01-07 09:18:00,952 Cached:1112.5 MB
2020-01-07 09:19:24,596 ==> Task[1]Epoch[2](200/415): Loss: 0.1571
2020-01-07 09:19:24,598 Allocated:33.03076171875 MB
2020-01-07 09:19:24,598 Cached:1112.5 MB
2020-01-07 09:20:53,552 ==> Task[1]Epoch[2](250/415): Loss: 0.1824
2020-01-07 09:20:53,554 Allocated:33.03076171875 MB
2020-01-07 09:20:53,554 Cached:1112.5 MB
2020-01-07 09:22:15,348 ==> Task[1]Epoch[2](300/415): Loss: 0.2200
2020-01-07 09:22:15,349 Allocated:33.03076171875 MB
2020-01-07 09:22:15,349 Cached:1112.5 MB
2020-01-07 09:23:43,384 ==> Task[1]Epoch[2](350/415): Loss: 0.1797
2020-01-07 09:23:43,385 Allocated:33.03076171875 MB
2020-01-07 09:23:43,386 Cached:1112.5 MB
2020-01-07 09:25:05,638 ==> Task[1]Epoch[2](400/415): Loss: 0.1567
2020-01-07 09:25:05,640 Allocated:33.03076171875 MB
2020-01-07 09:25:05,640 Cached:1112.5 MB
2020-01-07 09:25:31,805 ===> Task 1 Epoch 2 Complete: Avg. Loss: 0.1996
2020-01-07 09:25:31,806 begin test:
2020-01-07 09:25:31,807 ====> Extracting Features
2020-01-07 09:26:42,683 ==> Batch (50/72)
2020-01-07 09:27:08,344 ====> Building faiss index
2020-01-07 09:27:08,346 ====> Calculating recall @ N
2020-01-07 09:27:08,769 ====> Recall@1: 0.7435
2020-01-07 09:27:08,770 ====> Recall@2: 0.7623
2020-01-07 09:27:08,770 ====> Recall@3: 0.7759
2020-01-07 09:27:08,770 ====> Recall@4: 0.7806
2020-01-07 09:27:08,770 ====> Recall@5: 0.7832
2020-01-07 09:27:08,771 ====> Recall@10: 0.7988
2020-01-07 09:27:08,771 ====> Recall@15: 0.8064
2020-01-07 09:27:08,771 ====> Recall@20: 0.8087
2020-01-07 09:27:08,771 ====> Recall@25: 0.8116
2020-01-07 09:27:08,889 ====> Building Cache
2020-01-07 09:27:08,889 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 09:29:24,660 Allocated:31.03076171875 MB
2020-01-07 09:29:24,661 Cached:9902.625 MB
2020-01-07 09:31:06,218 ==> Task[1]Epoch[3](50/415): Loss: 0.1466
2020-01-07 09:31:06,220 Allocated:33.03076171875 MB
2020-01-07 09:31:06,220 Cached:1112.5 MB
2020-01-07 09:32:28,528 ==> Task[1]Epoch[3](100/415): Loss: 0.1815
2020-01-07 09:32:28,530 Allocated:33.03076171875 MB
2020-01-07 09:32:28,530 Cached:1112.5 MB
2020-01-07 09:33:55,346 ==> Task[1]Epoch[3](150/415): Loss: 0.1733
2020-01-07 09:33:55,348 Allocated:33.03076171875 MB
2020-01-07 09:33:55,348 Cached:1111.5 MB
2020-01-07 09:35:17,666 ==> Task[1]Epoch[3](200/415): Loss: 0.0760
2020-01-07 09:35:17,668 Allocated:33.03076171875 MB
2020-01-07 09:35:17,668 Cached:1111.5 MB
2020-01-07 09:36:44,959 ==> Task[1]Epoch[3](250/415): Loss: 0.1398
2020-01-07 09:36:44,961 Allocated:33.03076171875 MB
2020-01-07 09:36:44,961 Cached:1111.5 MB
2020-01-07 09:38:07,120 ==> Task[1]Epoch[3](300/415): Loss: 0.1760
2020-01-07 09:38:07,122 Allocated:33.03076171875 MB
2020-01-07 09:38:07,122 Cached:1111.5 MB
2020-01-07 09:39:36,031 ==> Task[1]Epoch[3](350/415): Loss: 0.1394
2020-01-07 09:39:36,032 Allocated:33.03076171875 MB
2020-01-07 09:39:36,033 Cached:1111.5 MB
2020-01-07 09:40:59,100 ==> Task[1]Epoch[3](400/415): Loss: 0.1227
2020-01-07 09:40:59,101 Allocated:33.03076171875 MB
2020-01-07 09:40:59,101 Cached:1111.5 MB
2020-01-07 09:41:25,205 ===> Task 1 Epoch 3 Complete: Avg. Loss: 0.1609
2020-01-07 09:41:25,206 begin test:
2020-01-07 09:41:25,207 ====> Extracting Features
2020-01-07 09:42:34,428 ==> Batch (50/72)
2020-01-07 09:42:59,263 ====> Building faiss index
2020-01-07 09:42:59,265 ====> Calculating recall @ N
2020-01-07 09:42:59,674 ====> Recall@1: 0.7467
2020-01-07 09:42:59,675 ====> Recall@2: 0.7719
2020-01-07 09:42:59,676 ====> Recall@3: 0.7855
2020-01-07 09:42:59,676 ====> Recall@4: 0.7887
2020-01-07 09:42:59,676 ====> Recall@5: 0.7916
2020-01-07 09:42:59,676 ====> Recall@10: 0.8029
2020-01-07 09:42:59,676 ====> Recall@15: 0.8070
2020-01-07 09:42:59,676 ====> Recall@20: 0.8125
2020-01-07 09:42:59,677 ====> Recall@25: 0.8157
2020-01-07 09:42:59,786 ====> Building Cache
2020-01-07 09:42:59,786 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 09:45:15,606 Allocated:31.03076171875 MB
2020-01-07 09:45:15,607 Cached:9902.625 MB
2020-01-07 09:46:57,388 ==> Task[1]Epoch[4](50/415): Loss: 0.0794
2020-01-07 09:46:57,390 Allocated:33.03076171875 MB
2020-01-07 09:46:57,391 Cached:1111.5 MB
2020-01-07 09:48:18,172 ==> Task[1]Epoch[4](100/415): Loss: 0.1459
2020-01-07 09:48:18,174 Allocated:33.03076171875 MB
2020-01-07 09:48:18,174 Cached:1111.5 MB
2020-01-07 09:49:47,027 ==> Task[1]Epoch[4](150/415): Loss: 0.1263
2020-01-07 09:49:47,029 Allocated:33.03076171875 MB
2020-01-07 09:49:47,029 Cached:1111.5 MB
2020-01-07 09:51:08,114 ==> Task[1]Epoch[4](200/415): Loss: 0.0012
2020-01-07 09:51:08,118 Allocated:33.03076171875 MB
2020-01-07 09:51:08,118 Cached:1111.5 MB
2020-01-07 09:52:13,399 ==> Task[1]Epoch[4](250/415): Loss: 0.0674
2020-01-07 09:52:13,400 Allocated:33.03076171875 MB
2020-01-07 09:52:13,400 Cached:1111.5 MB
2020-01-07 09:53:35,575 ==> Task[1]Epoch[4](300/415): Loss: 0.1185
2020-01-07 09:53:35,577 Allocated:33.03076171875 MB
2020-01-07 09:53:35,577 Cached:1111.5 MB
2020-01-07 09:55:03,083 ==> Task[1]Epoch[4](350/415): Loss: 0.1113
2020-01-07 09:55:03,084 Allocated:33.03076171875 MB
2020-01-07 09:55:03,085 Cached:1111.5 MB
2020-01-07 09:56:23,155 ==> Task[1]Epoch[4](400/415): Loss: 0.0810
2020-01-07 09:56:23,157 Allocated:33.03076171875 MB
2020-01-07 09:56:23,157 Cached:1111.5 MB
2020-01-07 09:56:49,602 ===> Task 1 Epoch 4 Complete: Avg. Loss: 0.1173
2020-01-07 09:56:49,603 begin test:
2020-01-07 09:56:49,604 ====> Extracting Features
2020-01-07 09:57:58,539 ==> Batch (50/72)
2020-01-07 09:58:24,555 ====> Building faiss index
2020-01-07 09:58:24,557 ====> Calculating recall @ N
2020-01-07 09:58:24,997 ====> Recall@1: 0.6957
2020-01-07 09:58:24,998 ====> Recall@2: 0.7490
2020-01-07 09:58:24,998 ====> Recall@3: 0.7704
2020-01-07 09:58:24,998 ====> Recall@4: 0.7829
2020-01-07 09:58:24,999 ====> Recall@5: 0.7861
2020-01-07 09:58:24,999 ====> Recall@10: 0.8014
2020-01-07 09:58:24,999 ====> Recall@15: 0.8067
2020-01-07 09:58:24,999 ====> Recall@20: 0.8113
2020-01-07 09:58:24,999 ====> Recall@25: 0.8159
2020-01-07 09:58:25,057 ====> Building Cache
2020-01-07 09:58:25,057 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 10:00:42,805 Allocated:31.03076171875 MB
2020-01-07 10:00:42,806 Cached:9902.625 MB
2020-01-07 10:02:11,943 ==> Task[1]Epoch[5](50/415): Loss: 0.0372
2020-01-07 10:02:11,945 Allocated:33.03076171875 MB
2020-01-07 10:02:11,945 Cached:1112.5 MB
2020-01-07 10:03:25,069 ==> Task[1]Epoch[5](100/415): Loss: 0.1174
2020-01-07 10:03:25,071 Allocated:33.03076171875 MB
2020-01-07 10:03:25,071 Cached:1112.5 MB
2020-01-07 10:04:28,394 ==> Task[1]Epoch[5](150/415): Loss: 0.1124
2020-01-07 10:04:28,396 Allocated:33.03076171875 MB
2020-01-07 10:04:28,396 Cached:1111.5 MB
2020-01-07 10:06:26,418 ==> Task[1]Epoch[5](250/415): Loss: 0.0649
2020-01-07 10:06:26,420 Allocated:33.03076171875 MB
2020-01-07 10:06:26,420 Cached:1111.5 MB
2020-01-07 10:07:48,328 ==> Task[1]Epoch[5](300/415): Loss: 0.0975
2020-01-07 10:07:48,330 Allocated:33.03076171875 MB
2020-01-07 10:07:48,330 Cached:1112.5 MB
2020-01-07 10:09:04,305 ==> Task[1]Epoch[5](350/415): Loss: 0.0967
2020-01-07 10:09:04,307 Allocated:33.03076171875 MB
2020-01-07 10:09:04,307 Cached:1112.5 MB
2020-01-07 10:10:19,583 ==> Task[1]Epoch[5](400/415): Loss: 0.0745
2020-01-07 10:10:19,585 Allocated:33.03076171875 MB
2020-01-07 10:10:19,585 Cached:1111.5 MB
2020-01-07 10:10:34,308 ===> Task 1 Epoch 5 Complete: Avg. Loss: 0.0923
2020-01-07 10:10:34,309 begin test:
2020-01-07 10:10:34,310 ====> Extracting Features
2020-01-07 10:11:42,676 ==> Batch (50/72)
2020-01-07 10:12:07,571 ====> Building faiss index
2020-01-07 10:12:07,573 ====> Calculating recall @ N
2020-01-07 10:12:07,996 ====> Recall@1: 0.6838
2020-01-07 10:12:07,997 ====> Recall@2: 0.7365
2020-01-07 10:12:07,997 ====> Recall@3: 0.7568
2020-01-07 10:12:07,998 ====> Recall@4: 0.7638
2020-01-07 10:12:07,998 ====> Recall@5: 0.7684
2020-01-07 10:12:07,998 ====> Recall@10: 0.8000
2020-01-07 10:12:07,998 ====> Recall@15: 0.8075
2020-01-07 10:12:07,998 ====> Recall@20: 0.8116
2020-01-07 10:12:07,998 ====> Recall@25: 0.8171
2020-01-07 10:12:08,054 ====> Building Cache
2020-01-07 10:12:08,054 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 10:14:24,704 Allocated:31.03076171875 MB
2020-01-07 10:14:24,705 Cached:9902.625 MB
2020-01-07 10:15:44,511 ==> Task[1]Epoch[6](50/415): Loss: 0.0412
2020-01-07 10:15:44,513 Allocated:33.03076171875 MB
2020-01-07 10:15:44,513 Cached:1111.5 MB
2020-01-07 10:16:51,012 ==> Task[1]Epoch[6](100/415): Loss: 0.1091
2020-01-07 10:16:51,013 Allocated:33.03076171875 MB
2020-01-07 10:16:51,014 Cached:1111.5 MB
2020-01-07 10:17:46,775 ==> Task[1]Epoch[6](150/415): Loss: 0.1123
2020-01-07 10:17:46,777 Allocated:33.03076171875 MB
2020-01-07 10:17:46,778 Cached:1111.5 MB
2020-01-07 10:19:34,154 ==> Task[1]Epoch[6](250/415): Loss: 0.0647
2020-01-07 10:19:34,156 Allocated:33.03076171875 MB
2020-01-07 10:19:34,156 Cached:1111.5 MB
2020-01-07 10:20:53,633 ==> Task[1]Epoch[6](300/415): Loss: 0.0850
2020-01-07 10:20:53,635 Allocated:33.03076171875 MB
2020-01-07 10:20:53,636 Cached:1111.5 MB
2020-01-07 10:22:01,101 ==> Task[1]Epoch[6](350/415): Loss: 0.0934
2020-01-07 10:22:01,102 Allocated:33.03076171875 MB
2020-01-07 10:22:01,102 Cached:1112.5 MB
2020-01-07 10:23:07,362 ==> Task[1]Epoch[6](400/415): Loss: 0.0646
2020-01-07 10:23:07,364 Allocated:33.03076171875 MB
2020-01-07 10:23:07,364 Cached:1112.5 MB
2020-01-07 10:23:21,865 ===> Task 1 Epoch 6 Complete: Avg. Loss: 0.0835
2020-01-07 10:23:21,866 begin test:
2020-01-07 10:23:21,867 ====> Extracting Features
2020-01-07 10:24:31,200 ==> Batch (50/72)
2020-01-07 10:24:56,585 ====> Building faiss index
2020-01-07 10:24:56,591 ====> Calculating recall @ N
2020-01-07 10:24:57,107 ====> Recall@1: 0.7041
2020-01-07 10:24:57,108 ====> Recall@2: 0.7345
2020-01-07 10:24:57,108 ====> Recall@3: 0.7455
2020-01-07 10:24:57,109 ====> Recall@4: 0.7539
2020-01-07 10:24:57,109 ====> Recall@5: 0.7600
2020-01-07 10:24:57,109 ====> Recall@10: 0.7786
2020-01-07 10:24:57,110 ====> Recall@15: 0.8070
2020-01-07 10:24:57,110 ====> Recall@20: 0.8128
2020-01-07 10:24:57,110 ====> Recall@25: 0.8168
2020-01-07 10:24:57,167 ====> Building Cache
2020-01-07 10:24:57,168 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 10:27:17,895 Allocated:31.03076171875 MB
2020-01-07 10:27:17,896 Cached:9902.625 MB
2020-01-07 10:28:28,072 ==> Task[1]Epoch[7](50/415): Loss: 0.0334
2020-01-07 10:28:28,073 Allocated:33.03076171875 MB
2020-01-07 10:28:28,074 Cached:1111.5 MB
2020-01-07 10:29:27,484 ==> Task[1]Epoch[7](100/415): Loss: 0.1141
2020-01-07 10:29:27,486 Allocated:33.03076171875 MB
2020-01-07 10:29:27,486 Cached:1111.5 MB
2020-01-07 10:30:18,600 ==> Task[1]Epoch[7](150/415): Loss: 0.1093
2020-01-07 10:30:18,602 Allocated:33.03076171875 MB
2020-01-07 10:30:18,602 Cached:1111.5 MB
2020-01-07 10:31:55,607 ==> Task[1]Epoch[7](250/415): Loss: 0.0586
2020-01-07 10:31:55,609 Allocated:33.03076171875 MB
2020-01-07 10:31:55,609 Cached:1111.5 MB
2020-01-07 10:33:18,014 ==> Task[1]Epoch[7](300/415): Loss: 0.0750
2020-01-07 10:33:18,016 Allocated:33.03076171875 MB
2020-01-07 10:33:18,016 Cached:1111.5 MB
2020-01-07 10:34:22,063 ==> Task[1]Epoch[7](350/415): Loss: 0.0873
2020-01-07 10:34:22,065 Allocated:33.03076171875 MB
2020-01-07 10:34:22,065 Cached:1111.5 MB
2020-01-07 10:35:24,483 ==> Task[1]Epoch[7](400/415): Loss: 0.0566
2020-01-07 10:35:24,485 Allocated:33.03076171875 MB
2020-01-07 10:35:24,485 Cached:1111.5 MB
2020-01-07 10:35:38,213 ===> Task 1 Epoch 7 Complete: Avg. Loss: 0.0769
2020-01-07 10:35:38,214 begin test:
2020-01-07 10:35:38,215 ====> Extracting Features
2020-01-07 10:36:46,969 ==> Batch (50/72)
2020-01-07 10:37:12,797 ====> Building faiss index
2020-01-07 10:37:12,799 ====> Calculating recall @ N
2020-01-07 10:37:13,237 ====> Recall@1: 0.7023
2020-01-07 10:37:13,237 ====> Recall@2: 0.7348
2020-01-07 10:37:13,237 ====> Recall@3: 0.7443
2020-01-07 10:37:13,238 ====> Recall@4: 0.7490
2020-01-07 10:37:13,238 ====> Recall@5: 0.7528
2020-01-07 10:37:13,238 ====> Recall@10: 0.7736
2020-01-07 10:37:13,238 ====> Recall@15: 0.7887
2020-01-07 10:37:13,238 ====> Recall@20: 0.8084
2020-01-07 10:37:13,238 ====> Recall@25: 0.8162
2020-01-07 10:37:13,295 ====> Building Cache
2020-01-07 10:37:13,295 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 10:39:32,098 Allocated:31.03076171875 MB
2020-01-07 10:39:32,099 Cached:9902.625 MB
2020-01-07 10:40:36,054 ==> Task[1]Epoch[8](50/415): Loss: 0.0333
2020-01-07 10:40:36,056 Allocated:33.03076171875 MB
2020-01-07 10:40:36,056 Cached:1111.5 MB
2020-01-07 10:41:29,793 ==> Task[1]Epoch[8](100/415): Loss: 0.1181
2020-01-07 10:41:29,795 Allocated:33.03076171875 MB
2020-01-07 10:41:29,795 Cached:1111.5 MB
2020-01-07 10:42:14,014 ==> Task[1]Epoch[8](150/415): Loss: 0.1020
2020-01-07 10:42:14,016 Allocated:33.03076171875 MB
2020-01-07 10:42:14,016 Cached:1111.5 MB
2020-01-07 10:43:43,678 ==> Task[1]Epoch[8](250/415): Loss: 0.0536
2020-01-07 10:43:43,680 Allocated:33.03076171875 MB
2020-01-07 10:43:43,680 Cached:1111.5 MB
2020-01-07 10:44:49,255 ==> Task[1]Epoch[8](300/415): Loss: 0.0710
2020-01-07 10:44:49,257 Allocated:33.03076171875 MB
2020-01-07 10:44:49,257 Cached:1111.5 MB
2020-01-07 10:45:52,371 ==> Task[1]Epoch[8](350/415): Loss: 0.0917
2020-01-07 10:45:52,374 Allocated:33.03076171875 MB
2020-01-07 10:45:52,374 Cached:1111.5 MB
2020-01-07 10:46:45,721 ==> Task[1]Epoch[8](400/415): Loss: 0.0489
2020-01-07 10:46:45,722 Allocated:33.03076171875 MB
2020-01-07 10:46:45,722 Cached:1111.5 MB
2020-01-07 10:47:01,051 ===> Task 1 Epoch 8 Complete: Avg. Loss: 0.0720
2020-01-07 10:47:01,053 begin test:
2020-01-07 10:47:01,053 ====> Extracting Features
2020-01-07 10:48:09,076 ==> Batch (50/72)
2020-01-07 10:48:35,174 ====> Building faiss index
2020-01-07 10:48:35,176 ====> Calculating recall @ N
2020-01-07 10:48:35,615 ====> Recall@1: 0.6939
2020-01-07 10:48:35,615 ====> Recall@2: 0.7351
2020-01-07 10:48:35,616 ====> Recall@3: 0.7432
2020-01-07 10:48:35,616 ====> Recall@4: 0.7493
2020-01-07 10:48:35,616 ====> Recall@5: 0.7528
2020-01-07 10:48:35,616 ====> Recall@10: 0.7687
2020-01-07 10:48:35,616 ====> Recall@15: 0.7864
2020-01-07 10:48:35,617 ====> Recall@20: 0.7962
2020-01-07 10:48:35,617 ====> Recall@25: 0.8148
2020-01-07 10:48:35,675 ====> Building Cache
2020-01-07 10:48:35,676 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 10:50:53,430 Allocated:31.03076171875 MB
2020-01-07 10:50:53,431 Cached:9902.625 MB
2020-01-07 10:51:51,918 ==> Task[1]Epoch[9](50/415): Loss: 0.0288
2020-01-07 10:51:51,920 Allocated:33.03076171875 MB
2020-01-07 10:51:51,920 Cached:1111.5 MB
2020-01-07 10:52:42,445 ==> Task[1]Epoch[9](100/415): Loss: 0.1181
2020-01-07 10:52:42,447 Allocated:33.03076171875 MB
2020-01-07 10:52:42,448 Cached:1111.5 MB
2020-01-07 10:53:21,054 ==> Task[1]Epoch[9](150/415): Loss: 0.1282
2020-01-07 10:53:21,056 Allocated:33.03076171875 MB
2020-01-07 10:53:21,056 Cached:1111.5 MB
2020-01-07 10:54:44,006 ==> Task[1]Epoch[9](250/415): Loss: 0.0473
2020-01-07 10:54:44,008 Allocated:33.03076171875 MB
2020-01-07 10:54:44,008 Cached:1111.5 MB
2020-01-07 10:55:42,050 ==> Task[1]Epoch[9](300/415): Loss: 0.0621
2020-01-07 10:55:42,052 Allocated:33.03076171875 MB
2020-01-07 10:55:42,053 Cached:1111.5 MB
2020-01-07 10:56:43,318 ==> Task[1]Epoch[9](350/415): Loss: 0.0936
2020-01-07 10:56:43,319 Allocated:33.03076171875 MB
2020-01-07 10:56:43,320 Cached:1111.5 MB
2020-01-07 10:57:34,015 ==> Task[1]Epoch[9](400/415): Loss: 0.0520
2020-01-07 10:57:34,017 Allocated:33.03076171875 MB
2020-01-07 10:57:34,017 Cached:1111.5 MB
2020-01-07 10:57:47,942 ===> Task 1 Epoch 9 Complete: Avg. Loss: 0.0698
2020-01-07 10:57:47,943 begin test:
2020-01-07 10:57:47,944 ====> Extracting Features
2020-01-07 10:58:58,417 ==> Batch (50/72)
2020-01-07 10:59:24,225 ====> Building faiss index
2020-01-07 10:59:24,227 ====> Calculating recall @ N
2020-01-07 10:59:24,690 ====> Recall@1: 0.6832
2020-01-07 10:59:24,691 ====> Recall@2: 0.7307
2020-01-07 10:59:24,691 ====> Recall@3: 0.7426
2020-01-07 10:59:24,692 ====> Recall@4: 0.7481
2020-01-07 10:59:24,692 ====> Recall@5: 0.7525
2020-01-07 10:59:24,692 ====> Recall@10: 0.7684
2020-01-07 10:59:24,692 ====> Recall@15: 0.7806
2020-01-07 10:59:24,692 ====> Recall@20: 0.7910
2020-01-07 10:59:24,692 ====> Recall@25: 0.8055
2020-01-07 10:59:24,749 ====> Building Cache
2020-01-07 10:59:24,749 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 11:01:41,829 Allocated:31.03076171875 MB
2020-01-07 11:01:41,830 Cached:9902.625 MB
2020-01-07 11:02:37,262 ==> Task[1]Epoch[10](50/415): Loss: 0.0342
2020-01-07 11:02:37,263 Allocated:33.03076171875 MB
2020-01-07 11:02:37,263 Cached:1111.5 MB
2020-01-07 11:03:24,415 ==> Task[1]Epoch[10](100/415): Loss: 0.1226
2020-01-07 11:03:24,416 Allocated:33.03076171875 MB
2020-01-07 11:03:24,416 Cached:1111.5 MB
2020-01-07 11:03:59,731 ==> Task[1]Epoch[10](150/415): Loss: 0.1225
2020-01-07 11:03:59,733 Allocated:33.03076171875 MB
2020-01-07 11:03:59,733 Cached:1111.5 MB
2020-01-07 11:05:15,834 ==> Task[1]Epoch[10](250/415): Loss: 0.0463
2020-01-07 11:05:15,836 Allocated:33.03076171875 MB
2020-01-07 11:05:15,836 Cached:1111.5 MB
2020-01-07 11:06:11,153 ==> Task[1]Epoch[10](300/415): Loss: 0.0558
2020-01-07 11:06:11,155 Allocated:33.03076171875 MB
2020-01-07 11:06:11,155 Cached:1111.5 MB
2020-01-07 11:07:05,408 ==> Task[1]Epoch[10](350/415): Loss: 0.0883
2020-01-07 11:07:05,409 Allocated:33.03076171875 MB
2020-01-07 11:07:05,410 Cached:1111.5 MB
2020-01-07 11:07:51,011 ==> Task[1]Epoch[10](400/415): Loss: 0.0484
2020-01-07 11:07:51,012 Allocated:33.03076171875 MB
2020-01-07 11:07:51,013 Cached:1111.5 MB
2020-01-07 11:08:04,298 ===> Task 1 Epoch 10 Complete: Avg. Loss: 0.0673
2020-01-07 11:08:04,300 begin test:
2020-01-07 11:08:04,300 ====> Extracting Features
2020-01-07 11:09:13,405 ==> Batch (50/72)
2020-01-07 11:09:39,170 ====> Building faiss index
2020-01-07 11:09:39,172 ====> Calculating recall @ N
2020-01-07 11:09:39,618 ====> Recall@1: 0.6701
2020-01-07 11:09:39,618 ====> Recall@2: 0.7243
2020-01-07 11:09:39,619 ====> Recall@3: 0.7441
2020-01-07 11:09:39,619 ====> Recall@4: 0.7487
2020-01-07 11:09:39,619 ====> Recall@5: 0.7536
2020-01-07 11:09:39,619 ====> Recall@10: 0.7658
2020-01-07 11:09:39,619 ====> Recall@15: 0.7788
2020-01-07 11:09:39,620 ====> Recall@20: 0.7899
2020-01-07 11:09:39,620 ====> Recall@25: 0.8041
2020-01-07 11:09:39,676 ====> Building Cache
2020-01-07 11:09:39,676 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 11:11:55,792 Allocated:31.03076171875 MB
2020-01-07 11:11:55,793 Cached:9902.625 MB
2020-01-07 11:12:51,391 ==> Task[1]Epoch[11](50/415): Loss: 0.0249
2020-01-07 11:12:51,393 Allocated:33.03076171875 MB
2020-01-07 11:12:51,393 Cached:1111.5 MB
2020-01-07 11:13:36,220 ==> Task[1]Epoch[11](100/415): Loss: 0.1345
2020-01-07 11:13:36,222 Allocated:33.03076171875 MB
2020-01-07 11:13:36,222 Cached:1110.5 MB
2020-01-07 11:14:09,047 ==> Task[1]Epoch[11](150/415): Loss: 0.1136
2020-01-07 11:14:09,048 Allocated:33.03076171875 MB
2020-01-07 11:14:09,049 Cached:1111.5 MB
2020-01-07 11:15:21,696 ==> Task[1]Epoch[11](250/415): Loss: 0.0362
2020-01-07 11:15:21,697 Allocated:33.03076171875 MB
2020-01-07 11:15:21,698 Cached:1112.5 MB
2020-01-07 11:16:16,626 ==> Task[1]Epoch[11](300/415): Loss: 0.0623
2020-01-07 11:16:16,627 Allocated:33.03076171875 MB
2020-01-07 11:16:16,628 Cached:1111.5 MB
2020-01-07 11:17:07,866 ==> Task[1]Epoch[11](350/415): Loss: 0.0972
2020-01-07 11:17:07,868 Allocated:33.03076171875 MB
2020-01-07 11:17:07,868 Cached:1111.5 MB
2020-01-07 11:17:53,161 ==> Task[1]Epoch[11](400/415): Loss: 0.0443
2020-01-07 11:17:53,163 Allocated:33.03076171875 MB
2020-01-07 11:17:53,163 Cached:1111.5 MB
2020-01-07 11:18:05,821 ===> Task 1 Epoch 11 Complete: Avg. Loss: 0.0664
2020-01-07 11:18:05,822 begin test:
2020-01-07 11:18:05,823 ====> Extracting Features
2020-01-07 11:19:15,102 ==> Batch (50/72)
2020-01-07 11:19:41,121 ====> Building faiss index
2020-01-07 11:19:41,122 ====> Calculating recall @ N
2020-01-07 11:19:41,582 ====> Recall@1: 0.6806
2020-01-07 11:19:41,583 ====> Recall@2: 0.7301
2020-01-07 11:19:41,583 ====> Recall@3: 0.7429
2020-01-07 11:19:41,584 ====> Recall@4: 0.7484
2020-01-07 11:19:41,584 ====> Recall@5: 0.7525
2020-01-07 11:19:41,584 ====> Recall@10: 0.7661
2020-01-07 11:19:41,584 ====> Recall@15: 0.7762
2020-01-07 11:19:41,584 ====> Recall@20: 0.7878
2020-01-07 11:19:41,585 ====> Recall@25: 0.7991
2020-01-07 11:19:41,647 ====> Building Cache
2020-01-07 11:19:41,648 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 11:21:58,690 Allocated:31.03076171875 MB
2020-01-07 11:21:58,691 Cached:9902.625 MB
2020-01-07 11:22:53,823 ==> Task[1]Epoch[12](50/415): Loss: 0.0247
2020-01-07 11:22:53,825 Allocated:33.03076171875 MB
2020-01-07 11:22:53,826 Cached:1111.5 MB
2020-01-07 11:23:37,561 ==> Task[1]Epoch[12](100/415): Loss: 0.1192
2020-01-07 11:23:37,562 Allocated:33.03076171875 MB
2020-01-07 11:23:37,563 Cached:1111.5 MB
2020-01-07 11:24:11,278 ==> Task[1]Epoch[12](150/415): Loss: 0.1015
2020-01-07 11:24:11,280 Allocated:33.03076171875 MB
2020-01-07 11:24:11,280 Cached:1111.5 MB
2020-01-07 11:25:22,462 ==> Task[1]Epoch[12](250/415): Loss: 0.0377
2020-01-07 11:25:22,464 Allocated:33.03076171875 MB
2020-01-07 11:25:22,464 Cached:1112.5 MB
2020-01-07 11:26:17,455 ==> Task[1]Epoch[12](300/415): Loss: 0.0652
2020-01-07 11:26:17,457 Allocated:33.03076171875 MB
2020-01-07 11:26:17,457 Cached:1111.5 MB
2020-01-07 11:27:06,503 ==> Task[1]Epoch[12](350/415): Loss: 0.0875
2020-01-07 11:27:06,504 Allocated:33.03076171875 MB
2020-01-07 11:27:06,505 Cached:1111.5 MB
2020-01-07 11:27:49,367 ==> Task[1]Epoch[12](400/415): Loss: 0.0486
2020-01-07 11:27:49,370 Allocated:33.03076171875 MB
2020-01-07 11:27:49,370 Cached:1112.5 MB
2020-01-07 11:28:02,158 ===> Task 1 Epoch 12 Complete: Avg. Loss: 0.0653
2020-01-07 11:28:02,160 begin test:
2020-01-07 11:28:02,160 ====> Extracting Features
2020-01-07 11:29:13,029 ==> Batch (50/72)
2020-01-07 11:29:39,133 ====> Building faiss index
2020-01-07 11:29:39,136 ====> Calculating recall @ N
2020-01-07 11:29:39,689 ====> Recall@1: 0.6788
2020-01-07 11:29:39,690 ====> Recall@2: 0.7310
2020-01-07 11:29:39,690 ====> Recall@3: 0.7438
2020-01-07 11:29:39,691 ====> Recall@4: 0.7475
2020-01-07 11:29:39,691 ====> Recall@5: 0.7525
2020-01-07 11:29:39,692 ====> Recall@10: 0.7661
2020-01-07 11:29:39,692 ====> Recall@15: 0.7733
2020-01-07 11:29:39,692 ====> Recall@20: 0.7872
2020-01-07 11:29:39,693 ====> Recall@25: 0.8000
2020-01-07 11:29:39,758 ====> Building Cache
2020-01-07 11:29:39,759 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 11:32:01,121 Allocated:31.03076171875 MB
2020-01-07 11:32:01,122 Cached:9902.625 MB
2020-01-07 11:32:56,053 ==> Task[1]Epoch[13](50/415): Loss: 0.0290
2020-01-07 11:32:56,055 Allocated:33.03076171875 MB
2020-01-07 11:32:56,055 Cached:1111.5 MB
2020-01-07 11:33:37,793 ==> Task[1]Epoch[13](100/415): Loss: 0.1239
2020-01-07 11:33:37,795 Allocated:33.03076171875 MB
2020-01-07 11:33:37,795 Cached:1112.5 MB
2020-01-07 11:34:08,136 ==> Task[1]Epoch[13](150/415): Loss: 0.1130
2020-01-07 11:34:08,137 Allocated:33.03076171875 MB
2020-01-07 11:34:08,137 Cached:1111.5 MB
2020-01-07 11:35:20,229 ==> Task[1]Epoch[13](250/415): Loss: 0.0287
2020-01-07 11:35:20,231 Allocated:33.03076171875 MB
2020-01-07 11:35:20,231 Cached:1111.5 MB
2020-01-07 11:36:15,394 ==> Task[1]Epoch[13](300/415): Loss: 0.0580
2020-01-07 11:36:15,395 Allocated:33.03076171875 MB
2020-01-07 11:36:15,396 Cached:1111.5 MB
2020-01-07 11:37:02,839 ==> Task[1]Epoch[13](350/415): Loss: 0.0898
2020-01-07 11:37:02,841 Allocated:33.03076171875 MB
2020-01-07 11:37:02,841 Cached:1111.5 MB
2020-01-07 11:37:45,540 ==> Task[1]Epoch[13](400/415): Loss: 0.0448
2020-01-07 11:37:45,541 Allocated:33.03076171875 MB
2020-01-07 11:37:45,541 Cached:1111.5 MB
2020-01-07 11:37:58,412 ===> Task 1 Epoch 13 Complete: Avg. Loss: 0.0639
2020-01-07 11:37:58,413 begin test:
2020-01-07 11:37:58,414 ====> Extracting Features
2020-01-07 11:39:08,690 ==> Batch (50/72)
2020-01-07 11:39:37,008 ====> Building faiss index
2020-01-07 11:39:37,010 ====> Calculating recall @ N
2020-01-07 11:39:37,537 ====> Recall@1: 0.6780
2020-01-07 11:39:37,537 ====> Recall@2: 0.7296
2020-01-07 11:39:37,538 ====> Recall@3: 0.7423
2020-01-07 11:39:37,538 ====> Recall@4: 0.7481
2020-01-07 11:39:37,538 ====> Recall@5: 0.7519
2020-01-07 11:39:37,538 ====> Recall@10: 0.7641
2020-01-07 11:39:37,538 ====> Recall@15: 0.7759
2020-01-07 11:39:37,538 ====> Recall@20: 0.7870
2020-01-07 11:39:37,539 ====> Recall@25: 0.8023
2020-01-07 11:39:37,601 ====> Building Cache
2020-01-07 11:39:37,601 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 11:41:54,041 Allocated:31.03076171875 MB
2020-01-07 11:41:54,041 Cached:9902.625 MB
2020-01-07 11:42:44,559 ==> Task[1]Epoch[14](50/415): Loss: 0.0406
2020-01-07 11:42:44,561 Allocated:33.03076171875 MB
2020-01-07 11:42:44,561 Cached:1111.5 MB
2020-01-07 11:43:23,850 ==> Task[1]Epoch[14](100/415): Loss: 0.1232
2020-01-07 11:43:23,852 Allocated:33.03076171875 MB
2020-01-07 11:43:23,852 Cached:1111.5 MB
2020-01-07 11:43:53,459 ==> Task[1]Epoch[14](150/415): Loss: 0.0978
2020-01-07 11:43:53,460 Allocated:33.03076171875 MB
2020-01-07 11:43:53,460 Cached:1111.5 MB
2020-01-07 11:44:57,307 ==> Task[1]Epoch[14](250/415): Loss: 0.0362
2020-01-07 11:44:57,309 Allocated:33.03076171875 MB
2020-01-07 11:44:57,309 Cached:1111.5 MB
2020-01-07 11:45:49,187 ==> Task[1]Epoch[14](300/415): Loss: 0.0589
2020-01-07 11:45:49,189 Allocated:33.03076171875 MB
2020-01-07 11:45:49,189 Cached:1111.5 MB
2020-01-07 11:46:35,017 ==> Task[1]Epoch[14](350/415): Loss: 0.0873
2020-01-07 11:46:35,023 Allocated:33.03076171875 MB
2020-01-07 11:46:35,024 Cached:1111.5 MB
2020-01-07 11:47:15,761 ==> Task[1]Epoch[14](400/415): Loss: 0.0370
2020-01-07 11:47:15,762 Allocated:33.03076171875 MB
2020-01-07 11:47:15,763 Cached:1112.5 MB
2020-01-07 11:47:27,290 ===> Task 1 Epoch 14 Complete: Avg. Loss: 0.0620
2020-01-07 11:47:27,292 begin test:
2020-01-07 11:47:27,293 ====> Extracting Features
2020-01-07 11:48:35,770 ==> Batch (50/72)
2020-01-07 11:49:00,863 ====> Building faiss index
2020-01-07 11:49:00,865 ====> Calculating recall @ N
2020-01-07 11:49:01,307 ====> Recall@1: 0.6916
2020-01-07 11:49:01,308 ====> Recall@2: 0.7342
2020-01-07 11:49:01,308 ====> Recall@3: 0.7432
2020-01-07 11:49:01,308 ====> Recall@4: 0.7472
2020-01-07 11:49:01,309 ====> Recall@5: 0.7519
2020-01-07 11:49:01,309 ====> Recall@10: 0.7652
2020-01-07 11:49:01,309 ====> Recall@15: 0.7722
2020-01-07 11:49:01,309 ====> Recall@20: 0.7878
2020-01-07 11:49:01,309 ====> Recall@25: 0.7959
2020-01-07 11:49:01,367 Performance did not improve for 10 epochs. Stopping.
2020-01-07 11:49:01,367 => Best Recall@5: 0.7916
