2020-01-08 09:26:05,645 Namespace(arch='vgg16', batchSize=4, cacheBatchSize=24, cachePath='/home/annora/NetVLAD/output/', cacheRefreshRate=1000, ckpt='best', contilearn=False, dataPath='/home/annora/NetVLAD/output/data/', dataset='robotcar', evalEvery=1, fromscratch=False, lr=0.0001, lrGamma=0.5, lrStep=5, margin=0.1, mode='train', momentum=0.9, nEpochs=30, nGPU=1, nocuda=False, num_clusters=64, optim='SGD', patience=10, pooling='netvlad', premodel='imagenet', resume='', runsPath='/home/annora/NetVLAD/output/runs/', savePath='checkpoints', seed=123, split='val', start_epoch=0, threads=8, vladv2=True, weightDecay=0.001)
2020-01-08 09:26:05,763 ===> Loading dataset(s)
2020-01-08 09:26:08,734 ====> Training query set: 6636
2020-01-08 09:26:08,896 ===> Evaluating on val set, query count: 3450
2020-01-08 09:26:08,896 ===> Building model
2020-01-08 09:26:09,191 encoder moder:
VGG16(
  (conv1): Sequential(
    (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv2): Sequential(
    (0): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv3): Sequential(
    (0): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv4): Sequential(
    (0): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv5): Sequential(
    (0): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv6): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv7): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv8): Sequential(
    (0): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv9): Sequential(
    (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv10): Sequential(
    (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv11): Sequential(
    (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv12): Sequential(
    (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv13): Sequential(
    (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  )
  (conv13_relu_maxpool): Sequential(
    (0): ReLU(inplace)
    (1): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
)
2020-01-08 09:26:17,002 ===> Training model
2020-01-08 09:26:17,005 ===> Saving state to: /home/annora/NetVLAD/output/runs/Jan08_09-26-17_vgg16_netvlad
2020-01-08 09:26:17,005 ====> Building Cache
2020-01-08 09:26:17,005 feature cache.... /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-08 09:27:44,196 Allocated:110.27001953125 MB
2020-01-08 09:27:44,196 Cached:1904.0 MB
2020-01-08 09:29:00,204 ==> Epoch[1](50/1659): Loss: 0.3161
2020-01-08 09:29:00,207 Allocated:278.923828125 MB
2020-01-08 09:29:00,207 Cached:10142.125 MB
2020-01-08 09:29:43,475 ==> Epoch[1](100/1659): Loss: 0.3161
2020-01-08 09:29:43,478 Allocated:278.923828125 MB
2020-01-08 09:29:43,478 Cached:10142.125 MB
2020-01-08 09:30:27,532 ==> Epoch[1](150/1659): Loss: 0.3161
2020-01-08 09:30:27,535 Allocated:278.923828125 MB
2020-01-08 09:30:27,536 Cached:10142.125 MB
2020-01-08 09:31:12,346 ==> Epoch[1](200/1659): Loss: 0.3161
2020-01-08 09:31:12,347 Allocated:278.923828125 MB
2020-01-08 09:31:12,348 Cached:10142.125 MB
2020-01-08 09:31:47,580 ====> Building Cache
2020-01-08 09:31:47,581 feature cache.... /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-08 09:33:14,895 Allocated:278.54833984375 MB
2020-01-08 09:33:14,896 Cached:1685.0 MB
2020-01-08 09:33:57,893 ==> Epoch[1](250/1659): Loss: 0.3160
2020-01-08 09:33:57,895 Allocated:279.423828125 MB
2020-01-08 09:33:57,895 Cached:9730.875 MB
2020-01-08 09:34:41,832 ==> Epoch[1](300/1659): Loss: 0.3160
2020-01-08 09:34:41,834 Allocated:279.423828125 MB
2020-01-08 09:34:41,835 Cached:9730.875 MB
2020-01-08 09:35:25,393 ==> Epoch[1](350/1659): Loss: 0.3161
2020-01-08 09:35:25,395 Allocated:279.423828125 MB
2020-01-08 09:35:25,395 Cached:9730.875 MB
2020-01-08 09:36:08,196 ==> Epoch[1](400/1659): Loss: 0.3161
2020-01-08 09:36:08,198 Allocated:279.423828125 MB
2020-01-08 09:36:08,199 Cached:9730.875 MB
2020-01-08 09:36:54,039 ==> Epoch[1](450/1659): Loss: 0.3160
2020-01-08 09:36:54,042 Allocated:279.423828125 MB
2020-01-08 09:36:54,042 Cached:9730.875 MB
2020-01-08 09:37:15,276 ====> Building Cache
2020-01-08 09:37:15,278 feature cache.... /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-08 09:38:41,803 Allocated:279.42333984375 MB
2020-01-08 09:38:41,804 Cached:1911.0 MB
2020-01-08 09:39:36,653 ==> Epoch[1](500/1659): Loss: 0.3160
2020-01-08 09:39:36,655 Allocated:279.423828125 MB
2020-01-08 09:39:36,656 Cached:9729.875 MB
2020-01-08 09:40:20,635 ==> Epoch[1](550/1659): Loss: 0.3160
2020-01-08 09:40:20,638 Allocated:279.423828125 MB
2020-01-08 09:40:20,638 Cached:9729.875 MB
2020-01-08 09:41:04,892 ==> Epoch[1](600/1659): Loss: 0.3159
2020-01-08 09:41:04,895 Allocated:279.423828125 MB
2020-01-08 09:41:04,895 Cached:9729.875 MB
2020-01-08 09:41:51,774 ==> Epoch[1](650/1659): Loss: 0.3159
2020-01-08 09:41:51,776 Allocated:279.423828125 MB
2020-01-08 09:41:51,776 Cached:9729.875 MB
2020-01-08 09:42:33,513 ==> Epoch[1](700/1659): Loss: 0.3160
2020-01-08 09:42:33,514 Allocated:279.423828125 MB
2020-01-08 09:42:33,515 Cached:9729.875 MB
2020-01-08 09:42:43,387 ====> Building Cache
2020-01-08 09:42:43,388 feature cache.... /home/annora/NetVLAD/output/train_feat_cache.hdf5
2020-01-08 09:44:08,912 Allocated:280.42333984375 MB
2020-01-08 09:44:08,913 Cached:1739.25 MB
2020-01-08 09:45:17,545 ==> Epoch[1](750/1659): Loss: 0.3161
2020-01-08 09:45:17,548 Allocated:279.548828125 MB
2020-01-08 09:45:17,548 Cached:9729.25 MB
