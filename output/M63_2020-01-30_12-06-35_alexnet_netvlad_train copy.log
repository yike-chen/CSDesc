2020-01-30 12:06:35,788 Namespace(arch='alexnet', batchSize=12, cacheBatchSize=96, cachePath='/home/annora/NetVLAD/output/', cacheRefreshRate=3000, ckpt='best', contilearn=False, dataPath='/home/annora/NetVLAD/output/data/', dataset='robotcar', evalEvery=1, fromscratch=False, fromtask='', lr=0.001, lrGamma=0.5, lrStep=5, margin=0.1, mode='train', momentum=0.9, nEpochs=30, nGPU=1, nocuda=False, num_clusters=64, optim='SGD', patience=10, pooling='netvlad', premodel='imagenet', resume='', runsPath='/home/annora/NetVLAD/output/runs/', savePath='checkpoints', seed=123, split='val', start_epoch=0, threads=8, vladv2=False, weightDecay=0.001)
2020-01-30 12:06:35,849 ===> Loading dataset(s)
2020-01-30 12:06:35,850 trainfile ------>>>>>> oxRobocar_doubleN_train.mat
2020-01-30 12:06:38,468 ====> Training set: oxRobocar_doubleN_train.mat, query set count: 6404
2020-01-30 12:06:38,566 ===> Evaluating on val set: oxRobocar_doubleN_val.mat, query count: 3450
2020-01-30 12:06:38,566 ===> Building model
2020-01-30 12:06:38,619 encoder moder:
AlexNet(
  (conv1): Sequential(
    (0): Conv2d(3, 64, kernel_size=(11, 11), stride=(4, 4), padding=(2, 2))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(64, 192, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv3): Sequential(
    (0): Conv2d(192, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv4): Sequential(
    (0): Conv2d(384, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv5): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  )
)
2020-01-30 12:06:42,796 ===> Training model
2020-01-30 12:06:42,799 ===> Saving state to: /home/annora/NetVLAD/output/runs/2020-01-30-12-06-42_alexnet_netvlad
2020-01-30 12:06:42,799 ====> Building Cache
2020-01-30 12:06:42,799 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 12:08:12,008 Allocated:11.71826171875 MB
2020-01-30 12:08:12,009 Cached:2776.125 MB
2020-01-30 12:10:20,305 ==> Epoch[1](50/534): Loss: 0.1168
2020-01-30 12:10:20,308 Allocated:33.15576171875 MB
2020-01-30 12:10:20,308 Cached:6669.125 MB
2020-01-30 12:11:53,640 ==> Epoch[1](100/534): Loss: 0.0713
2020-01-30 12:11:53,641 Allocated:33.15576171875 MB
2020-01-30 12:11:53,642 Cached:6669.125 MB
2020-01-30 12:13:25,010 ==> Epoch[1](150/534): Loss: 0.0758
2020-01-30 12:13:25,013 Allocated:33.15576171875 MB
2020-01-30 12:13:25,013 Cached:6669.125 MB
2020-01-30 12:14:19,022 ====> Building Cache
2020-01-30 12:14:19,027 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 12:15:59,506 Allocated:33.1552734375 MB
2020-01-30 12:15:59,507 Cached:3384.375 MB
2020-01-30 12:17:27,152 ==> Epoch[1](200/534): Loss: 0.1645
2020-01-30 12:17:27,155 Allocated:33.15576171875 MB
2020-01-30 12:17:27,155 Cached:7274.375 MB
2020-01-30 12:18:58,401 ==> Epoch[1](250/534): Loss: 0.0657
2020-01-30 12:18:58,404 Allocated:33.15576171875 MB
2020-01-30 12:18:58,404 Cached:7274.375 MB
2020-01-30 12:20:49,138 ==> Epoch[1](300/534): Loss: 0.0920
2020-01-30 12:20:49,140 Allocated:33.15576171875 MB
2020-01-30 12:20:49,140 Cached:7274.375 MB
2020-01-30 12:22:13,107 ==> Epoch[1](350/534): Loss: 0.0585
2020-01-30 12:22:13,109 Allocated:33.15576171875 MB
2020-01-30 12:22:13,110 Cached:7274.375 MB
2020-01-30 12:22:25,077 ====> Building Cache
2020-01-30 12:22:25,077 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 12:23:55,505 Allocated:33.1552734375 MB
2020-01-30 12:23:55,506 Cached:3384.375 MB
2020-01-30 12:26:04,487 ==> Epoch[1](400/534): Loss: 0.0995
2020-01-30 12:26:04,490 Allocated:33.15576171875 MB
2020-01-30 12:26:04,490 Cached:4870.625 MB
2020-01-30 12:27:45,295 ==> Epoch[1](450/534): Loss: 0.1225
2020-01-30 12:27:45,298 Allocated:33.15576171875 MB
2020-01-30 12:27:45,298 Cached:4870.625 MB
2020-01-30 12:29:27,709 ==> Epoch[1](500/534): Loss: 0.0511
2020-01-30 12:29:27,713 Allocated:33.15576171875 MB
2020-01-30 12:29:27,714 Cached:4870.625 MB
2020-01-30 12:30:31,164 ===> Epoch 1 Complete: Avg. Loss: 0.1102
2020-01-30 12:30:31,166 ====> Extracting Features
2020-01-30 12:31:14,072 ==> Batch (50/108)
2020-01-30 12:31:40,990 ==> Batch (100/108)
2020-01-30 12:31:45,847 ====> Building faiss index
2020-01-30 12:31:46,192 ====> Calculating recall @ N
2020-01-30 12:31:48,491 ====> Recall@1: 0.4336
2020-01-30 12:31:48,492 ====> Recall@2: 0.4841
2020-01-30 12:31:48,492 ====> Recall@3: 0.5104
2020-01-30 12:31:48,492 ====> Recall@4: 0.5232
2020-01-30 12:31:48,493 ====> Recall@5: 0.5357
2020-01-30 12:31:48,493 ====> Recall@10: 0.5699
2020-01-30 12:31:48,493 ====> Recall@15: 0.5904
2020-01-30 12:31:48,493 ====> Recall@20: 0.6055
2020-01-30 12:31:48,493 ====> Recall@25: 0.6154
2020-01-30 12:31:48,590 ====> Building Cache
2020-01-30 12:31:48,590 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 12:33:16,674 Allocated:31.15576171875 MB
2020-01-30 12:33:16,674 Cached:4239.125 MB
2020-01-30 12:35:20,662 ==> Epoch[2](50/534): Loss: 0.0672
2020-01-30 12:35:20,664 Allocated:33.15576171875 MB
2020-01-30 12:35:20,664 Cached:7997.875 MB
2020-01-30 12:36:47,455 ==> Epoch[2](100/534): Loss: 0.0461
2020-01-30 12:36:47,457 Allocated:33.15576171875 MB
2020-01-30 12:36:47,457 Cached:4696.75 MB
2020-01-30 12:38:09,457 ==> Epoch[2](150/534): Loss: 0.0538
2020-01-30 12:38:09,459 Allocated:33.15576171875 MB
2020-01-30 12:38:09,459 Cached:6006.125 MB
2020-01-30 12:39:05,356 ====> Building Cache
2020-01-30 12:39:05,357 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 12:40:37,886 Allocated:33.1552734375 MB
2020-01-30 12:40:37,887 Cached:3384.375 MB
2020-01-30 12:41:50,217 ==> Epoch[2](200/534): Loss: 0.1344
2020-01-30 12:41:50,219 Allocated:33.15576171875 MB
2020-01-30 12:41:50,220 Cached:4867.625 MB
2020-01-30 12:43:19,716 ==> Epoch[2](250/534): Loss: 0.0618
2020-01-30 12:43:19,719 Allocated:33.15576171875 MB
2020-01-30 12:43:19,719 Cached:4870.625 MB
2020-01-30 12:44:44,670 ==> Epoch[2](300/534): Loss: 0.0327
2020-01-30 12:44:44,673 Allocated:33.15576171875 MB
2020-01-30 12:44:44,673 Cached:4870.625 MB
2020-01-30 12:46:05,885 ==> Epoch[2](350/534): Loss: 0.1291
2020-01-30 12:46:05,887 Allocated:33.15576171875 MB
2020-01-30 12:46:05,887 Cached:4870.625 MB
2020-01-30 12:46:16,077 ====> Building Cache
2020-01-30 12:46:16,078 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 12:47:52,810 Allocated:33.1552734375 MB
2020-01-30 12:47:52,810 Cached:3384.375 MB
2020-01-30 12:49:56,338 ==> Epoch[2](400/534): Loss: 0.0774
2020-01-30 12:49:56,342 Allocated:33.15576171875 MB
2020-01-30 12:49:56,342 Cached:7004.125 MB
2020-01-30 12:51:21,202 ==> Epoch[2](450/534): Loss: 0.0398
2020-01-30 12:51:21,205 Allocated:33.15576171875 MB
2020-01-30 12:51:21,206 Cached:7004.125 MB
2020-01-30 12:52:46,960 ==> Epoch[2](500/534): Loss: 0.0233
2020-01-30 12:52:46,963 Allocated:33.15576171875 MB
2020-01-30 12:52:46,963 Cached:7004.125 MB
2020-01-30 12:53:41,061 ===> Epoch 2 Complete: Avg. Loss: 0.0747
2020-01-30 12:53:41,063 ====> Extracting Features
2020-01-30 12:54:18,556 ==> Batch (50/108)
2020-01-30 12:54:42,474 ==> Batch (100/108)
2020-01-30 12:54:47,027 ====> Building faiss index
2020-01-30 12:54:47,396 ====> Calculating recall @ N
2020-01-30 12:54:49,723 ====> Recall@1: 0.4510
2020-01-30 12:54:49,724 ====> Recall@2: 0.4916
2020-01-30 12:54:49,724 ====> Recall@3: 0.5122
2020-01-30 12:54:49,725 ====> Recall@4: 0.5229
2020-01-30 12:54:49,725 ====> Recall@5: 0.5339
2020-01-30 12:54:49,725 ====> Recall@10: 0.5652
2020-01-30 12:54:49,725 ====> Recall@15: 0.5832
2020-01-30 12:54:49,725 ====> Recall@20: 0.5980
2020-01-30 12:54:49,726 ====> Recall@25: 0.6110
2020-01-30 12:54:49,855 ====> Building Cache
2020-01-30 12:54:49,855 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 12:56:18,653 Allocated:31.15576171875 MB
2020-01-30 12:56:18,654 Cached:4239.125 MB
2020-01-30 12:58:32,788 ==> Epoch[3](50/534): Loss: 0.0176
2020-01-30 12:58:32,792 Allocated:33.15576171875 MB
2020-01-30 12:58:32,793 Cached:7814.125 MB
2020-01-30 12:59:54,458 ==> Epoch[3](100/534): Loss: 0.0270
2020-01-30 12:59:54,462 Allocated:33.15576171875 MB
2020-01-30 12:59:54,463 Cached:7814.125 MB
2020-01-30 13:01:11,352 ==> Epoch[3](150/534): Loss: 0.0199
2020-01-30 13:01:11,355 Allocated:33.15576171875 MB
2020-01-30 13:01:11,355 Cached:7814.125 MB
2020-01-30 13:01:58,480 ====> Building Cache
2020-01-30 13:01:58,481 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 13:03:27,641 Allocated:33.1552734375 MB
2020-01-30 13:03:27,641 Cached:3384.375 MB
2020-01-30 13:04:32,497 ==> Epoch[3](200/534): Loss: 0.0632
2020-01-30 13:04:32,500 Allocated:33.15576171875 MB
2020-01-30 13:04:32,500 Cached:4556.875 MB
2020-01-30 13:05:46,634 ==> Epoch[3](250/534): Loss: 0.1745
2020-01-30 13:05:46,637 Allocated:33.15576171875 MB
2020-01-30 13:05:46,637 Cached:5723.75 MB
2020-01-30 13:07:22,421 ==> Epoch[3](300/534): Loss: 0.0812
2020-01-30 13:07:22,423 Allocated:33.15576171875 MB
2020-01-30 13:07:22,423 Cached:6934.0 MB
2020-01-30 13:08:40,902 ==> Epoch[3](350/534): Loss: 0.1718
2020-01-30 13:08:40,904 Allocated:33.15576171875 MB
2020-01-30 13:08:40,904 Cached:6934.0 MB
2020-01-30 13:08:49,974 ====> Building Cache
2020-01-30 13:08:49,975 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 13:10:19,131 Allocated:33.1552734375 MB
2020-01-30 13:10:19,132 Cached:3384.375 MB
2020-01-30 13:12:11,150 ==> Epoch[3](400/534): Loss: 0.0411
2020-01-30 13:12:11,152 Allocated:33.15576171875 MB
2020-01-30 13:12:11,152 Cached:4580.125 MB
2020-01-30 13:13:28,618 ==> Epoch[3](450/534): Loss: 0.0671
2020-01-30 13:13:28,621 Allocated:33.15576171875 MB
2020-01-30 13:13:28,622 Cached:4580.125 MB
2020-01-30 13:14:39,386 ==> Epoch[3](500/534): Loss: 0.0075
2020-01-30 13:14:39,390 Allocated:33.15576171875 MB
2020-01-30 13:14:39,390 Cached:4580.125 MB
2020-01-30 13:15:33,507 ===> Epoch 3 Complete: Avg. Loss: 0.0631
2020-01-30 13:15:33,509 ====> Extracting Features
2020-01-30 13:16:12,882 ==> Batch (50/108)
2020-01-30 13:16:41,200 ==> Batch (100/108)
2020-01-30 13:16:47,443 ====> Building faiss index
2020-01-30 13:16:47,842 ====> Calculating recall @ N
2020-01-30 13:16:50,232 ====> Recall@1: 0.4661
2020-01-30 13:16:50,234 ====> Recall@2: 0.5061
2020-01-30 13:16:50,235 ====> Recall@3: 0.5342
2020-01-30 13:16:50,235 ====> Recall@4: 0.5542
2020-01-30 13:16:50,235 ====> Recall@5: 0.5710
2020-01-30 13:16:50,235 ====> Recall@10: 0.5971
2020-01-30 13:16:50,236 ====> Recall@15: 0.6130
2020-01-30 13:16:50,236 ====> Recall@20: 0.6235
2020-01-30 13:16:50,236 ====> Recall@25: 0.6359
2020-01-30 13:16:50,436 ====> Building Cache
2020-01-30 13:16:50,437 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 13:18:21,956 Allocated:31.15576171875 MB
2020-01-30 13:18:21,956 Cached:4239.125 MB
2020-01-30 13:20:26,024 ==> Epoch[4](50/534): Loss: 0.0246
2020-01-30 13:20:26,027 Allocated:33.15576171875 MB
2020-01-30 13:20:26,027 Cached:5385.125 MB
2020-01-30 13:21:37,951 ==> Epoch[4](100/534): Loss: 0.0043
2020-01-30 13:21:37,955 Allocated:33.15576171875 MB
2020-01-30 13:21:37,956 Cached:5385.125 MB
2020-01-30 13:22:50,334 ==> Epoch[4](150/534): Loss: 0.0088
2020-01-30 13:22:50,337 Allocated:33.15576171875 MB
2020-01-30 13:22:50,337 Cached:5385.125 MB
2020-01-30 13:23:30,200 ====> Building Cache
2020-01-30 13:23:30,201 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 13:25:09,102 Allocated:33.1552734375 MB
2020-01-30 13:25:09,102 Cached:3384.375 MB
2020-01-30 13:26:44,130 ==> Epoch[4](200/534): Loss: 0.1547
2020-01-30 13:26:44,133 Allocated:33.15576171875 MB
2020-01-30 13:26:44,133 Cached:3393.375 MB
2020-01-30 13:27:57,888 ==> Epoch[4](250/534): Loss: 0.1494
2020-01-30 13:27:57,891 Allocated:33.15576171875 MB
2020-01-30 13:27:57,891 Cached:4544.125 MB
2020-01-30 13:29:17,450 ==> Epoch[4](300/534): Loss: 0.1055
2020-01-30 13:29:17,452 Allocated:33.15576171875 MB
2020-01-30 13:29:17,452 Cached:5698.25 MB
2020-01-30 13:30:29,567 ==> Epoch[4](350/534): Loss: 0.2640
2020-01-30 13:30:29,569 Allocated:33.15576171875 MB
2020-01-30 13:30:29,569 Cached:5698.25 MB
2020-01-30 13:30:38,411 ====> Building Cache
2020-01-30 13:30:38,412 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 13:32:07,551 Allocated:33.1552734375 MB
2020-01-30 13:32:07,552 Cached:3384.375 MB
2020-01-30 13:33:45,656 ==> Epoch[4](400/534): Loss: 0.0783
2020-01-30 13:33:45,659 Allocated:33.15576171875 MB
2020-01-30 13:33:45,659 Cached:3395.375 MB
2020-01-30 13:35:08,712 ==> Epoch[4](450/534): Loss: 0.0172
2020-01-30 13:35:08,714 Allocated:33.15576171875 MB
2020-01-30 13:35:08,714 Cached:5685.5 MB
2020-01-30 13:36:30,633 ==> Epoch[4](500/534): Loss: 0.0830
2020-01-30 13:36:30,637 Allocated:33.15576171875 MB
2020-01-30 13:36:30,638 Cached:5685.5 MB
2020-01-30 13:37:27,297 ===> Epoch 4 Complete: Avg. Loss: 0.0593
2020-01-30 13:37:27,299 ====> Extracting Features
2020-01-30 13:38:07,958 ==> Batch (50/108)
2020-01-30 13:38:35,698 ==> Batch (100/108)
2020-01-30 13:38:40,723 ====> Building faiss index
2020-01-30 13:38:41,087 ====> Calculating recall @ N
2020-01-30 13:38:43,476 ====> Recall@1: 0.4533
2020-01-30 13:38:43,477 ====> Recall@2: 0.4870
2020-01-30 13:38:43,477 ====> Recall@3: 0.5107
2020-01-30 13:38:43,477 ====> Recall@4: 0.5348
2020-01-30 13:38:43,477 ====> Recall@5: 0.5519
2020-01-30 13:38:43,478 ====> Recall@10: 0.5870
2020-01-30 13:38:43,478 ====> Recall@15: 0.6058
2020-01-30 13:38:43,478 ====> Recall@20: 0.6220
2020-01-30 13:38:43,478 ====> Recall@25: 0.6345
2020-01-30 13:38:43,620 ====> Building Cache
2020-01-30 13:38:43,620 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 13:40:13,271 Allocated:31.15576171875 MB
2020-01-30 13:40:13,272 Cached:4239.125 MB
2020-01-30 13:42:01,254 ==> Epoch[5](50/534): Loss: 0.0554
2020-01-30 13:42:01,257 Allocated:33.15576171875 MB
2020-01-30 13:42:01,257 Cached:5385.125 MB
2020-01-30 13:43:07,642 ==> Epoch[5](100/534): Loss: 0.0015
2020-01-30 13:43:07,643 Allocated:33.15576171875 MB
2020-01-30 13:43:07,644 Cached:5385.125 MB
2020-01-30 13:44:20,047 ==> Epoch[5](150/534): Loss: 0.0357
2020-01-30 13:44:20,050 Allocated:33.15576171875 MB
2020-01-30 13:44:20,050 Cached:5385.125 MB
2020-01-30 13:45:05,482 ====> Building Cache
2020-01-30 13:45:05,483 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 13:46:36,636 Allocated:33.1552734375 MB
2020-01-30 13:46:36,637 Cached:3384.375 MB
2020-01-30 13:47:46,258 ==> Epoch[5](200/534): Loss: 0.2735
2020-01-30 13:47:46,264 Allocated:33.15576171875 MB
2020-01-30 13:47:46,264 Cached:3392.375 MB
2020-01-30 13:48:56,631 ==> Epoch[5](250/534): Loss: 0.1908
2020-01-30 13:48:56,634 Allocated:33.15576171875 MB
2020-01-30 13:48:56,634 Cached:3393.375 MB
2020-01-30 13:50:13,538 ==> Epoch[5](300/534): Loss: 0.0373
2020-01-30 13:50:13,544 Allocated:33.15576171875 MB
2020-01-30 13:50:13,545 Cached:3393.375 MB
2020-01-30 13:51:24,681 ==> Epoch[5](350/534): Loss: 0.0307
2020-01-30 13:51:24,683 Allocated:33.15576171875 MB
2020-01-30 13:51:24,683 Cached:3394.375 MB
2020-01-30 13:51:29,067 ====> Building Cache
2020-01-30 13:51:29,068 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 13:52:58,636 Allocated:33.1552734375 MB
2020-01-30 13:52:58,637 Cached:3384.375 MB
2020-01-30 13:54:48,560 ==> Epoch[5](400/534): Loss: 0.0285
2020-01-30 13:54:48,564 Allocated:33.15576171875 MB
2020-01-30 13:54:48,564 Cached:4536.75 MB
2020-01-30 13:56:01,441 ==> Epoch[5](450/534): Loss: 0.0198
2020-01-30 13:56:01,445 Allocated:33.15576171875 MB
2020-01-30 13:56:01,445 Cached:4536.75 MB
2020-01-30 13:57:19,796 ==> Epoch[5](500/534): Loss: 0.0113
2020-01-30 13:57:19,802 Allocated:33.15576171875 MB
2020-01-30 13:57:19,802 Cached:5727.875 MB
2020-01-30 13:58:09,359 ===> Epoch 5 Complete: Avg. Loss: 0.0617
2020-01-30 13:58:09,361 ====> Extracting Features
2020-01-30 13:58:46,579 ==> Batch (50/108)
2020-01-30 13:59:12,006 ==> Batch (100/108)
2020-01-30 13:59:16,527 ====> Building faiss index
2020-01-30 13:59:16,877 ====> Calculating recall @ N
2020-01-30 13:59:19,201 ====> Recall@1: 0.4965
2020-01-30 13:59:19,201 ====> Recall@2: 0.5452
2020-01-30 13:59:19,202 ====> Recall@3: 0.5699
2020-01-30 13:59:19,202 ====> Recall@4: 0.5872
2020-01-30 13:59:19,202 ====> Recall@5: 0.6003
2020-01-30 13:59:19,202 ====> Recall@10: 0.6290
2020-01-30 13:59:19,203 ====> Recall@15: 0.6475
2020-01-30 13:59:19,203 ====> Recall@20: 0.6614
2020-01-30 13:59:19,203 ====> Recall@25: 0.6748
2020-01-30 13:59:19,398 ====> Building Cache
2020-01-30 13:59:19,398 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 14:00:49,722 Allocated:31.15576171875 MB
2020-01-30 14:00:49,722 Cached:4239.125 MB
2020-01-30 14:02:37,679 ==> Epoch[6](50/534): Loss: 0.0289
2020-01-30 14:02:37,681 Allocated:33.15576171875 MB
2020-01-30 14:02:37,682 Cached:4249.125 MB
2020-01-30 14:03:40,283 ==> Epoch[6](100/534): Loss: 0.0276
2020-01-30 14:03:40,286 Allocated:33.15576171875 MB
2020-01-30 14:03:40,286 Cached:4249.125 MB
2020-01-30 14:04:51,260 ==> Epoch[6](150/534): Loss: 0.0247
2020-01-30 14:04:51,262 Allocated:33.15576171875 MB
2020-01-30 14:04:51,263 Cached:4249.125 MB
2020-01-30 14:05:27,177 ====> Building Cache
2020-01-30 14:05:27,178 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 14:07:00,659 Allocated:33.1552734375 MB
2020-01-30 14:07:00,660 Cached:3384.375 MB
2020-01-30 14:08:11,185 ==> Epoch[6](200/534): Loss: 0.1733
2020-01-30 14:08:11,189 Allocated:33.15576171875 MB
2020-01-30 14:08:11,189 Cached:3393.375 MB
2020-01-30 14:09:25,345 ==> Epoch[6](250/534): Loss: 0.0762
2020-01-30 14:09:25,350 Allocated:33.15576171875 MB
2020-01-30 14:09:25,350 Cached:3453.375 MB
2020-01-30 14:10:52,560 ==> Epoch[6](300/534): Loss: 0.1081
2020-01-30 14:10:52,562 Allocated:33.15576171875 MB
2020-01-30 14:10:52,563 Cached:3453.375 MB
2020-01-30 14:12:10,265 ==> Epoch[6](350/534): Loss: 0.0527
2020-01-30 14:12:10,267 Allocated:33.15576171875 MB
2020-01-30 14:12:10,268 Cached:3453.375 MB
2020-01-30 14:12:14,051 ====> Building Cache
2020-01-30 14:12:14,052 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 14:13:44,797 Allocated:33.1552734375 MB
2020-01-30 14:13:44,797 Cached:3384.375 MB
2020-01-30 14:15:24,353 ==> Epoch[6](400/534): Loss: 0.1086
2020-01-30 14:15:24,356 Allocated:33.15576171875 MB
2020-01-30 14:15:24,356 Cached:3395.375 MB
2020-01-30 14:16:38,195 ==> Epoch[6](450/534): Loss: 0.0100
2020-01-30 14:16:38,197 Allocated:33.15576171875 MB
2020-01-30 14:16:38,197 Cached:3395.375 MB
2020-01-30 14:17:50,681 ==> Epoch[6](500/534): Loss: 0.0059
2020-01-30 14:17:50,683 Allocated:33.15576171875 MB
2020-01-30 14:17:50,684 Cached:3395.375 MB
2020-01-30 14:18:42,941 ===> Epoch 6 Complete: Avg. Loss: 0.0607
2020-01-30 14:18:42,944 ====> Extracting Features
2020-01-30 14:19:22,327 ==> Batch (50/108)
2020-01-30 14:19:47,164 ==> Batch (100/108)
2020-01-30 14:19:51,953 ====> Building faiss index
2020-01-30 14:19:52,315 ====> Calculating recall @ N
2020-01-30 14:19:54,566 ====> Recall@1: 0.4928
2020-01-30 14:19:54,567 ====> Recall@2: 0.5252
2020-01-30 14:19:54,567 ====> Recall@3: 0.5429
2020-01-30 14:19:54,568 ====> Recall@4: 0.5545
2020-01-30 14:19:54,568 ====> Recall@5: 0.5655
2020-01-30 14:19:54,568 ====> Recall@10: 0.5968
2020-01-30 14:19:54,568 ====> Recall@15: 0.6177
2020-01-30 14:19:54,568 ====> Recall@20: 0.6307
2020-01-30 14:19:54,569 ====> Recall@25: 0.6435
2020-01-30 14:19:54,707 ====> Building Cache
2020-01-30 14:19:54,707 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 14:21:25,600 Allocated:31.15576171875 MB
2020-01-30 14:21:25,600 Cached:4239.125 MB
2020-01-30 14:23:17,087 ==> Epoch[7](50/534): Loss: 0.0123
2020-01-30 14:23:17,091 Allocated:33.15576171875 MB
2020-01-30 14:23:17,091 Cached:4249.125 MB
2020-01-30 14:24:33,915 ==> Epoch[7](100/534): Loss: 0.0290
2020-01-30 14:24:33,918 Allocated:33.15576171875 MB
2020-01-30 14:24:33,919 Cached:4249.125 MB
2020-01-30 14:25:42,590 ==> Epoch[7](150/534): Loss: 0.0380
2020-01-30 14:25:42,593 Allocated:33.15576171875 MB
2020-01-30 14:25:42,593 Cached:4308.125 MB
2020-01-30 14:26:21,288 ====> Building Cache
2020-01-30 14:26:21,288 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 14:27:52,481 Allocated:33.1552734375 MB
2020-01-30 14:27:52,481 Cached:3384.375 MB
2020-01-30 14:29:04,759 ==> Epoch[7](200/534): Loss: 0.2222
2020-01-30 14:29:04,763 Allocated:33.15576171875 MB
2020-01-30 14:29:04,764 Cached:3393.375 MB
2020-01-30 14:30:16,863 ==> Epoch[7](250/534): Loss: 0.0063
2020-01-30 14:30:16,866 Allocated:33.15576171875 MB
2020-01-30 14:30:16,866 Cached:3394.375 MB
2020-01-30 14:31:32,972 ==> Epoch[7](300/534): Loss: 0.0985
2020-01-30 14:31:32,975 Allocated:33.15576171875 MB
2020-01-30 14:31:32,975 Cached:3394.375 MB
2020-01-30 14:32:48,097 ==> Epoch[7](350/534): Loss: 0.0406
2020-01-30 14:32:48,099 Allocated:33.15576171875 MB
2020-01-30 14:32:48,099 Cached:3394.375 MB
2020-01-30 14:32:56,159 ====> Building Cache
2020-01-30 14:32:56,160 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 14:34:27,661 Allocated:33.1552734375 MB
2020-01-30 14:34:27,662 Cached:3384.375 MB
2020-01-30 14:36:24,527 ==> Epoch[7](400/534): Loss: 0.0285
2020-01-30 14:36:24,531 Allocated:33.15576171875 MB
2020-01-30 14:36:24,531 Cached:3394.375 MB
2020-01-30 14:37:38,533 ==> Epoch[7](450/534): Loss: 0.0127
2020-01-30 14:37:38,535 Allocated:33.15576171875 MB
2020-01-30 14:37:38,536 Cached:4556.875 MB
2020-01-30 14:38:55,746 ==> Epoch[7](500/534): Loss: 0.0103
2020-01-30 14:38:55,749 Allocated:33.15576171875 MB
2020-01-30 14:38:55,749 Cached:4556.875 MB
2020-01-30 14:39:52,324 ===> Epoch 7 Complete: Avg. Loss: 0.0497
2020-01-30 14:39:52,326 ====> Extracting Features
2020-01-30 14:40:30,915 ==> Batch (50/108)
2020-01-30 14:40:55,522 ==> Batch (100/108)
2020-01-30 14:41:00,190 ====> Building faiss index
2020-01-30 14:41:00,541 ====> Calculating recall @ N
2020-01-30 14:41:02,733 ====> Recall@1: 0.4707
2020-01-30 14:41:02,733 ====> Recall@2: 0.5249
2020-01-30 14:41:02,734 ====> Recall@3: 0.5493
2020-01-30 14:41:02,734 ====> Recall@4: 0.5649
2020-01-30 14:41:02,734 ====> Recall@5: 0.5745
2020-01-30 14:41:02,734 ====> Recall@10: 0.6145
2020-01-30 14:41:02,734 ====> Recall@15: 0.6354
2020-01-30 14:41:02,735 ====> Recall@20: 0.6530
2020-01-30 14:41:02,735 ====> Recall@25: 0.6658
2020-01-30 14:41:02,857 ====> Building Cache
2020-01-30 14:41:02,858 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 14:42:33,694 Allocated:31.15576171875 MB
2020-01-30 14:42:33,694 Cached:4239.125 MB
2020-01-30 14:44:25,355 ==> Epoch[8](50/534): Loss: 0.0075
2020-01-30 14:44:25,359 Allocated:33.15576171875 MB
2020-01-30 14:44:25,359 Cached:4249.125 MB
2020-01-30 14:45:43,442 ==> Epoch[8](100/534): Loss: 0.0173
2020-01-30 14:45:43,445 Allocated:33.15576171875 MB
2020-01-30 14:45:43,445 Cached:4308.125 MB
2020-01-30 14:46:49,337 ==> Epoch[8](150/534): Loss: 0.0122
2020-01-30 14:46:49,340 Allocated:33.15576171875 MB
2020-01-30 14:46:49,340 Cached:4308.125 MB
2020-01-30 14:47:30,648 ====> Building Cache
2020-01-30 14:47:30,649 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 14:49:02,776 Allocated:33.1552734375 MB
2020-01-30 14:49:02,777 Cached:3384.375 MB
2020-01-30 14:50:11,479 ==> Epoch[8](200/534): Loss: 0.1254
2020-01-30 14:50:11,484 Allocated:33.15576171875 MB
2020-01-30 14:50:11,484 Cached:3453.375 MB
2020-01-30 14:51:24,763 ==> Epoch[8](250/534): Loss: 0.1973
2020-01-30 14:51:24,766 Allocated:33.15576171875 MB
2020-01-30 14:51:24,766 Cached:3453.375 MB
2020-01-30 14:52:33,177 ==> Epoch[8](300/534): Loss: 0.1071
2020-01-30 14:52:33,182 Allocated:33.15576171875 MB
2020-01-30 14:52:33,183 Cached:3453.375 MB
2020-01-30 14:53:47,043 ==> Epoch[8](350/534): Loss: 0.1184
2020-01-30 14:53:47,045 Allocated:33.15576171875 MB
2020-01-30 14:53:47,046 Cached:3453.375 MB
2020-01-30 14:53:48,436 ====> Building Cache
2020-01-30 14:53:48,437 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 14:55:31,664 Allocated:33.1552734375 MB
2020-01-30 14:55:31,664 Cached:3384.375 MB
2020-01-30 14:57:10,909 ==> Epoch[8](400/534): Loss: 0.0133
2020-01-30 14:57:10,912 Allocated:33.15576171875 MB
2020-01-30 14:57:10,912 Cached:3393.375 MB
2020-01-30 14:58:16,920 ==> Epoch[8](450/534): Loss: 0.0096
2020-01-30 14:58:16,922 Allocated:33.15576171875 MB
2020-01-30 14:58:16,922 Cached:3393.375 MB
2020-01-30 14:59:23,275 ==> Epoch[8](500/534): Loss: 0.0133
2020-01-30 14:59:23,277 Allocated:33.15576171875 MB
2020-01-30 14:59:23,278 Cached:3393.375 MB
2020-01-30 15:00:12,845 ===> Epoch 8 Complete: Avg. Loss: 0.0511
2020-01-30 15:00:12,847 ====> Extracting Features
2020-01-30 15:00:52,945 ==> Batch (50/108)
2020-01-30 15:01:18,937 ==> Batch (100/108)
2020-01-30 15:01:23,705 ====> Building faiss index
2020-01-30 15:01:24,068 ====> Calculating recall @ N
2020-01-30 15:01:26,354 ====> Recall@1: 0.4899
2020-01-30 15:01:26,355 ====> Recall@2: 0.5206
2020-01-30 15:01:26,356 ====> Recall@3: 0.5414
2020-01-30 15:01:26,356 ====> Recall@4: 0.5516
2020-01-30 15:01:26,356 ====> Recall@5: 0.5620
2020-01-30 15:01:26,356 ====> Recall@10: 0.6003
2020-01-30 15:01:26,356 ====> Recall@15: 0.6281
2020-01-30 15:01:26,356 ====> Recall@20: 0.6519
2020-01-30 15:01:26,357 ====> Recall@25: 0.6646
2020-01-30 15:01:26,488 ====> Building Cache
2020-01-30 15:01:26,488 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 15:02:58,021 Allocated:31.15576171875 MB
2020-01-30 15:02:58,021 Cached:4239.125 MB
2020-01-30 15:04:37,954 ==> Epoch[9](50/534): Loss: 0.0164
2020-01-30 15:04:37,957 Allocated:33.15576171875 MB
2020-01-30 15:04:37,958 Cached:4249.125 MB
2020-01-30 15:05:49,655 ==> Epoch[9](100/534): Loss: 0.0299
2020-01-30 15:05:49,659 Allocated:33.15576171875 MB
2020-01-30 15:05:49,659 Cached:4309.125 MB
2020-01-30 15:06:58,203 ==> Epoch[9](150/534): Loss: 0.0065
2020-01-30 15:06:58,205 Allocated:33.15576171875 MB
2020-01-30 15:06:58,205 Cached:4309.125 MB
2020-01-30 15:07:30,089 ====> Building Cache
2020-01-30 15:07:30,089 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 15:09:01,608 Allocated:33.1552734375 MB
2020-01-30 15:09:01,608 Cached:3384.375 MB
2020-01-30 15:10:09,994 ==> Epoch[9](200/534): Loss: 0.1642
2020-01-30 15:10:09,999 Allocated:33.15576171875 MB
2020-01-30 15:10:09,999 Cached:4609.875 MB
2020-01-30 15:11:16,607 ==> Epoch[9](250/534): Loss: 0.0938
2020-01-30 15:11:16,609 Allocated:33.15576171875 MB
2020-01-30 15:11:16,609 Cached:4664.875 MB
2020-01-30 15:12:35,005 ==> Epoch[9](300/534): Loss: 0.0330
2020-01-30 15:12:35,007 Allocated:33.15576171875 MB
2020-01-30 15:12:35,008 Cached:4664.875 MB
2020-01-30 15:13:41,956 ==> Epoch[9](350/534): Loss: 0.1786
2020-01-30 15:13:41,958 Allocated:33.15576171875 MB
2020-01-30 15:13:41,959 Cached:4664.875 MB
2020-01-30 15:13:51,446 ====> Building Cache
2020-01-30 15:13:51,447 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 15:15:28,993 Allocated:33.1552734375 MB
2020-01-30 15:15:28,994 Cached:3384.375 MB
2020-01-30 15:17:11,734 ==> Epoch[9](400/534): Loss: 0.0573
2020-01-30 15:17:11,737 Allocated:33.15576171875 MB
2020-01-30 15:17:11,738 Cached:3394.375 MB
2020-01-30 15:18:20,216 ==> Epoch[9](450/534): Loss: 0.0294
2020-01-30 15:18:20,219 Allocated:33.15576171875 MB
2020-01-30 15:18:20,219 Cached:3394.375 MB
2020-01-30 15:19:27,313 ==> Epoch[9](500/534): Loss: 0.0086
2020-01-30 15:19:27,315 Allocated:33.15576171875 MB
2020-01-30 15:19:27,315 Cached:3394.375 MB
2020-01-30 15:20:16,122 ===> Epoch 9 Complete: Avg. Loss: 0.0478
2020-01-30 15:20:16,125 ====> Extracting Features
2020-01-30 15:20:54,502 ==> Batch (50/108)
2020-01-30 15:21:21,699 ==> Batch (100/108)
2020-01-30 15:21:26,657 ====> Building faiss index
2020-01-30 15:21:27,029 ====> Calculating recall @ N
2020-01-30 15:21:29,331 ====> Recall@1: 0.4719
2020-01-30 15:21:29,331 ====> Recall@2: 0.5064
2020-01-30 15:21:29,332 ====> Recall@3: 0.5296
2020-01-30 15:21:29,332 ====> Recall@4: 0.5443
2020-01-30 15:21:29,332 ====> Recall@5: 0.5574
2020-01-30 15:21:29,333 ====> Recall@10: 0.5988
2020-01-30 15:21:29,333 ====> Recall@15: 0.6214
2020-01-30 15:21:29,333 ====> Recall@20: 0.6409
2020-01-30 15:21:29,333 ====> Recall@25: 0.6586
2020-01-30 15:21:29,470 ====> Building Cache
2020-01-30 15:21:29,470 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 15:23:00,312 Allocated:31.15576171875 MB
2020-01-30 15:23:00,313 Cached:4239.125 MB
2020-01-30 15:24:49,597 ==> Epoch[10](50/534): Loss: 0.0452
2020-01-30 15:24:49,599 Allocated:33.15576171875 MB
2020-01-30 15:24:49,599 Cached:4309.125 MB
2020-01-30 15:26:06,557 ==> Epoch[10](100/534): Loss: 0.0170
2020-01-30 15:26:06,560 Allocated:33.15576171875 MB
2020-01-30 15:26:06,560 Cached:4309.125 MB
2020-01-30 15:27:19,035 ==> Epoch[10](150/534): Loss: 0.0337
2020-01-30 15:27:19,038 Allocated:33.15576171875 MB
2020-01-30 15:27:19,038 Cached:4309.125 MB
2020-01-30 15:27:58,533 ====> Building Cache
2020-01-30 15:27:58,534 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 15:29:28,831 Allocated:33.1552734375 MB
2020-01-30 15:29:28,831 Cached:3384.375 MB
2020-01-30 15:30:29,068 ==> Epoch[10](200/534): Loss: 0.1611
2020-01-30 15:30:29,071 Allocated:33.15576171875 MB
2020-01-30 15:30:29,072 Cached:3394.375 MB
2020-01-30 15:31:38,121 ==> Epoch[10](250/534): Loss: 0.2517
2020-01-30 15:31:38,124 Allocated:33.15576171875 MB
2020-01-30 15:31:38,125 Cached:3394.375 MB
2020-01-30 15:32:55,924 ==> Epoch[10](300/534): Loss: 0.0901
2020-01-30 15:32:55,927 Allocated:33.15576171875 MB
2020-01-30 15:32:55,927 Cached:3453.375 MB
2020-01-30 15:34:01,793 ==> Epoch[10](350/534): Loss: 0.0302
2020-01-30 15:34:01,795 Allocated:33.15576171875 MB
2020-01-30 15:34:01,796 Cached:3453.375 MB
2020-01-30 15:34:11,894 ====> Building Cache
2020-01-30 15:34:11,894 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 15:35:53,885 Allocated:33.1552734375 MB
2020-01-30 15:35:53,886 Cached:3384.375 MB
2020-01-30 15:37:40,662 ==> Epoch[10](400/534): Loss: 0.0126
2020-01-30 15:37:40,665 Allocated:33.15576171875 MB
2020-01-30 15:37:40,666 Cached:3391.375 MB
2020-01-30 15:38:40,980 ==> Epoch[10](450/534): Loss: 0.0308
2020-01-30 15:38:40,981 Allocated:33.15576171875 MB
2020-01-30 15:38:40,982 Cached:3393.375 MB
2020-01-30 15:39:50,397 ==> Epoch[10](500/534): Loss: 0.0000
2020-01-30 15:39:50,399 Allocated:33.15576171875 MB
2020-01-30 15:39:50,400 Cached:3393.375 MB
2020-01-30 15:40:40,311 ===> Epoch 10 Complete: Avg. Loss: 0.0464
2020-01-30 15:40:40,313 ====> Extracting Features
2020-01-30 15:41:22,225 ==> Batch (50/108)
2020-01-30 15:41:48,120 ==> Batch (100/108)
2020-01-30 15:41:53,117 ====> Building faiss index
2020-01-30 15:41:53,480 ====> Calculating recall @ N
2020-01-30 15:41:55,776 ====> Recall@1: 0.4777
2020-01-30 15:41:55,777 ====> Recall@2: 0.5133
2020-01-30 15:41:55,777 ====> Recall@3: 0.5313
2020-01-30 15:41:55,778 ====> Recall@4: 0.5423
2020-01-30 15:41:55,778 ====> Recall@5: 0.5496
2020-01-30 15:41:55,778 ====> Recall@10: 0.5939
2020-01-30 15:41:55,778 ====> Recall@15: 0.6261
2020-01-30 15:41:55,778 ====> Recall@20: 0.6490
2020-01-30 15:41:55,779 ====> Recall@25: 0.6646
2020-01-30 15:41:55,912 ====> Building Cache
2020-01-30 15:41:55,913 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 15:43:25,239 Allocated:31.15576171875 MB
2020-01-30 15:43:25,240 Cached:4239.125 MB
2020-01-30 15:46:24,441 ==> Epoch[11](100/534): Loss: 0.0092
2020-01-30 15:46:24,444 Allocated:33.15576171875 MB
2020-01-30 15:46:24,444 Cached:4308.125 MB
2020-01-30 15:47:35,768 ==> Epoch[11](150/534): Loss: 0.0577
2020-01-30 15:47:35,772 Allocated:33.15576171875 MB
2020-01-30 15:47:35,772 Cached:4308.125 MB
2020-01-30 15:48:05,946 ====> Building Cache
2020-01-30 15:48:05,947 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 15:49:36,802 Allocated:33.1552734375 MB
2020-01-30 15:49:36,802 Cached:3384.375 MB
2020-01-30 15:50:37,415 ==> Epoch[11](200/534): Loss: 0.0000
2020-01-30 15:50:37,418 Allocated:33.15576171875 MB
2020-01-30 15:50:37,418 Cached:3453.375 MB
2020-01-30 15:51:43,530 ==> Epoch[11](250/534): Loss: 0.1205
2020-01-30 15:51:43,534 Allocated:33.15576171875 MB
2020-01-30 15:51:43,534 Cached:3453.375 MB
2020-01-30 15:53:00,336 ==> Epoch[11](300/534): Loss: 0.0586
2020-01-30 15:53:00,338 Allocated:33.15576171875 MB
2020-01-30 15:53:00,338 Cached:3453.375 MB
2020-01-30 15:54:19,705 ==> Epoch[11](350/534): Loss: 0.0000
2020-01-30 15:54:19,707 Allocated:33.15576171875 MB
2020-01-30 15:54:19,707 Cached:3453.375 MB
2020-01-30 15:54:22,252 ====> Building Cache
2020-01-30 15:54:22,254 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 15:56:01,195 Allocated:33.1552734375 MB
2020-01-30 15:56:01,195 Cached:3384.375 MB
2020-01-30 15:57:40,292 ==> Epoch[11](400/534): Loss: 0.0463
2020-01-30 15:57:40,295 Allocated:33.15576171875 MB
2020-01-30 15:57:40,295 Cached:3453.375 MB
2020-01-30 15:58:49,012 ==> Epoch[11](450/534): Loss: 0.0085
2020-01-30 15:58:49,016 Allocated:33.15576171875 MB
2020-01-30 15:58:49,016 Cached:3453.375 MB
2020-01-30 15:59:49,560 ==> Epoch[11](500/534): Loss: 0.0389
2020-01-30 15:59:49,562 Allocated:33.15576171875 MB
2020-01-30 15:59:49,562 Cached:3453.375 MB
2020-01-30 16:00:38,541 ===> Epoch 11 Complete: Avg. Loss: 0.0434
2020-01-30 16:00:38,543 ====> Extracting Features
2020-01-30 16:01:15,969 ==> Batch (50/108)
2020-01-30 16:01:39,763 ==> Batch (100/108)
2020-01-30 16:01:44,855 ====> Building faiss index
2020-01-30 16:01:45,221 ====> Calculating recall @ N
2020-01-30 16:01:47,608 ====> Recall@1: 0.4586
2020-01-30 16:01:47,609 ====> Recall@2: 0.5122
2020-01-30 16:01:47,609 ====> Recall@3: 0.5345
2020-01-30 16:01:47,610 ====> Recall@4: 0.5519
2020-01-30 16:01:47,610 ====> Recall@5: 0.5643
2020-01-30 16:01:47,610 ====> Recall@10: 0.6055
2020-01-30 16:01:47,610 ====> Recall@15: 0.6406
2020-01-30 16:01:47,610 ====> Recall@20: 0.6609
2020-01-30 16:01:47,610 ====> Recall@25: 0.6730
2020-01-30 16:01:47,734 ====> Building Cache
2020-01-30 16:01:47,735 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 16:03:19,961 Allocated:31.15576171875 MB
2020-01-30 16:03:19,962 Cached:4239.125 MB
2020-01-30 16:05:07,299 ==> Epoch[12](50/534): Loss: 0.0000
2020-01-30 16:05:07,302 Allocated:33.15576171875 MB
2020-01-30 16:05:07,303 Cached:4308.125 MB
2020-01-30 16:06:21,597 ==> Epoch[12](100/534): Loss: 0.0129
2020-01-30 16:06:21,599 Allocated:33.15576171875 MB
2020-01-30 16:06:21,599 Cached:4309.125 MB
2020-01-30 16:07:26,663 ==> Epoch[12](150/534): Loss: 0.0105
2020-01-30 16:07:26,665 Allocated:33.15576171875 MB
2020-01-30 16:07:26,665 Cached:4309.125 MB
2020-01-30 16:08:02,454 ====> Building Cache
2020-01-30 16:08:02,455 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 16:09:31,260 Allocated:33.1552734375 MB
2020-01-30 16:09:31,261 Cached:3384.375 MB
2020-01-30 16:10:31,804 ==> Epoch[12](200/534): Loss: 0.1415
2020-01-30 16:10:31,807 Allocated:33.15576171875 MB
2020-01-30 16:10:31,807 Cached:3393.375 MB
2020-01-30 16:11:37,607 ==> Epoch[12](250/534): Loss: 0.0220
2020-01-30 16:11:37,610 Allocated:33.15576171875 MB
2020-01-30 16:11:37,611 Cached:3394.375 MB
2020-01-30 16:12:55,677 ==> Epoch[12](300/534): Loss: 0.0204
2020-01-30 16:12:55,680 Allocated:33.15576171875 MB
2020-01-30 16:12:55,680 Cached:3453.375 MB
2020-01-30 16:14:08,750 ==> Epoch[12](350/534): Loss: 0.0074
2020-01-30 16:14:08,752 Allocated:33.15576171875 MB
2020-01-30 16:14:08,752 Cached:3453.375 MB
2020-01-30 16:14:11,486 ====> Building Cache
2020-01-30 16:14:11,488 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 16:15:52,396 Allocated:33.1552734375 MB
2020-01-30 16:15:52,396 Cached:3384.375 MB
2020-01-30 16:17:33,301 ==> Epoch[12](400/534): Loss: 0.0000
2020-01-30 16:17:33,303 Allocated:33.15576171875 MB
2020-01-30 16:17:33,303 Cached:3394.375 MB
2020-01-30 16:18:44,613 ==> Epoch[12](450/534): Loss: 0.0347
2020-01-30 16:18:44,615 Allocated:33.15576171875 MB
2020-01-30 16:18:44,616 Cached:3453.375 MB
2020-01-30 16:19:43,532 ==> Epoch[12](500/534): Loss: 0.0090
2020-01-30 16:19:43,534 Allocated:33.15576171875 MB
2020-01-30 16:19:43,534 Cached:3453.375 MB
2020-01-30 16:20:33,565 ===> Epoch 12 Complete: Avg. Loss: 0.0363
2020-01-30 16:20:33,567 ====> Extracting Features
2020-01-30 16:21:10,485 ==> Batch (50/108)
2020-01-30 16:21:34,256 ==> Batch (100/108)
2020-01-30 16:21:39,000 ====> Building faiss index
2020-01-30 16:21:39,347 ====> Calculating recall @ N
2020-01-30 16:21:41,693 ====> Recall@1: 0.4606
2020-01-30 16:21:41,694 ====> Recall@2: 0.5020
2020-01-30 16:21:41,694 ====> Recall@3: 0.5264
2020-01-30 16:21:41,695 ====> Recall@4: 0.5464
2020-01-30 16:21:41,695 ====> Recall@5: 0.5664
2020-01-30 16:21:41,695 ====> Recall@10: 0.6052
2020-01-30 16:21:41,695 ====> Recall@15: 0.6368
2020-01-30 16:21:41,695 ====> Recall@20: 0.6577
2020-01-30 16:21:41,696 ====> Recall@25: 0.6701
2020-01-30 16:21:41,829 ====> Building Cache
2020-01-30 16:21:41,829 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 16:23:10,867 Allocated:31.15576171875 MB
2020-01-30 16:23:10,868 Cached:4239.125 MB
2020-01-30 16:25:19,601 ==> Epoch[13](50/534): Loss: 0.0142
2020-01-30 16:25:19,604 Allocated:33.15576171875 MB
2020-01-30 16:25:19,604 Cached:4309.125 MB
2020-01-30 16:26:34,837 ==> Epoch[13](100/534): Loss: 0.0014
2020-01-30 16:26:34,840 Allocated:33.15576171875 MB
2020-01-30 16:26:34,841 Cached:4309.125 MB
2020-01-30 16:27:59,526 ==> Epoch[13](150/534): Loss: 0.0017
2020-01-30 16:27:59,529 Allocated:33.15576171875 MB
2020-01-30 16:27:59,529 Cached:4309.125 MB
2020-01-30 16:28:42,249 ====> Building Cache
2020-01-30 16:28:42,250 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 16:30:14,270 Allocated:33.1552734375 MB
2020-01-30 16:30:14,271 Cached:3384.375 MB
2020-01-30 16:31:12,164 ==> Epoch[13](200/534): Loss: 0.0130
2020-01-30 16:31:12,165 Allocated:33.15576171875 MB
2020-01-30 16:31:12,166 Cached:3393.375 MB
2020-01-30 16:32:16,126 ==> Epoch[13](250/534): Loss: 0.0324
2020-01-30 16:32:16,128 Allocated:33.15576171875 MB
2020-01-30 16:32:16,129 Cached:3394.375 MB
2020-01-30 16:33:27,582 ==> Epoch[13](300/534): Loss: 0.0873
2020-01-30 16:33:27,585 Allocated:33.15576171875 MB
2020-01-30 16:33:27,586 Cached:3394.375 MB
2020-01-30 16:34:34,953 ==> Epoch[13](350/534): Loss: 0.0510
2020-01-30 16:34:34,956 Allocated:33.15576171875 MB
2020-01-30 16:34:34,956 Cached:3453.375 MB
2020-01-30 16:34:42,938 ====> Building Cache
2020-01-30 16:34:42,939 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 16:36:21,896 Allocated:33.1552734375 MB
2020-01-30 16:36:21,897 Cached:3384.375 MB
2020-01-30 16:38:06,585 ==> Epoch[13](400/534): Loss: 0.1594
2020-01-30 16:38:06,587 Allocated:33.15576171875 MB
2020-01-30 16:38:06,588 Cached:3453.375 MB
2020-01-30 16:39:18,266 ==> Epoch[13](450/534): Loss: 0.0155
2020-01-30 16:39:18,269 Allocated:33.15576171875 MB
2020-01-30 16:39:18,269 Cached:3453.375 MB
2020-01-30 16:40:26,471 ==> Epoch[13](500/534): Loss: 0.0406
2020-01-30 16:40:26,474 Allocated:33.15576171875 MB
2020-01-30 16:40:26,474 Cached:3453.375 MB
2020-01-30 16:41:11,281 ===> Epoch 13 Complete: Avg. Loss: 0.0360
2020-01-30 16:41:11,282 ====> Extracting Features
2020-01-30 16:41:50,095 ==> Batch (50/108)
2020-01-30 16:42:16,775 ==> Batch (100/108)
2020-01-30 16:42:20,779 ====> Building faiss index
2020-01-30 16:42:21,114 ====> Calculating recall @ N
2020-01-30 16:42:23,331 ====> Recall@1: 0.4855
2020-01-30 16:42:23,332 ====> Recall@2: 0.5229
2020-01-30 16:42:23,332 ====> Recall@3: 0.5452
2020-01-30 16:42:23,332 ====> Recall@4: 0.5643
2020-01-30 16:42:23,333 ====> Recall@5: 0.5823
2020-01-30 16:42:23,333 ====> Recall@10: 0.6330
2020-01-30 16:42:23,333 ====> Recall@15: 0.6539
2020-01-30 16:42:23,333 ====> Recall@20: 0.6716
2020-01-30 16:42:23,333 ====> Recall@25: 0.6841
2020-01-30 16:42:23,458 ====> Building Cache
2020-01-30 16:42:23,458 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 16:43:54,505 Allocated:31.15576171875 MB
2020-01-30 16:43:54,505 Cached:4239.125 MB
2020-01-30 16:45:41,525 ==> Epoch[14](50/534): Loss: 0.0000
2020-01-30 16:45:41,528 Allocated:33.15576171875 MB
2020-01-30 16:45:41,529 Cached:4308.125 MB
2020-01-30 16:47:00,946 ==> Epoch[14](100/534): Loss: 0.0000
2020-01-30 16:47:00,949 Allocated:33.15576171875 MB
2020-01-30 16:47:00,949 Cached:4308.125 MB
2020-01-30 16:48:10,130 ==> Epoch[14](150/534): Loss: 0.0065
2020-01-30 16:48:10,132 Allocated:33.15576171875 MB
2020-01-30 16:48:10,133 Cached:4308.125 MB
2020-01-30 16:48:44,537 ====> Building Cache
2020-01-30 16:48:44,538 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 16:50:15,116 Allocated:33.1552734375 MB
2020-01-30 16:50:15,117 Cached:3384.375 MB
2020-01-30 16:51:16,129 ==> Epoch[14](200/534): Loss: 0.0928
2020-01-30 16:51:16,133 Allocated:33.15576171875 MB
2020-01-30 16:51:16,133 Cached:3393.375 MB
2020-01-30 16:52:21,458 ==> Epoch[14](250/534): Loss: 0.1573
2020-01-30 16:52:21,461 Allocated:33.15576171875 MB
2020-01-30 16:52:21,461 Cached:3394.375 MB
2020-01-30 16:53:33,435 ==> Epoch[14](300/534): Loss: 0.0342
2020-01-30 16:53:33,437 Allocated:33.15576171875 MB
2020-01-30 16:53:33,438 Cached:3394.375 MB
2020-01-30 16:54:38,704 ==> Epoch[14](350/534): Loss: 0.0370
2020-01-30 16:54:38,706 Allocated:33.15576171875 MB
2020-01-30 16:54:38,706 Cached:3394.375 MB
2020-01-30 16:54:47,203 ====> Building Cache
2020-01-30 16:54:47,204 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 16:56:31,153 Allocated:33.1552734375 MB
2020-01-30 16:56:31,154 Cached:3384.375 MB
2020-01-30 16:58:25,580 ==> Epoch[14](400/534): Loss: 0.0324
2020-01-30 16:58:25,583 Allocated:33.15576171875 MB
2020-01-30 16:58:25,583 Cached:3393.375 MB
2020-01-30 16:59:40,335 ==> Epoch[14](450/534): Loss: 0.0217
2020-01-30 16:59:40,338 Allocated:33.15576171875 MB
2020-01-30 16:59:40,338 Cached:3453.375 MB
2020-01-30 17:00:49,743 ==> Epoch[14](500/534): Loss: 0.0188
2020-01-30 17:00:49,745 Allocated:33.15576171875 MB
2020-01-30 17:00:49,745 Cached:3453.375 MB
2020-01-30 17:01:41,042 ===> Epoch 14 Complete: Avg. Loss: 0.0350
2020-01-30 17:01:41,044 ====> Extracting Features
2020-01-30 17:02:16,874 ==> Batch (50/108)
2020-01-30 17:02:39,904 ==> Batch (100/108)
2020-01-30 17:02:44,624 ====> Building faiss index
2020-01-30 17:02:44,981 ====> Calculating recall @ N
2020-01-30 17:02:47,434 ====> Recall@1: 0.4768
2020-01-30 17:02:47,434 ====> Recall@2: 0.5104
2020-01-30 17:02:47,435 ====> Recall@3: 0.5287
2020-01-30 17:02:47,435 ====> Recall@4: 0.5493
2020-01-30 17:02:47,435 ====> Recall@5: 0.5658
2020-01-30 17:02:47,435 ====> Recall@10: 0.6212
2020-01-30 17:02:47,436 ====> Recall@15: 0.6487
2020-01-30 17:02:47,436 ====> Recall@20: 0.6684
2020-01-30 17:02:47,436 ====> Recall@25: 0.6849
2020-01-30 17:02:47,567 ====> Building Cache
2020-01-30 17:02:47,567 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 17:04:17,946 Allocated:31.15576171875 MB
2020-01-30 17:04:17,946 Cached:4239.125 MB
2020-01-30 17:06:01,775 ==> Epoch[15](50/534): Loss: 0.0541
2020-01-30 17:06:01,778 Allocated:33.15576171875 MB
2020-01-30 17:06:01,779 Cached:4309.125 MB
2020-01-30 17:07:17,630 ==> Epoch[15](100/534): Loss: 0.0101
2020-01-30 17:07:17,632 Allocated:33.15576171875 MB
2020-01-30 17:07:17,632 Cached:4309.125 MB
2020-01-30 17:08:28,229 ==> Epoch[15](150/534): Loss: 0.0062
2020-01-30 17:08:28,231 Allocated:33.15576171875 MB
2020-01-30 17:08:28,231 Cached:4309.125 MB
2020-01-30 17:09:09,116 ====> Building Cache
2020-01-30 17:09:09,116 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 17:10:39,525 Allocated:33.1552734375 MB
2020-01-30 17:10:39,525 Cached:3384.375 MB
2020-01-30 17:11:39,949 ==> Epoch[15](200/534): Loss: 0.0000
2020-01-30 17:11:39,952 Allocated:33.15576171875 MB
2020-01-30 17:11:39,952 Cached:3394.375 MB
2020-01-30 17:12:43,215 ==> Epoch[15](250/534): Loss: 0.0670
2020-01-30 17:12:43,218 Allocated:33.15576171875 MB
2020-01-30 17:12:43,218 Cached:3453.375 MB
2020-01-30 17:13:53,177 ==> Epoch[15](300/534): Loss: 0.0545
2020-01-30 17:13:53,180 Allocated:33.15576171875 MB
2020-01-30 17:13:53,180 Cached:3453.375 MB
2020-01-30 17:14:58,274 ==> Epoch[15](350/534): Loss: 0.0157
2020-01-30 17:14:58,276 Allocated:33.15576171875 MB
2020-01-30 17:14:58,276 Cached:3453.375 MB
2020-01-30 17:15:07,489 ====> Building Cache
2020-01-30 17:15:07,490 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 17:16:43,530 Allocated:33.1552734375 MB
2020-01-30 17:16:43,531 Cached:3384.375 MB
2020-01-30 17:18:22,751 ==> Epoch[15](400/534): Loss: 0.0832
2020-01-30 17:18:22,754 Allocated:33.15576171875 MB
2020-01-30 17:18:22,754 Cached:3453.375 MB
2020-01-30 17:19:26,896 ==> Epoch[15](450/534): Loss: 0.0368
2020-01-30 17:19:26,898 Allocated:33.15576171875 MB
2020-01-30 17:19:26,898 Cached:3453.375 MB
2020-01-30 17:20:31,668 ==> Epoch[15](500/534): Loss: 0.0091
2020-01-30 17:20:31,671 Allocated:33.15576171875 MB
2020-01-30 17:20:31,671 Cached:3453.375 MB
2020-01-30 17:21:17,208 ===> Epoch 15 Complete: Avg. Loss: 0.0337
2020-01-30 17:21:17,209 ====> Extracting Features
2020-01-30 17:21:51,256 ==> Batch (50/108)
2020-01-30 17:22:18,516 ==> Batch (100/108)
2020-01-30 17:22:23,209 ====> Building faiss index
2020-01-30 17:22:23,568 ====> Calculating recall @ N
2020-01-30 17:22:25,896 ====> Recall@1: 0.4522
2020-01-30 17:22:25,897 ====> Recall@2: 0.4846
2020-01-30 17:22:25,898 ====> Recall@3: 0.5078
2020-01-30 17:22:25,898 ====> Recall@4: 0.5255
2020-01-30 17:22:25,898 ====> Recall@5: 0.5397
2020-01-30 17:22:25,898 ====> Recall@10: 0.5928
2020-01-30 17:22:25,899 ====> Recall@15: 0.6206
2020-01-30 17:22:25,899 ====> Recall@20: 0.6420
2020-01-30 17:22:25,899 ====> Recall@25: 0.6557
2020-01-30 17:22:26,043 ====> Building Cache
2020-01-30 17:22:26,043 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 17:23:58,156 Allocated:31.15576171875 MB
2020-01-30 17:23:58,156 Cached:4239.125 MB
2020-01-30 17:25:56,037 ==> Epoch[16](50/534): Loss: 0.0000
2020-01-30 17:25:56,040 Allocated:33.15576171875 MB
2020-01-30 17:25:56,040 Cached:4309.125 MB
2020-01-30 17:27:09,249 ==> Epoch[16](100/534): Loss: 0.0014
2020-01-30 17:27:09,252 Allocated:33.15576171875 MB
2020-01-30 17:27:09,252 Cached:4309.125 MB
2020-01-30 17:28:15,065 ==> Epoch[16](150/534): Loss: 0.0068
2020-01-30 17:28:15,067 Allocated:33.15576171875 MB
2020-01-30 17:28:15,067 Cached:4309.125 MB
2020-01-30 17:28:48,040 ====> Building Cache
2020-01-30 17:28:48,041 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 17:30:19,157 Allocated:33.1552734375 MB
2020-01-30 17:30:19,158 Cached:3384.375 MB
2020-01-30 17:31:25,374 ==> Epoch[16](200/534): Loss: 0.0287
2020-01-30 17:31:25,376 Allocated:33.15576171875 MB
2020-01-30 17:31:25,377 Cached:3393.375 MB
2020-01-30 17:32:30,748 ==> Epoch[16](250/534): Loss: 0.0607
2020-01-30 17:32:30,749 Allocated:33.15576171875 MB
2020-01-30 17:32:30,750 Cached:3453.375 MB
2020-01-30 17:33:42,554 ==> Epoch[16](300/534): Loss: 0.0579
2020-01-30 17:33:42,556 Allocated:33.15576171875 MB
2020-01-30 17:33:42,556 Cached:3453.375 MB
2020-01-30 17:34:44,134 ==> Epoch[16](350/534): Loss: 0.0000
2020-01-30 17:34:44,136 Allocated:33.15576171875 MB
2020-01-30 17:34:44,136 Cached:3454.375 MB
2020-01-30 17:34:53,043 ====> Building Cache
2020-01-30 17:34:53,045 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache2.hdf5
2020-01-30 17:36:28,761 Allocated:33.1552734375 MB
2020-01-30 17:36:28,762 Cached:3384.375 MB
2020-01-30 17:38:19,098 ==> Epoch[16](400/534): Loss: 0.0066
2020-01-30 17:38:19,101 Allocated:33.15576171875 MB
2020-01-30 17:38:19,101 Cached:3453.375 MB
2020-01-30 17:39:40,518 ==> Epoch[16](450/534): Loss: 0.0069
2020-01-30 17:39:40,520 Allocated:33.15576171875 MB
2020-01-30 17:39:40,520 Cached:3453.375 MB
2020-01-30 17:41:02,777 ==> Epoch[16](500/534): Loss: 0.0206
2020-01-30 17:41:02,779 Allocated:33.15576171875 MB
2020-01-30 17:41:02,780 Cached:3453.375 MB
2020-01-30 17:41:57,207 ===> Epoch 16 Complete: Avg. Loss: 0.0316
2020-01-30 17:41:57,208 ====> Extracting Features
2020-01-30 17:42:35,052 ==> Batch (50/108)
2020-01-30 17:42:57,181 ==> Batch (100/108)
2020-01-30 17:43:01,439 ====> Building faiss index
2020-01-30 17:43:01,800 ====> Calculating recall @ N
2020-01-30 17:43:04,234 ====> Recall@1: 0.4632
2020-01-30 17:43:04,234 ====> Recall@2: 0.4974
2020-01-30 17:43:04,235 ====> Recall@3: 0.5168
2020-01-30 17:43:04,235 ====> Recall@4: 0.5348
2020-01-30 17:43:04,235 ====> Recall@5: 0.5510
2020-01-30 17:43:04,236 ====> Recall@10: 0.6032
2020-01-30 17:43:04,236 ====> Recall@15: 0.6304
2020-01-30 17:43:04,236 ====> Recall@20: 0.6464
2020-01-30 17:43:04,236 ====> Recall@25: 0.6606
2020-01-30 17:43:04,370 Performance did not improve for 10 epochs. Stopping.
2020-01-30 17:43:04,370 => Best Recall@5: 0.6003
