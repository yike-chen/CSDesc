2019-12-18 11:08:34,160 Namespace(arch='vgg16', batchSize=4, cacheBatchSize=72, cachePath='/home/annora/NetVLAD/output/', cacheRefreshRate=0, ckpt='best', ckpt_diy='', contilearn=False, dataPath='/home/annora/NetVLAD/output/data/', dataset='pittsburgh', debug_file='', evalEvery=1, fromscratch=False, lr=0.0001, lrGamma=0.5, lrStep=5, margin=0.1, mode='train', momentum=0.9, nEpochs=30, nGPU=2, nocuda=False, num_clusters=64, optim='SGD', patience=10, pooling='max', resume='', runsPath='/home/annora/NetVLAD/output/runs/', savePath='checkpoints', seed=123, split='val', start_epoch=0, threads=4, vladv2=False, weightDecay=0.001)
2019-12-18 11:08:34,200 ===> Loading dataset(s)
2019-12-18 11:08:34,200 ===> Building model
2019-12-18 11:08:34,322 encoder moder:
VGG16(
  (conv1): Sequential(
    (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv2): Sequential(
    (0): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv3): Sequential(
    (0): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv4): Sequential(
    (0): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv5): Sequential(
    (0): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv6): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv7): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv8): Sequential(
    (0): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv9): Sequential(
    (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv10): Sequential(
    (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv11): Sequential(
    (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv12): Sequential(
    (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv13): Sequential(
    (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  )
  (conv13_relu_maxpool): Sequential(
    (0): ReLU(inplace)
    (1): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
)
2019-12-18 11:08:38,030 ---->>>> trainfiles: ['pitts30k_train.mat', 'oxRobocar_train_night.mat']
2019-12-18 11:08:38,032 ===> Saving state to: /home/annora/NetVLAD/output/runs/2019-12-18-11-08-38_vgg16_max
2019-12-18 11:08:40,173 ====> Training query set:7320
2019-12-18 11:08:40,320 ===> Evaluating on val set, query count:7608
2019-12-18 11:08:40,320 ---->>>> testfile: pitts30k_train.mat
2019-12-18 11:08:40,320 ===> Training model
2019-12-18 11:08:40,320 ====> Building Cache
2019-12-18 11:08:40,321 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache.hdf5
2019-12-18 11:09:42,045 Allocated:164.6328125 MB
2019-12-18 11:09:42,046 Cached:4280.875 MB
2019-12-18 11:10:18,836 ==> Task[1]Epoch[1](50/1830): Loss: 0.2635
2019-12-18 11:10:18,838 Allocated:390.26611328125 MB
2019-12-18 11:10:18,838 Cached:4282.875 MB
2019-12-18 11:10:41,565 ==> Task[1]Epoch[1](100/1830): Loss: 0.3078
2019-12-18 11:10:41,566 Allocated:391.51611328125 MB
2019-12-18 11:10:41,566 Cached:4282.875 MB
2019-12-18 11:11:04,307 ==> Task[1]Epoch[1](150/1830): Loss: 0.1977
2019-12-18 11:11:04,308 Allocated:392.01611328125 MB
2019-12-18 11:11:04,308 Cached:4282.875 MB
2019-12-18 11:11:27,120 ==> Task[1]Epoch[1](200/1830): Loss: 0.3018
2019-12-18 11:11:27,121 Allocated:391.51611328125 MB
2019-12-18 11:11:27,121 Cached:4282.875 MB
2019-12-18 11:11:49,810 ==> Task[1]Epoch[1](250/1830): Loss: 0.1761
2019-12-18 11:11:49,811 Allocated:391.01611328125 MB
2019-12-18 11:11:49,812 Cached:4282.875 MB
2019-12-18 11:12:12,132 ==> Task[1]Epoch[1](300/1830): Loss: 0.1281
2019-12-18 11:12:12,133 Allocated:390.51611328125 MB
2019-12-18 11:12:12,133 Cached:4282.875 MB
2019-12-18 11:12:34,883 ==> Task[1]Epoch[1](350/1830): Loss: 0.2172
2019-12-18 11:12:34,884 Allocated:390.89111328125 MB
2019-12-18 11:12:34,885 Cached:4282.875 MB
2019-12-18 11:12:57,516 ==> Task[1]Epoch[1](400/1830): Loss: 0.2605
2019-12-18 11:12:57,517 Allocated:390.76611328125 MB
2019-12-18 11:12:57,518 Cached:4282.875 MB
2019-12-18 11:13:20,126 ==> Task[1]Epoch[1](450/1830): Loss: 0.2554
2019-12-18 11:13:20,127 Allocated:390.76611328125 MB
2019-12-18 11:13:20,127 Cached:4282.875 MB
2019-12-18 11:13:42,756 ==> Task[1]Epoch[1](500/1830): Loss: 0.2973
2019-12-18 11:13:42,757 Allocated:390.76611328125 MB
2019-12-18 11:13:42,757 Cached:4282.875 MB
2019-12-18 11:14:05,351 ==> Task[1]Epoch[1](550/1830): Loss: 0.2604
2019-12-18 11:14:05,352 Allocated:390.76611328125 MB
2019-12-18 11:14:05,352 Cached:4282.875 MB
2019-12-18 11:14:27,938 ==> Task[1]Epoch[1](600/1830): Loss: 0.1763
2019-12-18 11:14:27,939 Allocated:390.76611328125 MB
2019-12-18 11:14:27,939 Cached:4282.875 MB
2019-12-18 11:14:50,520 ==> Task[1]Epoch[1](650/1830): Loss: 0.2782
2019-12-18 11:14:50,521 Allocated:390.76611328125 MB
2019-12-18 11:14:50,521 Cached:4282.875 MB
2019-12-18 11:15:13,167 ==> Task[1]Epoch[1](700/1830): Loss: 0.2994
2019-12-18 11:15:13,168 Allocated:390.76611328125 MB
2019-12-18 11:15:13,168 Cached:4282.875 MB
2019-12-18 11:15:35,841 ==> Task[1]Epoch[1](750/1830): Loss: 0.2917
2019-12-18 11:15:35,842 Allocated:390.76611328125 MB
2019-12-18 11:15:35,843 Cached:4282.875 MB
2019-12-18 11:15:58,483 ==> Task[1]Epoch[1](800/1830): Loss: 0.2467
2019-12-18 11:15:58,483 Allocated:390.76611328125 MB
2019-12-18 11:15:58,484 Cached:4282.875 MB
2019-12-18 11:16:21,119 ==> Task[1]Epoch[1](850/1830): Loss: 0.1519
2019-12-18 11:16:21,119 Allocated:390.76611328125 MB
2019-12-18 11:16:21,120 Cached:4282.875 MB
2019-12-18 11:16:43,804 ==> Task[1]Epoch[1](900/1830): Loss: 0.2534
2019-12-18 11:16:43,805 Allocated:390.76611328125 MB
2019-12-18 11:16:43,806 Cached:4282.875 MB
2019-12-18 11:17:03,788 ==> Task[1]Epoch[1](950/1830): Loss: 0.1507
2019-12-18 11:17:03,789 Allocated:391.51611328125 MB
2019-12-18 11:17:03,789 Cached:4282.875 MB
2019-12-18 11:17:19,917 ==> Task[1]Epoch[1](1000/1830): Loss: 0.0024
2019-12-18 11:17:19,925 Allocated:389.51611328125 MB
2019-12-18 11:17:19,925 Cached:4282.875 MB
2019-12-18 11:17:40,955 ==> Task[1]Epoch[1](1050/1830): Loss: 0.2704
2019-12-18 11:17:40,955 Allocated:391.89111328125 MB
2019-12-18 11:17:40,956 Cached:4282.875 MB
2019-12-18 11:18:03,649 ==> Task[1]Epoch[1](1100/1830): Loss: 0.1496
2019-12-18 11:18:03,650 Allocated:391.01611328125 MB
2019-12-18 11:18:03,651 Cached:4282.875 MB
2019-12-18 11:18:26,253 ==> Task[1]Epoch[1](1150/1830): Loss: 0.1266
2019-12-18 11:18:26,254 Allocated:391.26611328125 MB
2019-12-18 11:18:26,255 Cached:4282.875 MB
2019-12-18 11:18:45,804 ==> Task[1]Epoch[1](1200/1830): Loss: 0.1035
2019-12-18 11:18:45,805 Allocated:394.39111328125 MB
2019-12-18 11:18:45,805 Cached:4282.875 MB
2019-12-18 11:19:08,253 ==> Task[1]Epoch[1](1250/1830): Loss: 0.2040
2019-12-18 11:19:08,254 Allocated:390.76611328125 MB
2019-12-18 11:19:08,255 Cached:4282.875 MB
2019-12-18 11:19:31,022 ==> Task[1]Epoch[1](1300/1830): Loss: 0.1049
2019-12-18 11:19:31,023 Allocated:391.26611328125 MB
2019-12-18 11:19:31,023 Cached:4282.875 MB
2019-12-18 11:19:53,573 ==> Task[1]Epoch[1](1350/1830): Loss: 0.1214
2019-12-18 11:19:53,575 Allocated:391.26611328125 MB
2019-12-18 11:19:53,575 Cached:4282.875 MB
2019-12-18 11:20:16,459 ==> Task[1]Epoch[1](1400/1830): Loss: 0.2273
2019-12-18 11:20:16,460 Allocated:391.26611328125 MB
2019-12-18 11:20:16,461 Cached:4282.875 MB
2019-12-18 11:20:39,281 ==> Task[1]Epoch[1](1450/1830): Loss: 0.1792
2019-12-18 11:20:39,282 Allocated:391.26611328125 MB
2019-12-18 11:20:39,282 Cached:4282.875 MB
2019-12-18 11:21:00,750 ==> Task[1]Epoch[1](1500/1830): Loss: 0.0402
2019-12-18 11:21:00,752 Allocated:391.76611328125 MB
2019-12-18 11:21:00,752 Cached:4282.875 MB
2019-12-18 11:21:17,244 ==> Task[1]Epoch[1](1550/1830): Loss: 0.2386
2019-12-18 11:21:17,246 Allocated:391.89111328125 MB
2019-12-18 11:21:17,246 Cached:4282.875 MB
2019-12-18 11:21:39,844 ==> Task[1]Epoch[1](1600/1830): Loss: 0.1959
2019-12-18 11:21:39,845 Allocated:389.89111328125 MB
2019-12-18 11:21:39,845 Cached:4282.875 MB
2019-12-18 11:22:02,523 ==> Task[1]Epoch[1](1650/1830): Loss: 0.1505
2019-12-18 11:22:02,524 Allocated:390.26611328125 MB
2019-12-18 11:22:02,525 Cached:4282.875 MB
2019-12-18 11:22:25,198 ==> Task[1]Epoch[1](1700/1830): Loss: 0.1635
2019-12-18 11:22:25,199 Allocated:390.26611328125 MB
2019-12-18 11:22:25,200 Cached:4282.875 MB
2019-12-18 11:22:47,848 ==> Task[1]Epoch[1](1750/1830): Loss: 0.2364
2019-12-18 11:22:47,849 Allocated:390.26611328125 MB
2019-12-18 11:22:47,849 Cached:4282.875 MB
2019-12-18 11:23:10,423 ==> Task[1]Epoch[1](1800/1830): Loss: 0.1669
2019-12-18 11:23:10,424 Allocated:390.26611328125 MB
2019-12-18 11:23:10,425 Cached:4282.875 MB
2019-12-18 11:23:24,334 ===> Task 1 Epoch 1 Complete: Avg. Loss: 0.2187
2019-12-18 11:23:24,335 begin test:
2019-12-18 11:23:24,336 ====> Extracting Features
2019-12-18 11:23:39,666 ==> Batch (50/245)
2019-12-18 11:23:50,635 ==> Batch (100/245)
2019-12-18 11:24:01,563 ==> Batch (150/245)
2019-12-18 11:24:12,474 ==> Batch (200/245)
2019-12-18 11:24:22,534 ====> Building faiss index
2019-12-18 11:24:22,553 ====> Calculating recall @ N
2019-12-18 11:24:23,715 ====> Recall@1: 0.5824
2019-12-18 11:24:23,715 ====> Recall@2: 0.6680
2019-12-18 11:24:23,716 ====> Recall@3: 0.7152
2019-12-18 11:24:23,716 ====> Recall@4: 0.7437
2019-12-18 11:24:23,716 ====> Recall@5: 0.7685
2019-12-18 11:24:23,716 ====> Recall@10: 0.8341
2019-12-18 11:24:23,716 ====> Recall@15: 0.8658
2019-12-18 11:24:23,717 ====> Recall@20: 0.8880
2019-12-18 11:24:23,717 ====> Recall@25: 0.9016
2019-12-18 11:24:23,929 ====> Building Cache
2019-12-18 11:24:23,929 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache.hdf5
2019-12-18 11:25:21,377 Allocated:283.765625 MB
2019-12-18 11:25:21,377 Cached:5002.0 MB
2019-12-18 11:25:56,442 ==> Task[1]Epoch[2](50/1830): Loss: 0.2437
2019-12-18 11:25:56,443 Allocated:392.26611328125 MB
2019-12-18 11:25:56,443 Cached:5002.0 MB
2019-12-18 11:26:17,908 ==> Task[1]Epoch[2](100/1830): Loss: 0.2946
2019-12-18 11:26:17,908 Allocated:393.01611328125 MB
2019-12-18 11:26:17,909 Cached:5002.0 MB
2019-12-18 11:26:39,416 ==> Task[1]Epoch[2](150/1830): Loss: 0.1349
2019-12-18 11:26:39,417 Allocated:393.14111328125 MB
2019-12-18 11:26:39,417 Cached:5002.0 MB
2019-12-18 11:27:00,907 ==> Task[1]Epoch[2](200/1830): Loss: 0.2984
2019-12-18 11:27:00,908 Allocated:392.64111328125 MB
2019-12-18 11:27:00,908 Cached:5002.0 MB
2019-12-18 11:27:21,585 ==> Task[1]Epoch[2](250/1830): Loss: 0.0741
2019-12-18 11:27:21,586 Allocated:391.89111328125 MB
2019-12-18 11:27:21,587 Cached:5002.0 MB
2019-12-18 11:27:40,140 ==> Task[1]Epoch[2](300/1830): Loss: 0.1149
2019-12-18 11:27:40,141 Allocated:392.01611328125 MB
2019-12-18 11:27:40,141 Cached:5002.0 MB
2019-12-18 11:28:01,508 ==> Task[1]Epoch[2](350/1830): Loss: 0.1480
2019-12-18 11:28:01,510 Allocated:394.64111328125 MB
2019-12-18 11:28:01,510 Cached:5002.0 MB
2019-12-18 11:28:22,989 ==> Task[1]Epoch[2](400/1830): Loss: 0.2338
2019-12-18 11:28:22,991 Allocated:393.89111328125 MB
2019-12-18 11:28:22,991 Cached:5002.0 MB
2019-12-18 11:28:44,421 ==> Task[1]Epoch[2](450/1830): Loss: 0.1837
2019-12-18 11:28:44,422 Allocated:393.89111328125 MB
2019-12-18 11:28:44,423 Cached:5002.0 MB
2019-12-18 11:29:05,723 ==> Task[1]Epoch[2](500/1830): Loss: 0.2241
2019-12-18 11:29:05,726 Allocated:393.51611328125 MB
2019-12-18 11:29:05,726 Cached:5002.0 MB
2019-12-18 11:29:26,982 ==> Task[1]Epoch[2](550/1830): Loss: 0.2282
2019-12-18 11:29:26,983 Allocated:394.39111328125 MB
2019-12-18 11:29:26,984 Cached:5002.0 MB
2019-12-18 11:29:48,229 ==> Task[1]Epoch[2](600/1830): Loss: 0.0845
2019-12-18 11:29:48,230 Allocated:392.89111328125 MB
2019-12-18 11:29:48,230 Cached:5002.0 MB
2019-12-18 11:30:09,355 ==> Task[1]Epoch[2](650/1830): Loss: 0.2337
2019-12-18 11:30:09,357 Allocated:392.76611328125 MB
2019-12-18 11:30:09,357 Cached:5002.0 MB
2019-12-18 11:30:30,766 ==> Task[1]Epoch[2](700/1830): Loss: 0.2679
2019-12-18 11:30:30,769 Allocated:391.64111328125 MB
2019-12-18 11:30:30,769 Cached:5002.0 MB
2019-12-18 11:30:52,216 ==> Task[1]Epoch[2](750/1830): Loss: 0.2348
2019-12-18 11:30:52,217 Allocated:392.89111328125 MB
2019-12-18 11:30:52,218 Cached:5002.0 MB
2019-12-18 11:31:13,801 ==> Task[1]Epoch[2](800/1830): Loss: 0.2249
2019-12-18 11:31:13,803 Allocated:392.89111328125 MB
2019-12-18 11:31:13,803 Cached:5002.0 MB
2019-12-18 11:31:35,303 ==> Task[1]Epoch[2](850/1830): Loss: 0.1347
2019-12-18 11:31:35,304 Allocated:392.89111328125 MB
2019-12-18 11:31:35,305 Cached:5002.0 MB
2019-12-18 11:31:56,763 ==> Task[1]Epoch[2](900/1830): Loss: 0.2180
2019-12-18 11:31:56,764 Allocated:392.89111328125 MB
2019-12-18 11:31:56,764 Cached:5002.0 MB
2019-12-18 11:32:15,193 ==> Task[1]Epoch[2](950/1830): Loss: 0.0522
2019-12-18 11:32:15,194 Allocated:394.64111328125 MB
2019-12-18 11:32:15,194 Cached:5002.0 MB
2019-12-18 11:32:26,873 ==> Task[1]Epoch[2](1000/1830): Loss: 0.0348
2019-12-18 11:32:26,874 Allocated:391.64111328125 MB
2019-12-18 11:32:26,874 Cached:5002.0 MB
2019-12-18 11:32:44,997 ==> Task[1]Epoch[2](1050/1830): Loss: 0.2608
2019-12-18 11:32:44,998 Allocated:393.51611328125 MB
2019-12-18 11:32:44,998 Cached:5002.0 MB
2019-12-18 11:33:06,127 ==> Task[1]Epoch[2](1100/1830): Loss: 0.1647
2019-12-18 11:33:06,128 Allocated:394.76611328125 MB
2019-12-18 11:33:06,129 Cached:5002.0 MB
2019-12-18 11:33:26,755 ==> Task[1]Epoch[2](1150/1830): Loss: 0.0242
2019-12-18 11:33:26,756 Allocated:394.64111328125 MB
2019-12-18 11:33:26,757 Cached:5002.0 MB
2019-12-18 11:33:44,458 ==> Task[1]Epoch[2](1200/1830): Loss: 0.0785
2019-12-18 11:33:44,459 Allocated:393.76611328125 MB
2019-12-18 11:33:44,459 Cached:5002.0 MB
2019-12-18 11:34:04,555 ==> Task[1]Epoch[2](1250/1830): Loss: 0.1203
2019-12-18 11:34:04,556 Allocated:392.64111328125 MB
2019-12-18 11:34:04,556 Cached:5002.0 MB
2019-12-18 11:34:25,897 ==> Task[1]Epoch[2](1300/1830): Loss: 0.1313
2019-12-18 11:34:25,898 Allocated:392.51611328125 MB
2019-12-18 11:34:25,899 Cached:5002.0 MB
2019-12-18 11:34:47,453 ==> Task[1]Epoch[2](1350/1830): Loss: 0.0910
2019-12-18 11:34:47,455 Allocated:392.64111328125 MB
2019-12-18 11:34:47,455 Cached:5002.0 MB
2019-12-18 11:35:08,874 ==> Task[1]Epoch[2](1400/1830): Loss: 0.2167
2019-12-18 11:35:08,875 Allocated:392.64111328125 MB
2019-12-18 11:35:08,875 Cached:5002.0 MB
2019-12-18 11:35:30,324 ==> Task[1]Epoch[2](1450/1830): Loss: 0.2540
2019-12-18 11:35:30,325 Allocated:392.64111328125 MB
2019-12-18 11:35:30,326 Cached:5002.0 MB
2019-12-18 11:35:48,228 ==> Task[1]Epoch[2](1500/1830): Loss: 0.0390
2019-12-18 11:35:48,228 Allocated:394.26611328125 MB
2019-12-18 11:35:48,229 Cached:5002.0 MB
2019-12-18 11:36:03,312 ==> Task[1]Epoch[2](1550/1830): Loss: 0.1326
2019-12-18 11:36:03,313 Allocated:393.51611328125 MB
2019-12-18 11:36:03,313 Cached:5002.0 MB
2019-12-18 11:36:24,633 ==> Task[1]Epoch[2](1600/1830): Loss: 0.0421
2019-12-18 11:36:24,635 Allocated:393.26611328125 MB
2019-12-18 11:36:24,635 Cached:5002.0 MB
2019-12-18 11:36:46,047 ==> Task[1]Epoch[2](1650/1830): Loss: 0.1130
2019-12-18 11:36:46,048 Allocated:393.26611328125 MB
2019-12-18 11:36:46,049 Cached:5002.0 MB
2019-12-18 11:37:07,354 ==> Task[1]Epoch[2](1700/1830): Loss: 0.0356
2019-12-18 11:37:07,355 Allocated:393.26611328125 MB
2019-12-18 11:37:07,355 Cached:5002.0 MB
2019-12-18 11:37:28,805 ==> Task[1]Epoch[2](1750/1830): Loss: 0.2143
2019-12-18 11:37:28,806 Allocated:393.26611328125 MB
2019-12-18 11:37:28,806 Cached:5002.0 MB
2019-12-18 11:37:49,974 ==> Task[1]Epoch[2](1800/1830): Loss: 0.1350
2019-12-18 11:37:49,974 Allocated:393.39111328125 MB
2019-12-18 11:37:49,975 Cached:5002.0 MB
2019-12-18 11:38:03,108 ===> Task 1 Epoch 2 Complete: Avg. Loss: 0.1702
2019-12-18 11:38:03,109 begin test:
2019-12-18 11:38:03,110 ====> Extracting Features
2019-12-18 11:38:19,664 ==> Batch (50/245)
2019-12-18 11:38:30,671 ==> Batch (100/245)
2019-12-18 11:38:41,667 ==> Batch (150/245)
2019-12-18 11:38:52,683 ==> Batch (200/245)
2019-12-18 11:39:02,692 ====> Building faiss index
2019-12-18 11:39:02,707 ====> Calculating recall @ N
2019-12-18 11:39:03,707 ====> Recall@1: 0.6609
2019-12-18 11:39:03,708 ====> Recall@2: 0.7442
2019-12-18 11:39:03,708 ====> Recall@3: 0.7839
2019-12-18 11:39:03,709 ====> Recall@4: 0.8080
2019-12-18 11:39:03,709 ====> Recall@5: 0.8262
2019-12-18 11:39:03,709 ====> Recall@10: 0.8767
2019-12-18 11:39:03,709 ====> Recall@15: 0.9029
2019-12-18 11:39:03,709 ====> Recall@20: 0.9198
2019-12-18 11:39:03,710 ====> Recall@25: 0.9303
2019-12-18 11:39:04,483 ====> Building Cache
2019-12-18 11:39:04,484 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache.hdf5
2019-12-18 11:40:02,238 Allocated:282.015625 MB
2019-12-18 11:40:02,239 Cached:5016.25 MB
2019-12-18 11:40:37,731 ==> Task[1]Epoch[3](50/1830): Loss: 0.2324
2019-12-18 11:40:37,732 Allocated:391.51611328125 MB
2019-12-18 11:40:37,733 Cached:5016.25 MB
2019-12-18 11:40:59,176 ==> Task[1]Epoch[3](100/1830): Loss: 0.3373
2019-12-18 11:40:59,176 Allocated:391.51611328125 MB
2019-12-18 11:40:59,177 Cached:5016.25 MB
2019-12-18 11:41:20,307 ==> Task[1]Epoch[3](150/1830): Loss: 0.0484
2019-12-18 11:41:20,309 Allocated:394.14111328125 MB
2019-12-18 11:41:20,309 Cached:5016.25 MB
2019-12-18 11:41:41,214 ==> Task[1]Epoch[3](200/1830): Loss: 0.2570
2019-12-18 11:41:41,215 Allocated:392.51611328125 MB
2019-12-18 11:41:41,215 Cached:5016.25 MB
2019-12-18 11:42:00,540 ==> Task[1]Epoch[3](250/1830): Loss: 0.0384
2019-12-18 11:42:00,542 Allocated:392.89111328125 MB
2019-12-18 11:42:00,542 Cached:5016.25 MB
2019-12-18 11:42:16,395 ==> Task[1]Epoch[3](300/1830): Loss: 0.0694
2019-12-18 11:42:16,396 Allocated:392.01611328125 MB
2019-12-18 11:42:16,397 Cached:5016.25 MB
2019-12-18 11:42:36,653 ==> Task[1]Epoch[3](350/1830): Loss: 0.0843
2019-12-18 11:42:36,656 Allocated:390.51611328125 MB
2019-12-18 11:42:36,657 Cached:5016.25 MB
2019-12-18 11:42:58,003 ==> Task[1]Epoch[3](400/1830): Loss: 0.2218
2019-12-18 11:42:58,004 Allocated:391.26611328125 MB
2019-12-18 11:42:58,004 Cached:5016.25 MB
2019-12-18 11:43:19,561 ==> Task[1]Epoch[3](450/1830): Loss: 0.1893
2019-12-18 11:43:19,563 Allocated:392.51611328125 MB
2019-12-18 11:43:19,563 Cached:5016.25 MB
2019-12-18 11:43:41,108 ==> Task[1]Epoch[3](500/1830): Loss: 0.2803
2019-12-18 11:43:41,109 Allocated:391.39111328125 MB
2019-12-18 11:43:41,109 Cached:5016.25 MB
2019-12-18 11:44:02,028 ==> Task[1]Epoch[3](550/1830): Loss: 0.1670
2019-12-18 11:44:02,029 Allocated:392.26611328125 MB
2019-12-18 11:44:02,029 Cached:5016.25 MB
2019-12-18 11:44:22,439 ==> Task[1]Epoch[3](600/1830): Loss: 0.0508
2019-12-18 11:44:22,440 Allocated:390.76611328125 MB
2019-12-18 11:44:22,440 Cached:5016.25 MB
2019-12-18 11:44:42,288 ==> Task[1]Epoch[3](650/1830): Loss: 0.1838
2019-12-18 11:44:42,289 Allocated:390.64111328125 MB
2019-12-18 11:44:42,289 Cached:5016.25 MB
2019-12-18 11:45:03,832 ==> Task[1]Epoch[3](700/1830): Loss: 0.2722
2019-12-18 11:45:03,833 Allocated:392.01611328125 MB
2019-12-18 11:45:03,833 Cached:5016.25 MB
2019-12-18 11:45:25,355 ==> Task[1]Epoch[3](750/1830): Loss: 0.1834
2019-12-18 11:45:25,357 Allocated:391.51611328125 MB
2019-12-18 11:45:25,357 Cached:5016.25 MB
2019-12-18 11:45:46,952 ==> Task[1]Epoch[3](800/1830): Loss: 0.2442
2019-12-18 11:45:46,953 Allocated:392.14111328125 MB
2019-12-18 11:45:46,954 Cached:5016.25 MB
2019-12-18 11:46:08,267 ==> Task[1]Epoch[3](850/1830): Loss: 0.0452
2019-12-18 11:46:08,268 Allocated:390.76611328125 MB
2019-12-18 11:46:08,269 Cached:5016.25 MB
2019-12-18 11:46:29,952 ==> Task[1]Epoch[3](900/1830): Loss: 0.2352
2019-12-18 11:46:29,953 Allocated:393.89111328125 MB
2019-12-18 11:46:29,954 Cached:5016.25 MB
2019-12-18 11:46:48,278 ==> Task[1]Epoch[3](950/1830): Loss: 0.0183
2019-12-18 11:46:48,281 Allocated:393.26611328125 MB
2019-12-18 11:46:48,281 Cached:5016.25 MB
2019-12-18 11:46:59,738 ==> Task[1]Epoch[3](1000/1830): Loss: 0.0265
2019-12-18 11:46:59,740 Allocated:391.89111328125 MB
2019-12-18 11:46:59,740 Cached:5016.25 MB
2019-12-18 11:47:16,088 ==> Task[1]Epoch[3](1050/1830): Loss: 0.1804
2019-12-18 11:47:16,090 Allocated:391.89111328125 MB
2019-12-18 11:47:16,091 Cached:5016.25 MB
2019-12-18 11:47:35,070 ==> Task[1]Epoch[3](1100/1830): Loss: 0.1090
2019-12-18 11:47:35,071 Allocated:392.51611328125 MB
2019-12-18 11:47:35,072 Cached:5016.25 MB
2019-12-18 11:47:54,323 ==> Task[1]Epoch[3](1150/1830): Loss: 0.0017
2019-12-18 11:47:54,324 Allocated:391.26611328125 MB
2019-12-18 11:47:54,325 Cached:5016.25 MB
2019-12-18 11:48:10,862 ==> Task[1]Epoch[3](1200/1830): Loss: 0.1427
2019-12-18 11:48:10,864 Allocated:392.64111328125 MB
2019-12-18 11:48:10,865 Cached:5016.25 MB
2019-12-18 11:48:29,275 ==> Task[1]Epoch[3](1250/1830): Loss: 0.1964
2019-12-18 11:48:29,277 Allocated:392.26611328125 MB
2019-12-18 11:48:29,278 Cached:5016.25 MB
2019-12-18 11:48:50,607 ==> Task[1]Epoch[3](1300/1830): Loss: 0.1083
2019-12-18 11:48:50,608 Allocated:392.01611328125 MB
2019-12-18 11:48:50,609 Cached:5016.25 MB
2019-12-18 11:49:12,068 ==> Task[1]Epoch[3](1350/1830): Loss: 0.0355
2019-12-18 11:49:12,069 Allocated:392.01611328125 MB
2019-12-18 11:49:12,070 Cached:5016.25 MB
2019-12-18 11:49:33,535 ==> Task[1]Epoch[3](1400/1830): Loss: 0.2030
2019-12-18 11:49:33,537 Allocated:392.01611328125 MB
2019-12-18 11:49:33,537 Cached:5016.25 MB
2019-12-18 11:49:54,893 ==> Task[1]Epoch[3](1450/1830): Loss: 0.1730
2019-12-18 11:49:54,894 Allocated:391.76611328125 MB
2019-12-18 11:49:54,895 Cached:5016.25 MB
2019-12-18 11:50:10,597 ==> Task[1]Epoch[3](1500/1830): Loss: 0.0201
2019-12-18 11:50:10,599 Allocated:390.89111328125 MB
2019-12-18 11:50:10,600 Cached:5016.25 MB
2019-12-18 11:50:24,259 ==> Task[1]Epoch[3](1550/1830): Loss: 0.1887
2019-12-18 11:50:24,261 Allocated:393.01611328125 MB
2019-12-18 11:50:24,261 Cached:5016.25 MB
2019-12-18 11:50:45,750 ==> Task[1]Epoch[3](1600/1830): Loss: 0.0758
2019-12-18 11:50:45,751 Allocated:392.51611328125 MB
2019-12-18 11:50:45,752 Cached:5016.25 MB
2019-12-18 11:51:06,863 ==> Task[1]Epoch[3](1650/1830): Loss: 0.0838
2019-12-18 11:51:06,864 Allocated:390.14111328125 MB
2019-12-18 11:51:06,865 Cached:5016.25 MB
2019-12-18 11:51:26,749 ==> Task[1]Epoch[3](1700/1830): Loss: 0.1556
2019-12-18 11:51:26,751 Allocated:394.14111328125 MB
2019-12-18 11:51:26,751 Cached:5016.25 MB
2019-12-18 11:51:47,919 ==> Task[1]Epoch[3](1750/1830): Loss: 0.1538
2019-12-18 11:51:47,920 Allocated:390.64111328125 MB
2019-12-18 11:51:47,921 Cached:5016.25 MB
2019-12-18 11:52:08,532 ==> Task[1]Epoch[3](1800/1830): Loss: 0.1254
2019-12-18 11:52:08,534 Allocated:391.51611328125 MB
2019-12-18 11:52:08,534 Cached:5016.25 MB
2019-12-18 11:52:21,734 ===> Task 1 Epoch 3 Complete: Avg. Loss: 0.1468
2019-12-18 11:52:21,735 begin test:
2019-12-18 11:52:21,736 ====> Extracting Features
2019-12-18 11:52:38,102 ==> Batch (50/245)
2019-12-18 11:52:48,991 ==> Batch (100/245)
2019-12-18 11:52:59,868 ==> Batch (150/245)
2019-12-18 11:53:10,698 ==> Batch (200/245)
2019-12-18 11:53:20,685 ====> Building faiss index
2019-12-18 11:53:20,704 ====> Calculating recall @ N
2019-12-18 11:53:21,679 ====> Recall@1: 0.6805
2019-12-18 11:53:21,680 ====> Recall@2: 0.7538
2019-12-18 11:53:21,680 ====> Recall@3: 0.7925
2019-12-18 11:53:21,680 ====> Recall@4: 0.8173
2019-12-18 11:53:21,681 ====> Recall@5: 0.8332
2019-12-18 11:53:21,681 ====> Recall@10: 0.8784
2019-12-18 11:53:21,681 ====> Recall@15: 0.9009
2019-12-18 11:53:21,681 ====> Recall@20: 0.9164
2019-12-18 11:53:21,681 ====> Recall@25: 0.9265
2019-12-18 11:53:22,413 ====> Building Cache
2019-12-18 11:53:22,414 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache.hdf5
2019-12-18 11:54:20,170 Can't write data (file write failed: time = Wed Dec 18 11:54:19 2019
, filename = '/home/annora/NetVLAD/output/train_feat_cache.hdf5', file descriptor = 31, errno = 28, error message = 'No space left on device', buf = 0x55bbdac27580, total write size = 6144, bytes this sub-write = 6144, bytes actually written = 18446744073709551615, offset = 35663872)
Traceback (most recent call last):
  File "rawlearning.py", line 784, in <module>
    train(epoch, t)
  File "rawlearning.py", line 121, in train
    h5feat[indices.detach().numpy(), :] = vlad_encoding.detach().cpu().numpy()
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "/home/annora/anaconda3/envs/pytorch_netvlad/lib/python3.6/site-packages/h5py/_hl/dataset.py", line 708, in __setitem__
    self.id.write(mspace, fspace, val, mtype, dxpl=self._dxpl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5d.pyx", line 221, in h5py.h5d.DatasetID.write
  File "h5py/_proxy.pyx", line 132, in h5py._proxy.dset_rw
  File "h5py/_proxy.pyx", line 93, in h5py._proxy.H5PY_H5Dwrite
OSError: Can't write data (file write failed: time = Wed Dec 18 11:54:19 2019
, filename = '/home/annora/NetVLAD/output/train_feat_cache.hdf5', file descriptor = 31, errno = 28, error message = 'No space left on device', buf = 0x55bbdac27580, total write size = 6144, bytes this sub-write = 6144, bytes actually written = 18446744073709551615, offset = 35663872)
