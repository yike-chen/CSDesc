2020-02-08 10:10:26,817 Namespace(arch='alexnet', batchSize=12, cacheBatchSize=96, cachePath='/home/annora/NetVLAD/output/', cacheRefreshRate=3000, ckpt='best', contilearn=False, dataPath='/home/annora/NetVLAD/output/data/', dataset='robotcar', evalEvery=1, fromscratch=False, fromtask='/home/annora/NetVLAD/output/runs/2020-02-07-17-17-47_alexnet_netvlad', lr=0.001, lrGamma=0.5, lrStep=5, margin=0.1, mode='train', momentum=0.9, nEpochs=30, nGPU=1, nocuda=False, num_clusters=64, optim='SGD', patience=10, pooling='netvlad', premodel='imagenet', resume='', runsPath='/home/annora/NetVLAD/output/runs/', savePath='checkpoints', seed=123, split='val', start_epoch=0, threads=8, vladv2=False, weightDecay=0.001)
2020-02-08 10:10:27,507 ===> Loading dataset(s)
2020-02-08 10:10:27,508 trainfile ------>>>>>> oxRobocar_single_train.mat
2020-02-08 10:10:30,220 ====> Training set: oxRobocar_single_train.mat, query set count: 6636
2020-02-08 10:10:30,322 ===> Evaluating on val set: oxRobocar_single_val.mat, query count: 3450
2020-02-08 10:10:30,322 ===> Building model
2020-02-08 10:10:30,372 encoder moder:
AlexNet(
  (conv1): Sequential(
    (0): Conv2d(3, 64, kernel_size=(11, 11), stride=(4, 4), padding=(2, 2))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(64, 192, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv3): Sequential(
    (0): Conv2d(192, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv4): Sequential(
    (0): Conv2d(384, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv5): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  )
)
2020-02-08 10:10:34,853 => loading checkpoint '/home/annora/NetVLAD/output/runs/2020-02-07-17-17-47_alexnet_netvlad/checkpoints/model_best.pth.tar'
2020-02-08 10:10:35,153 => loaded checkpoint '/home/annora/NetVLAD/output/runs/2020-02-07-17-17-47_alexnet_netvlad/checkpoints/model_best.pth.tar' 
2020-02-08 10:10:35,153 ===> Training model
2020-02-08 10:10:35,154 ===> Saving state to: /home/annora/NetVLAD/output/runs/2020-02-08-10-10-35_alexnet_netvlad
2020-02-08 10:10:35,155 ====> Building Cache
2020-02-08 10:10:35,155 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache3.hdf5
2020-02-08 10:12:00,407 Allocated:99.47119140625 MB
2020-02-08 10:12:00,408 Cached:2865.375 MB
2020-02-08 10:14:02,464 ==> Epoch[1](50/553): Loss: 0.1239
2020-02-08 10:14:02,466 Allocated:120.90869140625 MB
2020-02-08 10:14:02,467 Cached:6757.375 MB
2020-02-08 10:15:26,737 ==> Epoch[1](100/553): Loss: 0.1397
2020-02-08 10:15:26,739 Allocated:120.90869140625 MB
2020-02-08 10:15:26,740 Cached:6757.375 MB
2020-02-08 10:16:48,851 ==> Epoch[1](150/553): Loss: 0.0855
2020-02-08 10:16:48,853 Allocated:120.90869140625 MB
2020-02-08 10:16:48,853 Cached:6757.375 MB
2020-02-08 10:17:53,195 ====> Building Cache
2020-02-08 10:17:53,196 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache3.hdf5
2020-02-08 10:19:12,262 Allocated:120.908203125 MB
2020-02-08 10:19:12,263 Cached:3473.625 MB
2020-02-08 10:20:19,298 ==> Epoch[1](200/553): Loss: 0.2210
2020-02-08 10:20:19,302 Allocated:120.90869140625 MB
2020-02-08 10:20:19,302 Cached:7362.625 MB
2020-02-08 10:22:17,998 ==> Epoch[1](250/553): Loss: 0.0518
2020-02-08 10:22:18,002 Allocated:120.90869140625 MB
2020-02-08 10:22:18,002 Cached:7362.625 MB
2020-02-08 10:23:43,541 ==> Epoch[1](300/553): Loss: 0.0607
2020-02-08 10:23:43,543 Allocated:120.90869140625 MB
2020-02-08 10:23:43,543 Cached:7362.625 MB
2020-02-08 10:25:02,365 ==> Epoch[1](350/553): Loss: 0.1540
2020-02-08 10:25:02,367 Allocated:120.90869140625 MB
2020-02-08 10:25:02,367 Cached:7362.625 MB
2020-02-08 10:25:31,766 ====> Building Cache
2020-02-08 10:25:31,767 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache3.hdf5
2020-02-08 10:26:47,738 Allocated:120.908203125 MB
2020-02-08 10:26:47,738 Cached:3473.625 MB
2020-02-08 10:28:09,603 ==> Epoch[1](400/553): Loss: 0.1851
2020-02-08 10:28:09,606 Allocated:120.90869140625 MB
2020-02-08 10:28:09,606 Cached:4158.75 MB
2020-02-08 10:29:23,940 ==> Epoch[1](450/553): Loss: 0.1154
2020-02-08 10:29:23,942 Allocated:120.90869140625 MB
2020-02-08 10:29:23,943 Cached:5468.125 MB
2020-02-08 10:30:49,114 ==> Epoch[1](500/553): Loss: 0.0674
2020-02-08 10:30:49,116 Allocated:120.90869140625 MB
2020-02-08 10:30:49,116 Cached:5468.125 MB
2020-02-08 10:32:20,845 ==> Epoch[1](550/553): Loss: 0.0726
2020-02-08 10:32:20,846 Allocated:120.90869140625 MB
2020-02-08 10:32:20,847 Cached:5468.125 MB
2020-02-08 10:32:23,164 ===> Epoch 1 Complete: Avg. Loss: 0.1130
2020-02-08 10:32:23,165 ====> Extracting Features
2020-02-08 10:32:58,702 ==> Batch (50/108)
2020-02-08 10:33:20,412 ==> Batch (100/108)
2020-02-08 10:33:24,730 ====> Building faiss index
2020-02-08 10:33:25,063 ====> Calculating recall @ N
2020-02-08 10:33:27,473 ====> Recall@1: 0.3055
2020-02-08 10:33:27,474 ====> Recall@2: 0.3774
2020-02-08 10:33:27,474 ====> Recall@3: 0.4162
2020-02-08 10:33:27,475 ====> Recall@4: 0.4386
2020-02-08 10:33:27,475 ====> Recall@5: 0.4510
2020-02-08 10:33:27,475 ====> Recall@10: 0.5174
2020-02-08 10:33:27,475 ====> Recall@15: 0.5684
2020-02-08 10:33:27,476 ====> Recall@20: 0.5954
2020-02-08 10:33:27,476 ====> Recall@25: 0.6183
2020-02-08 10:33:27,573 ====> Building Cache
2020-02-08 10:33:27,574 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache3.hdf5
2020-02-08 10:34:43,614 Allocated:118.90869140625 MB
2020-02-08 10:34:43,615 Cached:4328.375 MB
2020-02-08 10:36:38,859 ==> Epoch[2](50/553): Loss: 0.0743
2020-02-08 10:36:38,862 Allocated:120.90869140625 MB
2020-02-08 10:36:38,862 Cached:7512.625 MB
2020-02-08 10:37:53,246 ==> Epoch[2](100/553): Loss: 0.0071
2020-02-08 10:37:53,249 Allocated:120.90869140625 MB
2020-02-08 10:37:53,249 Cached:7512.625 MB
2020-02-08 10:39:12,537 ==> Epoch[2](150/553): Loss: 0.0098
2020-02-08 10:39:12,539 Allocated:120.90869140625 MB
2020-02-08 10:39:12,539 Cached:7512.625 MB
2020-02-08 10:40:01,683 ====> Building Cache
2020-02-08 10:40:01,684 feature cache--->>> /home/annora/NetVLAD/output/train_feat_cache3.hdf5
2020-02-08 10:41:18,101 Allocated:120.908203125 MB
2020-02-08 10:41:18,102 Cached:3473.625 MB
2020-02-08 10:42:15,845 ==> Epoch[2](200/553): Loss: 0.1517
2020-02-08 10:42:15,847 Allocated:120.90869140625 MB
2020-02-08 10:42:15,847 Cached:8495.0 MB
2020-02-08 10:43:40,891 ==> Epoch[2](250/553): Loss: 0.0231
2020-02-08 10:43:40,893 Allocated:120.90869140625 MB
2020-02-08 10:43:40,894 Cached:4956.875 MB
2020-02-08 10:45:06,938 ==> Epoch[2](300/553): Loss: 0.1649
2020-02-08 10:45:06,940 Allocated:120.90869140625 MB
2020-02-08 10:45:06,940 Cached:4958.875 MB
2020-02-08 10:46:17,907 ==> Epoch[2](350/553): Loss: 0.2012
2020-02-08 10:46:17,909 Allocated:120.90869140625 MB
2020-02-08 10:46:17,910 Cached:4958.875 MB
