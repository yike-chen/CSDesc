2020-01-08 07:37:00,957 Namespace(arch='alexnet', batchSize=16, cacheBatchSize=144, cachePath='/home/annora/NetVLAD/output/', cacheRefreshRate=1000, ckpt='best', contilearn=True, dataPath='/home/annora/NetVLAD/output/data/', dataset='robotcar', evalEvery=1, fromscratch=False, lr=0.001, lrGamma=0.5, lrStep=5, margin=0.1, mode='train', momentum=0.9, nEpochs=30, nGPU=1, nocuda=False, num_clusters=64, optim='SGD', patience=10, pooling='netvlad', premodel='imagenet', resume='', runsPath='/home/annora/NetVLAD/output/runs/', savePath='checkpoints', seed=123, split='val', start_epoch=0, threads=8, vladv2=True, weightDecay=0.001)
2020-01-08 07:37:01,022 ===> Loading dataset(s)
2020-01-08 07:37:03,838 ====> Training query set: 6636
2020-01-08 07:37:03,942 ===> Evaluating on val set, query count: 3450
2020-01-08 07:37:03,943 ===> Building model
2020-01-08 07:37:03,993 encoder moder:
AlexNet(
  (conv1): Sequential(
    (0): Conv2d(3, 64, kernel_size=(11, 11), stride=(4, 4), padding=(2, 2))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(64, 192, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv3): Sequential(
    (0): Conv2d(192, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv4): Sequential(
    (0): Conv2d(384, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv5): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  )
)
2020-01-08 07:37:10,433 ===> Training model
2020-01-08 07:37:10,436 ===> Saving state to: /home/annora/NetVLAD/output/runs/Jan08_07-37-10_alexnet_netvlad
2020-01-08 07:37:10,485 ====> Building Cache
2020-01-08 07:38:33,782 Allocated:99.4716796875 MB
2020-01-08 07:38:33,782 Cached:2684.375 MB
2020-01-08 07:41:41,081 ==> Epoch[1](50/415): Loss: 0.3159
2020-01-08 07:41:41,084 Allocated:121.66015625 MB
2020-01-08 07:41:41,085 Cached:7916.0 MB
2020-01-08 07:42:05,901 ====> Building Cache
2020-01-08 07:43:26,634 Allocated:121.65966796875 MB
2020-01-08 07:43:26,634 Cached:2816.875 MB
2020-01-08 07:46:06,694 ==> Epoch[1](100/415): Loss: 0.3158
2020-01-08 07:46:06,696 Allocated:120.91015625 MB
2020-01-08 07:46:06,696 Cached:7995.625 MB
2020-01-08 07:46:59,313 ====> Building Cache
2020-01-08 07:48:20,465 Allocated:121.28466796875 MB
2020-01-08 07:48:20,466 Cached:3259.375 MB
2020-01-08 07:50:31,187 ==> Epoch[1](150/415): Loss: 0.3157
2020-01-08 07:50:31,190 Allocated:121.78515625 MB
2020-01-08 07:50:31,190 Cached:8039.125 MB
2020-01-08 07:51:47,528 ====> Building Cache
2020-01-08 07:53:16,398 Allocated:121.90966796875 MB
2020-01-08 07:53:16,399 Cached:3209.5 MB
2020-01-08 07:55:00,133 ==> Epoch[1](200/415): Loss: 0.3158
2020-01-08 07:55:00,135 Allocated:121.78515625 MB
2020-01-08 07:55:00,136 Cached:7989.25 MB
2020-01-08 07:56:45,295 ====> Building Cache
2020-01-08 07:58:09,625 Allocated:121.78466796875 MB
2020-01-08 07:58:09,626 Cached:2703.375 MB
2020-01-08 07:59:30,924 ==> Epoch[1](250/415): Loss: 0.3164
2020-01-08 07:59:30,926 Allocated:121.03515625 MB
2020-01-08 07:59:30,927 Cached:7932.0 MB
2020-01-08 08:01:41,210 ==> Epoch[1](300/415): Loss: 0.3161
2020-01-08 08:01:41,211 Allocated:121.91015625 MB
2020-01-08 08:01:41,212 Cached:7932.0 MB
2020-01-08 08:01:41,939 ====> Building Cache
2020-01-08 08:03:05,393 Allocated:121.90966796875 MB
2020-01-08 08:03:05,393 Cached:2803.125 MB
2020-01-08 08:06:10,253 ==> Epoch[1](350/415): Loss: 0.3161
2020-01-08 08:06:10,255 Allocated:121.91015625 MB
2020-01-08 08:06:10,256 Cached:7981.875 MB
2020-01-08 08:06:35,223 ====> Building Cache
2020-01-08 08:07:57,461 Allocated:121.53466796875 MB
2020-01-08 08:07:57,462 Cached:4031.625 MB
2020-01-08 08:10:34,378 ==> Epoch[1](400/415): Loss: 0.3157
2020-01-08 08:10:34,381 Allocated:121.78515625 MB
2020-01-08 08:10:34,381 Cached:8811.375 MB
2020-01-08 08:11:26,208 ===> Epoch 1 Complete: Avg. Loss: 0.3197
2020-01-08 08:11:26,210 ====> Extracting Features
2020-01-08 08:12:21,909 ==> Batch (50/72)
2020-01-08 08:12:37,580 ====> Building faiss index
2020-01-08 08:12:37,949 ====> Calculating recall @ N
2020-01-08 08:12:40,468 ====> Recall_1: 0.3768
2020-01-08 08:12:40,468 Summary name Val/Recall@1 is illegal; using Val/Recall_1 instead.
2020-01-08 08:12:40,468 ====> Recall_5: 0.5806
2020-01-08 08:12:40,469 Summary name Val/Recall@5 is illegal; using Val/Recall_5 instead.
2020-01-08 08:12:40,469 ====> Recall_10: 0.6525
2020-01-08 08:12:40,469 Summary name Val/Recall@10 is illegal; using Val/Recall_10 instead.
2020-01-08 08:12:40,469 ====> Recall_20: 0.6864
2020-01-08 08:12:40,469 Summary name Val/Recall@20 is illegal; using Val/Recall_20 instead.
2020-01-08 08:12:40,798 ====> Building Cache
2020-01-08 08:14:03,258 Allocated:120.28515625 MB
2020-01-08 08:14:03,259 Cached:7656.75 MB
2020-01-08 08:17:07,021 ==> Epoch[2](50/415): Loss: 0.3159
2020-01-08 08:17:07,022 Allocated:120.91015625 MB
2020-01-08 08:17:07,023 Cached:7676.75 MB
2020-01-08 08:17:32,928 ====> Building Cache
2020-01-08 08:19:04,099 Allocated:121.78466796875 MB
2020-01-08 08:19:04,100 Cached:2703.375 MB
2020-01-08 08:21:52,438 ==> Epoch[2](100/415): Loss: 0.3158
2020-01-08 08:21:52,440 Allocated:120.91015625 MB
2020-01-08 08:21:52,441 Cached:7932.0 MB
2020-01-08 08:22:42,575 ====> Building Cache
2020-01-08 08:24:05,446 Allocated:121.90966796875 MB
2020-01-08 08:24:05,447 Cached:2803.125 MB
2020-01-08 08:26:22,827 ==> Epoch[2](150/415): Loss: 0.3158
2020-01-08 08:26:22,829 Allocated:120.91015625 MB
2020-01-08 08:26:22,829 Cached:7981.875 MB
2020-01-08 08:27:43,041 ====> Building Cache
2020-01-08 08:29:05,102 Allocated:121.53466796875 MB
2020-01-08 08:29:05,102 Cached:4031.625 MB
2020-01-08 08:30:57,285 ==> Epoch[2](200/415): Loss: 0.3158
2020-01-08 08:30:57,288 Allocated:121.78515625 MB
2020-01-08 08:30:57,288 Cached:8811.375 MB
2020-01-08 08:32:42,248 ====> Building Cache
2020-01-08 08:34:05,266 Allocated:122.28466796875 MB
2020-01-08 08:34:05,267 Cached:3981.75 MB
2020-01-08 08:35:28,418 ==> Epoch[2](250/415): Loss: 0.3162
2020-01-08 08:35:28,420 Allocated:120.91015625 MB
2020-01-08 08:35:28,421 Cached:8761.5 MB
2020-01-08 08:37:40,848 ==> Epoch[2](300/415): Loss: 0.3163
2020-01-08 08:37:40,849 Allocated:121.78515625 MB
2020-01-08 08:37:40,850 Cached:8761.5 MB
2020-01-08 08:37:41,491 ====> Building Cache
2020-01-08 08:39:05,268 Allocated:121.78466796875 MB
2020-01-08 08:39:05,269 Cached:2703.375 MB
2020-01-08 08:42:20,020 ==> Epoch[2](350/415): Loss: 0.3161
2020-01-08 08:42:20,023 Allocated:120.91015625 MB
2020-01-08 08:42:20,023 Cached:7932.0 MB
2020-01-08 08:42:46,582 ====> Building Cache
2020-01-08 08:44:09,734 Allocated:121.90966796875 MB
2020-01-08 08:44:09,735 Cached:2803.125 MB
2020-01-08 08:46:51,017 ==> Epoch[2](400/415): Loss: 0.3157
2020-01-08 08:46:51,019 Allocated:120.91015625 MB
2020-01-08 08:46:51,019 Cached:7981.875 MB
2020-01-08 08:47:47,044 ===> Epoch 2 Complete: Avg. Loss: 0.3197
2020-01-08 08:47:47,047 ====> Extracting Features
2020-01-08 08:48:43,100 ==> Batch (50/72)
2020-01-08 08:48:57,322 ====> Building faiss index
2020-01-08 08:48:57,691 ====> Calculating recall @ N
2020-01-08 08:49:00,851 ====> Recall_1: 0.3699
2020-01-08 08:49:00,852 Summary name Val/Recall@1 is illegal; using Val/Recall_1 instead.
2020-01-08 08:49:00,852 ====> Recall_5: 0.5736
2020-01-08 08:49:00,853 Summary name Val/Recall@5 is illegal; using Val/Recall_5 instead.
2020-01-08 08:49:00,853 ====> Recall_10: 0.6412
2020-01-08 08:49:00,853 Summary name Val/Recall@10 is illegal; using Val/Recall_10 instead.
2020-01-08 08:49:00,853 ====> Recall_20: 0.6881
2020-01-08 08:49:00,854 Summary name Val/Recall@20 is illegal; using Val/Recall_20 instead.
2020-01-08 08:49:01,309 ====> Building Cache
2020-01-08 08:50:26,240 Allocated:119.53515625 MB
2020-01-08 08:50:26,241 Cached:7705.625 MB
2020-01-08 08:55:53,529 ==> Epoch[3](50/415): Loss: 0.3158
2020-01-08 08:55:53,532 Allocated:120.91015625 MB
2020-01-08 08:55:53,532 Cached:7726.625 MB
2020-01-08 08:56:49,332 ====> Building Cache
2020-01-08 08:58:15,290 Allocated:122.28466796875 MB
2020-01-08 08:58:15,292 Cached:3981.75 MB
