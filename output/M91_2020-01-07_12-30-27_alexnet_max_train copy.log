2020-01-07 12:30:27,725 Namespace(arch='alexnet', batchSize=16, cacheBatchSize=144, cachePath='/home/annora/NetVLAD/output/', cacheRefreshRate=0, ckpt='best', ckpt_diy='model_best0.pth.tar', contilearn=False, dataPath='/home/annora/NetVLAD/output/data/', dataset='pittsburgh', debug_file='', evalEvery=1, fromscratch=False, lr=0.0001, lrGamma=0.5, lrStep=5, margin=0.1, mode='train', momentum=0.9, nEpochs=30, nGPU=1, nocuda=False, num_clusters=64, optim='SGD', patience=10, pooling='max', premodel='places', resume='', runsPath='/home/annora/NetVLAD/output/runs/', savePath='checkpoints', seed=123, split='val', start_epoch=0, threads=4, vladv2=False, weightDecay=0.001)
2020-01-07 12:30:27,821 ===> Loading dataset(s)
2020-01-07 12:30:27,821 ===> Building model
2020-01-07 12:30:27,891 encoder moder:
AlexNet(
  (conv1): Sequential(
    (0): Conv2d(3, 64, kernel_size=(11, 11), stride=(4, 4), padding=(2, 2))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(64, 192, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
    (1): ReLU(inplace)
    (2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (conv3): Sequential(
    (0): Conv2d(192, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv4): Sequential(
    (0): Conv2d(384, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace)
  )
  (conv5): Sequential(
    (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  )
)
2020-01-07 12:30:32,016 ---->>>> trainfiles: ['oxRobocar_doubleN_train.mat']
2020-01-07 12:30:32,017 ===> Saving state to: /home/annora/NetVLAD/output/runs/2020-01-07-12-30-32_alexnet_max
2020-01-07 12:30:35,077 ====> Training query set:6404
2020-01-07 12:30:35,179 ===> Evaluating on val set, query count:3450
2020-01-07 12:30:35,179 ---->>>> testfile: oxRobocar_doubleN_val.mat
2020-01-07 12:30:35,179 ===> Training model
2020-01-07 12:30:35,179 ====> Building Cache
2020-01-07 12:30:35,180 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 12:33:22,047 Allocated:11.59326171875 MB
2020-01-07 12:33:22,048 Cached:2595.125 MB
2020-01-07 12:35:19,131 ==> Task[1]Epoch[1](50/401): Loss: 0.2957
2020-01-07 12:35:19,133 Allocated:33.03076171875 MB
2020-01-07 12:35:19,133 Cached:1112.5 MB
2020-01-07 12:36:53,697 ==> Task[1]Epoch[1](100/401): Loss: 0.2453
2020-01-07 12:36:53,699 Allocated:33.03076171875 MB
2020-01-07 12:36:53,699 Cached:1112.5 MB
2020-01-07 12:38:33,742 ==> Task[1]Epoch[1](150/401): Loss: 0.2997
2020-01-07 12:38:33,744 Allocated:33.03076171875 MB
2020-01-07 12:38:33,744 Cached:1112.5 MB
2020-01-07 12:40:08,979 ==> Task[1]Epoch[1](200/401): Loss: 0.2734
2020-01-07 12:40:08,981 Allocated:33.03076171875 MB
2020-01-07 12:40:08,981 Cached:1112.5 MB
2020-01-07 12:41:48,216 ==> Task[1]Epoch[1](250/401): Loss: 0.3324
2020-01-07 12:41:48,218 Allocated:33.03076171875 MB
2020-01-07 12:41:48,218 Cached:1112.5 MB
2020-01-07 12:43:22,325 ==> Task[1]Epoch[1](300/401): Loss: 0.2968
2020-01-07 12:43:22,327 Allocated:33.03076171875 MB
2020-01-07 12:43:22,327 Cached:1112.5 MB
2020-01-07 12:45:02,194 ==> Task[1]Epoch[1](350/401): Loss: 0.2533
2020-01-07 12:45:02,195 Allocated:33.03076171875 MB
2020-01-07 12:45:02,195 Cached:1112.5 MB
2020-01-07 12:46:35,405 ==> Task[1]Epoch[1](400/401): Loss: 0.2950
2020-01-07 12:46:35,406 Allocated:33.03076171875 MB
2020-01-07 12:46:35,407 Cached:1112.5 MB
2020-01-07 12:46:36,017 ===> Task 1 Epoch 1 Complete: Avg. Loss: 0.2482
2020-01-07 12:46:36,018 begin test:
2020-01-07 12:46:36,018 ====> Extracting Features
2020-01-07 12:47:54,707 ==> Batch (50/72)
2020-01-07 12:48:23,123 ====> Building faiss index
2020-01-07 12:48:23,125 ====> Calculating recall @ N
2020-01-07 12:48:23,631 ====> Recall@1: 0.5377
2020-01-07 12:48:23,632 ====> Recall@2: 0.5849
2020-01-07 12:48:23,633 ====> Recall@3: 0.6072
2020-01-07 12:48:23,633 ====> Recall@4: 0.6261
2020-01-07 12:48:23,633 ====> Recall@5: 0.6446
2020-01-07 12:48:23,633 ====> Recall@10: 0.6843
2020-01-07 12:48:23,634 ====> Recall@15: 0.7055
2020-01-07 12:48:23,634 ====> Recall@20: 0.7177
2020-01-07 12:48:23,634 ====> Recall@25: 0.7333
2020-01-07 12:48:23,674 ====> Building Cache
2020-01-07 12:48:23,674 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 12:51:00,760 Allocated:31.03076171875 MB
2020-01-07 12:51:00,760 Cached:9902.625 MB
2020-01-07 12:52:51,964 ==> Task[1]Epoch[2](50/401): Loss: 0.2773
2020-01-07 12:52:51,966 Allocated:33.03076171875 MB
2020-01-07 12:52:51,966 Cached:1113.5 MB
2020-01-07 12:54:21,787 ==> Task[1]Epoch[2](100/401): Loss: 0.2332
2020-01-07 12:54:21,788 Allocated:33.03076171875 MB
2020-01-07 12:54:21,788 Cached:1113.5 MB
2020-01-07 12:55:59,311 ==> Task[1]Epoch[2](150/401): Loss: 0.2671
2020-01-07 12:55:59,314 Allocated:33.03076171875 MB
2020-01-07 12:55:59,314 Cached:1113.5 MB
2020-01-07 12:57:31,999 ==> Task[1]Epoch[2](200/401): Loss: 0.2656
2020-01-07 12:57:32,001 Allocated:33.03076171875 MB
2020-01-07 12:57:32,001 Cached:1113.5 MB
2020-01-07 12:59:07,915 ==> Task[1]Epoch[2](250/401): Loss: 0.3240
2020-01-07 12:59:07,916 Allocated:33.03076171875 MB
2020-01-07 12:59:07,917 Cached:1113.5 MB
2020-01-07 13:00:40,323 ==> Task[1]Epoch[2](300/401): Loss: 0.2780
2020-01-07 13:00:40,324 Allocated:33.03076171875 MB
2020-01-07 13:00:40,324 Cached:1113.5 MB
2020-01-07 13:02:16,065 ==> Task[1]Epoch[2](350/401): Loss: 0.2432
2020-01-07 13:02:16,066 Allocated:33.03076171875 MB
2020-01-07 13:02:16,066 Cached:1113.5 MB
2020-01-07 13:03:52,752 ==> Task[1]Epoch[2](400/401): Loss: 0.3075
2020-01-07 13:03:52,754 Allocated:33.03076171875 MB
2020-01-07 13:03:52,754 Cached:1113.5 MB
2020-01-07 13:03:53,238 ===> Task 1 Epoch 2 Complete: Avg. Loss: 0.2278
2020-01-07 13:03:53,239 begin test:
2020-01-07 13:03:53,240 ====> Extracting Features
2020-01-07 13:05:13,199 ==> Batch (50/72)
2020-01-07 13:05:40,971 ====> Building faiss index
2020-01-07 13:05:40,973 ====> Calculating recall @ N
2020-01-07 13:05:41,475 ====> Recall@1: 0.5565
2020-01-07 13:05:41,476 ====> Recall@2: 0.6026
2020-01-07 13:05:41,476 ====> Recall@3: 0.6255
2020-01-07 13:05:41,476 ====> Recall@4: 0.6397
2020-01-07 13:05:41,477 ====> Recall@5: 0.6568
2020-01-07 13:05:41,477 ====> Recall@10: 0.6942
2020-01-07 13:05:41,477 ====> Recall@15: 0.7119
2020-01-07 13:05:41,477 ====> Recall@20: 0.7217
2020-01-07 13:05:41,477 ====> Recall@25: 0.7313
2020-01-07 13:05:41,599 ====> Building Cache
2020-01-07 13:05:41,599 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 13:08:30,527 Allocated:31.03076171875 MB
2020-01-07 13:08:30,527 Cached:9902.625 MB
2020-01-07 13:10:27,358 ==> Task[1]Epoch[3](50/401): Loss: 0.2580
2020-01-07 13:10:27,360 Allocated:33.03076171875 MB
2020-01-07 13:10:27,360 Cached:1113.5 MB
2020-01-07 13:12:01,352 ==> Task[1]Epoch[3](100/401): Loss: 0.2136
2020-01-07 13:12:01,354 Allocated:33.03076171875 MB
2020-01-07 13:12:01,354 Cached:1113.5 MB
2020-01-07 13:13:40,931 ==> Task[1]Epoch[3](150/401): Loss: 0.2423
2020-01-07 13:13:40,933 Allocated:33.03076171875 MB
2020-01-07 13:13:40,933 Cached:1113.5 MB
2020-01-07 13:15:14,005 ==> Task[1]Epoch[3](200/401): Loss: 0.2537
2020-01-07 13:15:14,012 Allocated:33.03076171875 MB
2020-01-07 13:15:14,013 Cached:1113.5 MB
2020-01-07 13:16:54,053 ==> Task[1]Epoch[3](250/401): Loss: 0.3170
2020-01-07 13:16:54,055 Allocated:33.03076171875 MB
2020-01-07 13:16:54,055 Cached:1113.5 MB
2020-01-07 13:18:26,362 ==> Task[1]Epoch[3](300/401): Loss: 0.2518
2020-01-07 13:18:26,364 Allocated:33.03076171875 MB
2020-01-07 13:18:26,364 Cached:1113.5 MB
2020-01-07 13:20:04,709 ==> Task[1]Epoch[3](350/401): Loss: 0.2414
2020-01-07 13:20:04,712 Allocated:33.03076171875 MB
2020-01-07 13:20:04,712 Cached:1113.5 MB
2020-01-07 13:21:32,708 ==> Task[1]Epoch[3](400/401): Loss: 0.3189
2020-01-07 13:21:32,711 Allocated:33.03076171875 MB
2020-01-07 13:21:32,711 Cached:1113.5 MB
2020-01-07 13:21:33,178 ===> Task 1 Epoch 3 Complete: Avg. Loss: 0.2042
2020-01-07 13:21:33,180 begin test:
2020-01-07 13:21:33,181 ====> Extracting Features
2020-01-07 13:22:47,546 ==> Batch (50/72)
2020-01-07 13:23:15,353 ====> Building faiss index
2020-01-07 13:23:15,355 ====> Calculating recall @ N
2020-01-07 13:23:15,845 ====> Recall@1: 0.5533
2020-01-07 13:23:15,846 ====> Recall@2: 0.5904
2020-01-07 13:23:15,846 ====> Recall@3: 0.6142
2020-01-07 13:23:15,847 ====> Recall@4: 0.6325
2020-01-07 13:23:15,847 ====> Recall@5: 0.6438
2020-01-07 13:23:15,847 ====> Recall@10: 0.6826
2020-01-07 13:23:15,847 ====> Recall@15: 0.6997
2020-01-07 13:23:15,847 ====> Recall@20: 0.7119
2020-01-07 13:23:15,847 ====> Recall@25: 0.7203
2020-01-07 13:23:15,908 ====> Building Cache
2020-01-07 13:23:15,908 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 13:25:54,067 Allocated:31.03076171875 MB
2020-01-07 13:25:54,067 Cached:9902.625 MB
2020-01-07 13:27:39,537 ==> Task[1]Epoch[4](50/401): Loss: 0.2373
2020-01-07 13:27:39,539 Allocated:33.03076171875 MB
2020-01-07 13:27:39,540 Cached:1113.5 MB
2020-01-07 13:29:12,631 ==> Task[1]Epoch[4](100/401): Loss: 0.1994
2020-01-07 13:29:12,635 Allocated:33.03076171875 MB
2020-01-07 13:29:12,635 Cached:1113.5 MB
2020-01-07 13:30:42,329 ==> Task[1]Epoch[4](150/401): Loss: 0.2121
2020-01-07 13:30:42,333 Allocated:33.03076171875 MB
2020-01-07 13:30:42,333 Cached:1113.5 MB
2020-01-07 13:32:15,935 ==> Task[1]Epoch[4](200/401): Loss: 0.2412
2020-01-07 13:32:15,943 Allocated:33.03076171875 MB
2020-01-07 13:32:15,944 Cached:1113.5 MB
2020-01-07 13:33:44,616 ==> Task[1]Epoch[4](250/401): Loss: 0.3129
2020-01-07 13:33:44,618 Allocated:33.03076171875 MB
2020-01-07 13:33:44,619 Cached:1113.5 MB
2020-01-07 13:35:18,612 ==> Task[1]Epoch[4](300/401): Loss: 0.2267
2020-01-07 13:35:18,614 Allocated:33.03076171875 MB
2020-01-07 13:35:18,614 Cached:1113.5 MB
2020-01-07 13:36:46,849 ==> Task[1]Epoch[4](350/401): Loss: 0.2145
2020-01-07 13:36:46,851 Allocated:33.03076171875 MB
2020-01-07 13:36:46,851 Cached:1113.5 MB
2020-01-07 13:38:19,314 ==> Task[1]Epoch[4](400/401): Loss: 0.3571
2020-01-07 13:38:19,316 Allocated:33.03076171875 MB
2020-01-07 13:38:19,316 Cached:1112.5 MB
2020-01-07 13:38:19,814 ===> Task 1 Epoch 4 Complete: Avg. Loss: 0.1754
2020-01-07 13:38:19,815 begin test:
2020-01-07 13:38:19,816 ====> Extracting Features
2020-01-07 13:39:34,458 ==> Batch (50/72)
2020-01-07 13:40:01,288 ====> Building faiss index
2020-01-07 13:40:01,290 ====> Calculating recall @ N
2020-01-07 13:40:01,779 ====> Recall@1: 0.5278
2020-01-07 13:40:01,779 ====> Recall@2: 0.5672
2020-01-07 13:40:01,780 ====> Recall@3: 0.5872
2020-01-07 13:40:01,780 ====> Recall@4: 0.6026
2020-01-07 13:40:01,780 ====> Recall@5: 0.6168
2020-01-07 13:40:01,781 ====> Recall@10: 0.6606
2020-01-07 13:40:01,781 ====> Recall@15: 0.6893
2020-01-07 13:40:01,781 ====> Recall@20: 0.7029
2020-01-07 13:40:01,781 ====> Recall@25: 0.7122
2020-01-07 13:40:01,842 ====> Building Cache
2020-01-07 13:40:01,842 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 13:42:41,167 Allocated:31.03076171875 MB
2020-01-07 13:42:41,167 Cached:9902.625 MB
2020-01-07 13:44:18,808 ==> Task[1]Epoch[5](50/401): Loss: 0.2094
2020-01-07 13:44:18,810 Allocated:33.03076171875 MB
2020-01-07 13:44:18,811 Cached:1113.5 MB
2020-01-07 13:45:50,148 ==> Task[1]Epoch[5](100/401): Loss: 0.1795
2020-01-07 13:45:50,150 Allocated:33.03076171875 MB
2020-01-07 13:45:50,150 Cached:1113.5 MB
2020-01-07 13:47:22,806 ==> Task[1]Epoch[5](150/401): Loss: 0.1706
2020-01-07 13:47:22,808 Allocated:33.03076171875 MB
2020-01-07 13:47:22,809 Cached:1113.5 MB
2020-01-07 13:48:52,045 ==> Task[1]Epoch[5](200/401): Loss: 0.2317
2020-01-07 13:48:52,046 Allocated:33.03076171875 MB
2020-01-07 13:48:52,047 Cached:1113.5 MB
2020-01-07 13:50:25,236 ==> Task[1]Epoch[5](250/401): Loss: 0.3045
2020-01-07 13:50:25,237 Allocated:33.03076171875 MB
2020-01-07 13:50:25,238 Cached:1113.5 MB
2020-01-07 13:51:52,486 ==> Task[1]Epoch[5](300/401): Loss: 0.1830
2020-01-07 13:51:52,487 Allocated:33.03076171875 MB
2020-01-07 13:51:52,488 Cached:1113.5 MB
2020-01-07 13:53:26,163 ==> Task[1]Epoch[5](350/401): Loss: 0.2026
2020-01-07 13:53:26,165 Allocated:33.03076171875 MB
2020-01-07 13:53:26,166 Cached:1113.5 MB
2020-01-07 13:54:42,278 ==> Task[1]Epoch[5](400/401): Loss: 0.3541
2020-01-07 13:54:42,280 Allocated:33.03076171875 MB
2020-01-07 13:54:42,280 Cached:1112.5 MB
2020-01-07 13:54:42,764 ===> Task 1 Epoch 5 Complete: Avg. Loss: 0.1491
2020-01-07 13:54:42,765 begin test:
2020-01-07 13:54:42,766 ====> Extracting Features
2020-01-07 13:55:55,626 ==> Batch (50/72)
2020-01-07 13:56:25,925 ====> Building faiss index
2020-01-07 13:56:25,927 ====> Calculating recall @ N
2020-01-07 13:56:26,382 ====> Recall@1: 0.5290
2020-01-07 13:56:26,383 ====> Recall@2: 0.5699
2020-01-07 13:56:26,383 ====> Recall@3: 0.5922
2020-01-07 13:56:26,383 ====> Recall@4: 0.6113
2020-01-07 13:56:26,384 ====> Recall@5: 0.6229
2020-01-07 13:56:26,384 ====> Recall@10: 0.6664
2020-01-07 13:56:26,384 ====> Recall@15: 0.6852
2020-01-07 13:56:26,384 ====> Recall@20: 0.7035
2020-01-07 13:56:26,384 ====> Recall@25: 0.7165
2020-01-07 13:56:26,442 ====> Building Cache
2020-01-07 13:56:26,443 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 13:59:08,640 Allocated:31.03076171875 MB
2020-01-07 13:59:08,640 Cached:9902.625 MB
2020-01-07 14:00:46,798 ==> Task[1]Epoch[6](50/401): Loss: 0.2026
2020-01-07 14:00:46,799 Allocated:33.03076171875 MB
2020-01-07 14:00:46,800 Cached:1112.5 MB
2020-01-07 14:02:21,234 ==> Task[1]Epoch[6](100/401): Loss: 0.1654
2020-01-07 14:02:21,236 Allocated:33.03076171875 MB
2020-01-07 14:02:21,236 Cached:1112.5 MB
2020-01-07 14:03:48,179 ==> Task[1]Epoch[6](150/401): Loss: 0.1420
2020-01-07 14:03:48,181 Allocated:33.03076171875 MB
2020-01-07 14:03:48,181 Cached:1112.5 MB
2020-01-07 14:05:21,305 ==> Task[1]Epoch[6](200/401): Loss: 0.2232
2020-01-07 14:05:21,307 Allocated:33.03076171875 MB
2020-01-07 14:05:21,308 Cached:1112.5 MB
2020-01-07 14:06:46,749 ==> Task[1]Epoch[6](250/401): Loss: 0.2971
2020-01-07 14:06:46,751 Allocated:33.03076171875 MB
2020-01-07 14:06:46,751 Cached:1112.5 MB
2020-01-07 14:08:18,410 ==> Task[1]Epoch[6](300/401): Loss: 0.1615
2020-01-07 14:08:18,412 Allocated:33.03076171875 MB
2020-01-07 14:08:18,412 Cached:1112.5 MB
2020-01-07 14:09:47,735 ==> Task[1]Epoch[6](350/401): Loss: 0.1836
2020-01-07 14:09:47,738 Allocated:33.03076171875 MB
2020-01-07 14:09:47,738 Cached:1113.5 MB
2020-01-07 14:10:58,025 ==> Task[1]Epoch[6](400/401): Loss: 0.3570
2020-01-07 14:10:58,027 Allocated:33.03076171875 MB
2020-01-07 14:10:58,027 Cached:1112.5 MB
2020-01-07 14:10:58,500 ===> Task 1 Epoch 6 Complete: Avg. Loss: 0.1327
2020-01-07 14:10:58,501 begin test:
2020-01-07 14:10:58,502 ====> Extracting Features
2020-01-07 14:12:12,801 ==> Batch (50/72)
2020-01-07 14:12:40,514 ====> Building faiss index
2020-01-07 14:12:40,517 ====> Calculating recall @ N
2020-01-07 14:12:41,014 ====> Recall@1: 0.5232
2020-01-07 14:12:41,015 ====> Recall@2: 0.5661
2020-01-07 14:12:41,016 ====> Recall@3: 0.5890
2020-01-07 14:12:41,016 ====> Recall@4: 0.6078
2020-01-07 14:12:41,016 ====> Recall@5: 0.6186
2020-01-07 14:12:41,017 ====> Recall@10: 0.6580
2020-01-07 14:12:41,017 ====> Recall@15: 0.6843
2020-01-07 14:12:41,017 ====> Recall@20: 0.7000
2020-01-07 14:12:41,017 ====> Recall@25: 0.7130
2020-01-07 14:12:41,079 ====> Building Cache
2020-01-07 14:12:41,079 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 14:15:20,805 Allocated:31.03076171875 MB
2020-01-07 14:15:20,806 Cached:9902.625 MB
2020-01-07 14:16:50,820 ==> Task[1]Epoch[7](50/401): Loss: 0.1901
2020-01-07 14:16:50,821 Allocated:33.03076171875 MB
2020-01-07 14:16:50,822 Cached:1112.5 MB
2020-01-07 14:18:21,675 ==> Task[1]Epoch[7](100/401): Loss: 0.1480
2020-01-07 14:18:21,677 Allocated:33.03076171875 MB
2020-01-07 14:18:21,677 Cached:1112.5 MB
2020-01-07 14:19:47,618 ==> Task[1]Epoch[7](150/401): Loss: 0.1115
2020-01-07 14:19:47,620 Allocated:33.03076171875 MB
2020-01-07 14:19:47,620 Cached:1112.5 MB
2020-01-07 14:21:20,513 ==> Task[1]Epoch[7](200/401): Loss: 0.2114
2020-01-07 14:21:20,515 Allocated:33.03076171875 MB
2020-01-07 14:21:20,515 Cached:1112.5 MB
2020-01-07 14:22:39,863 ==> Task[1]Epoch[7](250/401): Loss: 0.3012
2020-01-07 14:22:39,865 Allocated:33.03076171875 MB
2020-01-07 14:22:39,865 Cached:1112.5 MB
2020-01-07 14:24:06,542 ==> Task[1]Epoch[7](300/401): Loss: 0.1319
2020-01-07 14:24:06,545 Allocated:33.03076171875 MB
2020-01-07 14:24:06,545 Cached:1112.5 MB
2020-01-07 14:25:38,677 ==> Task[1]Epoch[7](350/401): Loss: 0.1688
2020-01-07 14:25:38,679 Allocated:33.03076171875 MB
2020-01-07 14:25:38,679 Cached:1112.5 MB
2020-01-07 14:26:45,413 ==> Task[1]Epoch[7](400/401): Loss: 0.3527
2020-01-07 14:26:45,415 Allocated:33.03076171875 MB
2020-01-07 14:26:45,415 Cached:1111.5 MB
2020-01-07 14:26:45,884 ===> Task 1 Epoch 7 Complete: Avg. Loss: 0.1176
2020-01-07 14:26:45,885 begin test:
2020-01-07 14:26:45,886 ====> Extracting Features
2020-01-07 14:27:58,967 ==> Batch (50/72)
2020-01-07 14:28:27,266 ====> Building faiss index
2020-01-07 14:28:27,269 ====> Calculating recall @ N
2020-01-07 14:28:27,791 ====> Recall@1: 0.5171
2020-01-07 14:28:27,791 ====> Recall@2: 0.5609
2020-01-07 14:28:27,792 ====> Recall@3: 0.5872
2020-01-07 14:28:27,792 ====> Recall@4: 0.6043
2020-01-07 14:28:27,792 ====> Recall@5: 0.6148
2020-01-07 14:28:27,792 ====> Recall@10: 0.6545
2020-01-07 14:28:27,792 ====> Recall@15: 0.6803
2020-01-07 14:28:27,793 ====> Recall@20: 0.6962
2020-01-07 14:28:27,793 ====> Recall@25: 0.7116
2020-01-07 14:28:27,853 ====> Building Cache
2020-01-07 14:28:27,854 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 14:31:08,496 Allocated:31.03076171875 MB
2020-01-07 14:31:08,496 Cached:9903.625 MB
2020-01-07 14:32:28,838 ==> Task[1]Epoch[8](50/401): Loss: 0.1739
2020-01-07 14:32:28,840 Allocated:33.03076171875 MB
2020-01-07 14:32:28,840 Cached:1112.5 MB
2020-01-07 14:33:53,140 ==> Task[1]Epoch[8](100/401): Loss: 0.1262
2020-01-07 14:33:53,142 Allocated:33.03076171875 MB
2020-01-07 14:33:53,143 Cached:1113.5 MB
2020-01-07 14:35:12,359 ==> Task[1]Epoch[8](150/401): Loss: 0.0757
2020-01-07 14:35:12,361 Allocated:33.03076171875 MB
2020-01-07 14:35:12,361 Cached:1113.5 MB
2020-01-07 14:36:39,469 ==> Task[1]Epoch[8](200/401): Loss: 0.2088
2020-01-07 14:36:39,471 Allocated:33.03076171875 MB
2020-01-07 14:36:39,471 Cached:1113.5 MB
2020-01-07 14:37:55,257 ==> Task[1]Epoch[8](250/401): Loss: 0.3028
2020-01-07 14:37:55,259 Allocated:33.03076171875 MB
2020-01-07 14:37:55,259 Cached:1111.5 MB
2020-01-07 14:39:17,720 ==> Task[1]Epoch[8](300/401): Loss: 0.1011
2020-01-07 14:39:17,722 Allocated:33.03076171875 MB
2020-01-07 14:39:17,722 Cached:1111.5 MB
2020-01-07 14:40:46,717 ==> Task[1]Epoch[8](350/401): Loss: 0.1504
2020-01-07 14:40:46,718 Allocated:33.03076171875 MB
2020-01-07 14:40:46,719 Cached:1112.5 MB
2020-01-07 14:41:49,462 ==> Task[1]Epoch[8](400/401): Loss: 0.3525
2020-01-07 14:41:49,464 Allocated:33.03076171875 MB
2020-01-07 14:41:49,465 Cached:1112.5 MB
2020-01-07 14:41:49,938 ===> Task 1 Epoch 8 Complete: Avg. Loss: 0.1051
2020-01-07 14:41:49,939 begin test:
2020-01-07 14:41:49,940 ====> Extracting Features
2020-01-07 14:43:05,413 ==> Batch (50/72)
2020-01-07 14:43:33,264 ====> Building faiss index
2020-01-07 14:43:33,266 ====> Calculating recall @ N
2020-01-07 14:43:33,754 ====> Recall@1: 0.5145
2020-01-07 14:43:33,755 ====> Recall@2: 0.5588
2020-01-07 14:43:33,755 ====> Recall@3: 0.5806
2020-01-07 14:43:33,755 ====> Recall@4: 0.5965
2020-01-07 14:43:33,756 ====> Recall@5: 0.6090
2020-01-07 14:43:33,756 ====> Recall@10: 0.6481
2020-01-07 14:43:33,756 ====> Recall@15: 0.6742
2020-01-07 14:43:33,756 ====> Recall@20: 0.6933
2020-01-07 14:43:33,756 ====> Recall@25: 0.7072
2020-01-07 14:43:33,817 ====> Building Cache
2020-01-07 14:43:33,817 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 14:46:13,888 Allocated:31.03076171875 MB
2020-01-07 14:46:13,889 Cached:9902.625 MB
2020-01-07 14:47:27,885 ==> Task[1]Epoch[9](50/401): Loss: 0.1627
2020-01-07 14:47:27,887 Allocated:33.03076171875 MB
2020-01-07 14:47:27,887 Cached:1113.5 MB
2020-01-07 14:48:48,440 ==> Task[1]Epoch[9](100/401): Loss: 0.1050
2020-01-07 14:48:48,447 Allocated:33.03076171875 MB
2020-01-07 14:48:48,448 Cached:1113.5 MB
2020-01-07 14:50:01,063 ==> Task[1]Epoch[9](150/401): Loss: 0.0518
2020-01-07 14:50:01,065 Allocated:33.03076171875 MB
2020-01-07 14:50:01,065 Cached:1112.5 MB
2020-01-07 14:51:24,245 ==> Task[1]Epoch[9](200/401): Loss: 0.2023
2020-01-07 14:51:24,250 Allocated:33.03076171875 MB
2020-01-07 14:51:24,251 Cached:1113.5 MB
2020-01-07 14:52:37,937 ==> Task[1]Epoch[9](250/401): Loss: 0.3049
2020-01-07 14:52:37,939 Allocated:33.03076171875 MB
2020-01-07 14:52:37,939 Cached:1113.5 MB
2020-01-07 14:53:59,254 ==> Task[1]Epoch[9](300/401): Loss: 0.0734
2020-01-07 14:53:59,256 Allocated:33.03076171875 MB
2020-01-07 14:53:59,256 Cached:1113.5 MB
2020-01-07 14:55:28,001 ==> Task[1]Epoch[9](350/401): Loss: 0.1335
2020-01-07 14:55:28,004 Allocated:33.03076171875 MB
2020-01-07 14:55:28,004 Cached:1112.5 MB
2020-01-07 14:56:24,363 ==> Task[1]Epoch[9](400/401): Loss: 0.3437
2020-01-07 14:56:24,365 Allocated:33.03076171875 MB
2020-01-07 14:56:24,365 Cached:1111.5 MB
2020-01-07 14:56:24,825 ===> Task 1 Epoch 9 Complete: Avg. Loss: 0.0950
2020-01-07 14:56:24,826 begin test:
2020-01-07 14:56:24,826 ====> Extracting Features
2020-01-07 14:57:39,122 ==> Batch (50/72)
2020-01-07 14:58:07,838 ====> Building faiss index
2020-01-07 14:58:07,840 ====> Calculating recall @ N
2020-01-07 14:58:08,419 ====> Recall@1: 0.5096
2020-01-07 14:58:08,420 ====> Recall@2: 0.5557
2020-01-07 14:58:08,420 ====> Recall@3: 0.5797
2020-01-07 14:58:08,420 ====> Recall@4: 0.5965
2020-01-07 14:58:08,421 ====> Recall@5: 0.6061
2020-01-07 14:58:08,421 ====> Recall@10: 0.6501
2020-01-07 14:58:08,421 ====> Recall@15: 0.6739
2020-01-07 14:58:08,421 ====> Recall@20: 0.6942
2020-01-07 14:58:08,421 ====> Recall@25: 0.7107
2020-01-07 14:58:08,480 ====> Building Cache
2020-01-07 14:58:08,480 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 15:00:47,936 Allocated:31.03076171875 MB
2020-01-07 15:00:47,937 Cached:9903.625 MB
2020-01-07 15:01:58,234 ==> Task[1]Epoch[10](50/401): Loss: 0.1424
2020-01-07 15:01:58,236 Allocated:33.03076171875 MB
2020-01-07 15:01:58,236 Cached:1112.5 MB
2020-01-07 15:03:11,455 ==> Task[1]Epoch[10](100/401): Loss: 0.0965
2020-01-07 15:03:11,457 Allocated:33.03076171875 MB
2020-01-07 15:03:11,457 Cached:1112.5 MB
2020-01-07 15:04:22,082 ==> Task[1]Epoch[10](150/401): Loss: 0.0360
2020-01-07 15:04:22,085 Allocated:33.03076171875 MB
2020-01-07 15:04:22,113 Cached:1113.5 MB
2020-01-07 15:05:29,960 ==> Task[1]Epoch[10](200/401): Loss: 0.1972
2020-01-07 15:05:29,965 Allocated:33.03076171875 MB
2020-01-07 15:05:29,965 Cached:1111.5 MB
2020-01-07 15:06:44,406 ==> Task[1]Epoch[10](250/401): Loss: 0.2957
2020-01-07 15:06:44,409 Allocated:33.03076171875 MB
2020-01-07 15:06:44,410 Cached:1113.5 MB
2020-01-07 15:07:59,843 ==> Task[1]Epoch[10](300/401): Loss: 0.0512
2020-01-07 15:07:59,844 Allocated:33.03076171875 MB
2020-01-07 15:07:59,845 Cached:1112.5 MB
2020-01-07 15:09:21,704 ==> Task[1]Epoch[10](350/401): Loss: 0.1321
2020-01-07 15:09:21,706 Allocated:33.03076171875 MB
2020-01-07 15:09:21,707 Cached:1112.5 MB
2020-01-07 15:10:16,408 ==> Task[1]Epoch[10](400/401): Loss: 0.3332
2020-01-07 15:10:16,410 Allocated:33.03076171875 MB
2020-01-07 15:10:16,410 Cached:1112.5 MB
2020-01-07 15:10:16,916 ===> Task 1 Epoch 10 Complete: Avg. Loss: 0.0886
2020-01-07 15:10:16,917 begin test:
2020-01-07 15:10:16,918 ====> Extracting Features
2020-01-07 15:11:31,586 ==> Batch (50/72)
2020-01-07 15:12:00,117 ====> Building faiss index
2020-01-07 15:12:00,120 ====> Calculating recall @ N
2020-01-07 15:12:00,685 ====> Recall@1: 0.5058
2020-01-07 15:12:00,686 ====> Recall@2: 0.5510
2020-01-07 15:12:00,686 ====> Recall@3: 0.5777
2020-01-07 15:12:00,686 ====> Recall@4: 0.5939
2020-01-07 15:12:00,687 ====> Recall@5: 0.6067
2020-01-07 15:12:00,687 ====> Recall@10: 0.6475
2020-01-07 15:12:00,687 ====> Recall@15: 0.6742
2020-01-07 15:12:00,687 ====> Recall@20: 0.6922
2020-01-07 15:12:00,688 ====> Recall@25: 0.7075
2020-01-07 15:12:00,754 ====> Building Cache
2020-01-07 15:12:00,755 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 15:14:40,381 Allocated:31.03076171875 MB
2020-01-07 15:14:40,382 Cached:9902.625 MB
2020-01-07 15:15:47,914 ==> Task[1]Epoch[11](50/401): Loss: 0.1436
2020-01-07 15:15:47,917 Allocated:33.03076171875 MB
2020-01-07 15:15:47,918 Cached:1111.5 MB
2020-01-07 15:16:56,768 ==> Task[1]Epoch[11](100/401): Loss: 0.0995
2020-01-07 15:16:56,769 Allocated:33.03076171875 MB
2020-01-07 15:16:56,770 Cached:1111.5 MB
2020-01-07 15:18:01,840 ==> Task[1]Epoch[11](150/401): Loss: 0.0454
2020-01-07 15:18:01,842 Allocated:33.03076171875 MB
2020-01-07 15:18:01,842 Cached:1112.5 MB
2020-01-07 15:19:04,600 ==> Task[1]Epoch[11](200/401): Loss: 0.1915
2020-01-07 15:19:04,602 Allocated:33.03076171875 MB
2020-01-07 15:19:04,603 Cached:1112.5 MB
2020-01-07 15:20:14,721 ==> Task[1]Epoch[11](250/401): Loss: 0.2960
2020-01-07 15:20:14,723 Allocated:33.03076171875 MB
2020-01-07 15:20:14,723 Cached:1111.5 MB
2020-01-07 15:21:28,753 ==> Task[1]Epoch[11](300/401): Loss: 0.0565
2020-01-07 15:21:28,755 Allocated:33.03076171875 MB
2020-01-07 15:21:28,756 Cached:1112.5 MB
2020-01-07 15:22:47,372 ==> Task[1]Epoch[11](350/401): Loss: 0.1194
2020-01-07 15:22:47,374 Allocated:33.03076171875 MB
2020-01-07 15:22:47,374 Cached:1111.5 MB
2020-01-07 15:23:39,373 ==> Task[1]Epoch[11](400/401): Loss: 0.3315
2020-01-07 15:23:39,374 Allocated:33.03076171875 MB
2020-01-07 15:23:39,375 Cached:1111.5 MB
2020-01-07 15:23:39,922 ===> Task 1 Epoch 11 Complete: Avg. Loss: 0.0852
2020-01-07 15:23:39,923 begin test:
2020-01-07 15:23:39,924 ====> Extracting Features
2020-01-07 15:24:56,759 ==> Batch (50/72)
2020-01-07 15:25:25,734 ====> Building faiss index
2020-01-07 15:25:25,736 ====> Calculating recall @ N
2020-01-07 15:25:26,252 ====> Recall@1: 0.5043
2020-01-07 15:25:26,252 ====> Recall@2: 0.5490
2020-01-07 15:25:26,253 ====> Recall@3: 0.5722
2020-01-07 15:25:26,253 ====> Recall@4: 0.5901
2020-01-07 15:25:26,254 ====> Recall@5: 0.6058
2020-01-07 15:25:26,254 ====> Recall@10: 0.6475
2020-01-07 15:25:26,254 ====> Recall@15: 0.6722
2020-01-07 15:25:26,254 ====> Recall@20: 0.6936
2020-01-07 15:25:26,254 ====> Recall@25: 0.7075
2020-01-07 15:25:26,319 ====> Building Cache
2020-01-07 15:25:26,320 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 15:28:07,346 Allocated:31.03076171875 MB
2020-01-07 15:28:07,346 Cached:9903.625 MB
2020-01-07 15:29:13,391 ==> Task[1]Epoch[12](50/401): Loss: 0.1323
2020-01-07 15:29:13,393 Allocated:33.03076171875 MB
2020-01-07 15:29:13,394 Cached:1112.5 MB
2020-01-07 15:30:18,229 ==> Task[1]Epoch[12](100/401): Loss: 0.0934
2020-01-07 15:30:18,230 Allocated:33.03076171875 MB
2020-01-07 15:30:18,231 Cached:1112.5 MB
2020-01-07 15:31:21,492 ==> Task[1]Epoch[12](150/401): Loss: 0.0490
2020-01-07 15:31:21,494 Allocated:33.03076171875 MB
2020-01-07 15:31:21,494 Cached:1111.5 MB
2020-01-07 15:32:21,032 ==> Task[1]Epoch[12](200/401): Loss: 0.1829
2020-01-07 15:32:21,033 Allocated:33.03076171875 MB
2020-01-07 15:32:21,034 Cached:1113.5 MB
2020-01-07 15:33:32,559 ==> Task[1]Epoch[12](250/401): Loss: 0.2999
2020-01-07 15:33:32,561 Allocated:33.03076171875 MB
2020-01-07 15:33:32,561 Cached:1113.5 MB
2020-01-07 15:34:41,025 ==> Task[1]Epoch[12](300/401): Loss: 0.0607
2020-01-07 15:34:41,027 Allocated:33.03076171875 MB
2020-01-07 15:34:41,027 Cached:1112.5 MB
2020-01-07 15:36:03,199 ==> Task[1]Epoch[12](350/401): Loss: 0.1091
2020-01-07 15:36:03,201 Allocated:33.03076171875 MB
2020-01-07 15:36:03,201 Cached:1112.5 MB
2020-01-07 15:36:53,260 ==> Task[1]Epoch[12](400/401): Loss: 0.3223
2020-01-07 15:36:53,261 Allocated:33.03076171875 MB
2020-01-07 15:36:53,262 Cached:1111.5 MB
2020-01-07 15:36:53,761 ===> Task 1 Epoch 12 Complete: Avg. Loss: 0.0825
2020-01-07 15:36:53,762 begin test:
2020-01-07 15:36:53,763 ====> Extracting Features
2020-01-07 15:38:14,142 ==> Batch (50/72)
2020-01-07 15:38:41,865 ====> Building faiss index
2020-01-07 15:38:41,867 ====> Calculating recall @ N
2020-01-07 15:38:42,372 ====> Recall@1: 0.5035
2020-01-07 15:38:42,372 ====> Recall@2: 0.5493
2020-01-07 15:38:42,373 ====> Recall@3: 0.5722
2020-01-07 15:38:42,373 ====> Recall@4: 0.5939
2020-01-07 15:38:42,373 ====> Recall@5: 0.6055
2020-01-07 15:38:42,374 ====> Recall@10: 0.6484
2020-01-07 15:38:42,374 ====> Recall@15: 0.6768
2020-01-07 15:38:42,374 ====> Recall@20: 0.6936
2020-01-07 15:38:42,374 ====> Recall@25: 0.7087
2020-01-07 15:38:42,432 ====> Building Cache
2020-01-07 15:38:42,433 h5feat cache at: /home/annora/NetVLAD/output/train_feat_cache1.hdf5
2020-01-07 15:41:23,457 Allocated:31.03076171875 MB
2020-01-07 15:41:23,458 Cached:9902.625 MB
2020-01-07 15:42:27,585 ==> Task[1]Epoch[13](50/401): Loss: 0.1360
2020-01-07 15:42:27,587 Allocated:33.03076171875 MB
2020-01-07 15:42:27,587 Cached:1111.5 MB
2020-01-07 15:43:36,226 ==> Task[1]Epoch[13](100/401): Loss: 0.0892
2020-01-07 15:43:36,228 Allocated:33.03076171875 MB
2020-01-07 15:43:36,228 Cached:1111.5 MB
2020-01-07 15:44:34,275 ==> Task[1]Epoch[13](150/401): Loss: 0.0305
2020-01-07 15:44:34,277 Allocated:33.03076171875 MB
2020-01-07 15:44:34,277 Cached:1112.5 MB
2020-01-07 15:45:30,005 ==> Task[1]Epoch[13](200/401): Loss: 0.1878
2020-01-07 15:45:30,008 Allocated:33.03076171875 MB
2020-01-07 15:45:30,008 Cached:1113.5 MB
2020-01-07 15:46:41,362 ==> Task[1]Epoch[13](250/401): Loss: 0.2956
2020-01-07 15:46:41,364 Allocated:33.03076171875 MB
2020-01-07 15:46:41,364 Cached:1111.5 MB
2020-01-07 15:47:47,980 ==> Task[1]Epoch[13](300/401): Loss: 0.0572
2020-01-07 15:47:47,982 Allocated:33.03076171875 MB
2020-01-07 15:47:47,982 Cached:1111.5 MB
2020-01-07 15:49:06,360 ==> Task[1]Epoch[13](350/401): Loss: 0.1117
2020-01-07 15:49:06,362 Allocated:33.03076171875 MB
2020-01-07 15:49:06,362 Cached:1111.5 MB
2020-01-07 15:49:54,819 ==> Task[1]Epoch[13](400/401): Loss: 0.3156
2020-01-07 15:49:54,821 Allocated:33.03076171875 MB
2020-01-07 15:49:54,821 Cached:1112.5 MB
2020-01-07 15:49:55,295 ===> Task 1 Epoch 13 Complete: Avg. Loss: 0.0798
2020-01-07 15:49:55,296 begin test:
2020-01-07 15:49:55,297 ====> Extracting Features
2020-01-07 15:51:11,626 ==> Batch (50/72)
2020-01-07 15:51:38,716 ====> Building faiss index
2020-01-07 15:51:38,717 ====> Calculating recall @ N
2020-01-07 15:51:39,218 ====> Recall@1: 0.5061
2020-01-07 15:51:39,219 ====> Recall@2: 0.5470
2020-01-07 15:51:39,219 ====> Recall@3: 0.5699
2020-01-07 15:51:39,220 ====> Recall@4: 0.5901
2020-01-07 15:51:39,220 ====> Recall@5: 0.6043
2020-01-07 15:51:39,220 ====> Recall@10: 0.6443
2020-01-07 15:51:39,220 ====> Recall@15: 0.6777
2020-01-07 15:51:39,220 ====> Recall@20: 0.6942
2020-01-07 15:51:39,221 ====> Recall@25: 0.7075
2020-01-07 15:51:39,285 Performance did not improve for 10 epochs. Stopping.
2020-01-07 15:51:39,285 => Best Recall@5: 0.6568
